/** CortexJS Compute Engine 0.23.1 */
(function(global,factory){typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'],factory):(global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.ComputeEngine = {}));})(this, (function (exports) { 'use strict';
var ComputeEngine=(()=>{var sl=Object.create;var wt=Object.defineProperty;var al=Object.getOwnPropertyDescriptor;var ul=Object.getOwnPropertyNames;var ll=Object.getPrototypeOf,fl=Object.prototype.hasOwnProperty;var dl=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),cl=(n,e)=>{for(var i in e)wt(n,i,{get:e[i],enumerable:!0})},ys=(n,e,i,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ul(e))!fl.call(n,r)&&r!==i&&wt(n,r,{get:()=>e[r],enumerable:!(t=al(e,r))||t.enumerable});return n};var pe=(n,e,i)=>(i=n!=null?sl(ll(n)):{},ys(e||!n||!n.__esModule?wt(i,"default",{value:n,enumerable:!0}):i,n)),ml=n=>ys(wt({},"__esModule",{value:!0}),n);var ce=dl((Hr,Es)=>{(function(n){"use strict";var e=Math.cosh||function(l){return Math.abs(l)<1e-9?1-l:(Math.exp(l)+Math.exp(-l))*.5},i=Math.sinh||function(l){return Math.abs(l)<1e-9?l:(Math.exp(l)-Math.exp(-l))*.5},t=function(l){var f=Math.PI/4;if(-f>l||l>f)return Math.cos(l)-1;var d=l*l;return d*(d*(d*(d*(d*(d*(d*(d/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},r=function(l,f){var d=Math.abs(l),c=Math.abs(f);return d<3e3&&c<3e3?Math.sqrt(d*d+c*c):(d<c?(d=c,c=l/f):c=f/l,d*Math.sqrt(1+c*c))},o=function(){throw SyntaxError("Invalid Param")};function s(l,f){var d=Math.abs(l),c=Math.abs(f);return l===0?Math.log(c):f===0?Math.log(d):d<3e3&&c<3e3?Math.log(l*l+f*f)*.5:(l=l/2,f=f/2,.5*Math.log(l*l+f*f)+Math.LN2)}var a=function(l,f){var d={re:0,im:0};if(l==null)d.re=d.im=0;else if(f!==void 0)d.re=l,d.im=f;else switch(typeof l){case"object":if("im"in l&&"re"in l)d.re=l.re,d.im=l.im;else if("abs"in l&&"arg"in l){if(!Number.isFinite(l.abs)&&Number.isFinite(l.arg))return u.INFINITY;d.re=l.abs*Math.cos(l.arg),d.im=l.abs*Math.sin(l.arg)}else if("r"in l&&"phi"in l){if(!Number.isFinite(l.r)&&Number.isFinite(l.phi))return u.INFINITY;d.re=l.r*Math.cos(l.phi),d.im=l.r*Math.sin(l.phi)}else l.length===2?(d.re=l[0],d.im=l[1]):o();break;case"string":d.im=d.re=0;var c=l.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),m=1,g=0;c===null&&o();for(var h=0;h<c.length;h++){var x=c[h];x===" "||x==="	"||x===`
`||(x==="+"?m++:x==="-"?g++:x==="i"||x==="I"?(m+g===0&&o(),c[h+1]!==" "&&!isNaN(c[h+1])?(d.im+=parseFloat((g%2?"-":"")+c[h+1]),h++):d.im+=parseFloat((g%2?"-":"")+"1"),m=g=0):((m+g===0||isNaN(x))&&o(),c[h+1]==="i"||c[h+1]==="I"?(d.im+=parseFloat((g%2?"-":"")+x),h++):d.re+=parseFloat((g%2?"-":"")+x),m=g=0))}m+g>0&&o();break;case"number":d.im=0,d.re=l;break;default:o()}return isNaN(d.re)||isNaN(d.im),d};function u(l,f){if(!(this instanceof u))return new u(l,f);var d=a(l,f);this.re=d.re,this.im=d.im}u.prototype={re:0,im:0,sign:function(){var l=this.abs();return new u(this.re/l,this.im/l)},add:function(l,f){var d=new u(l,f);return this.isInfinite()&&d.isInfinite()?u.NAN:this.isInfinite()||d.isInfinite()?u.INFINITY:new u(this.re+d.re,this.im+d.im)},sub:function(l,f){var d=new u(l,f);return this.isInfinite()&&d.isInfinite()?u.NAN:this.isInfinite()||d.isInfinite()?u.INFINITY:new u(this.re-d.re,this.im-d.im)},mul:function(l,f){var d=new u(l,f);return this.isInfinite()&&d.isZero()||this.isZero()&&d.isInfinite()?u.NAN:this.isInfinite()||d.isInfinite()?u.INFINITY:d.im===0&&this.im===0?new u(this.re*d.re,0):new u(this.re*d.re-this.im*d.im,this.re*d.im+this.im*d.re)},div:function(l,f){var d=new u(l,f);if(this.isZero()&&d.isZero()||this.isInfinite()&&d.isInfinite())return u.NAN;if(this.isInfinite()||d.isZero())return u.INFINITY;if(this.isZero()||d.isInfinite())return u.ZERO;l=this.re,f=this.im;var c=d.re,m=d.im,g,h;return m===0?new u(l/c,f/c):Math.abs(c)<Math.abs(m)?(h=c/m,g=c*h+m,new u((l*h+f)/g,(f*h-l)/g)):(h=m/c,g=m*h+c,new u((l+f*h)/g,(f-l*h)/g))},pow:function(l,f){var d=new u(l,f);if(l=this.re,f=this.im,d.isZero())return u.ONE;if(d.im===0){if(f===0&&l>0)return new u(Math.pow(l,d.re),0);if(l===0)switch((d.re%4+4)%4){case 0:return new u(Math.pow(f,d.re),0);case 1:return new u(0,Math.pow(f,d.re));case 2:return new u(-Math.pow(f,d.re),0);case 3:return new u(0,-Math.pow(f,d.re))}}if(l===0&&f===0&&d.re>0&&d.im>=0)return u.ZERO;var c=Math.atan2(f,l),m=s(l,f);return l=Math.exp(d.re*m-d.im*c),f=d.im*m+d.re*c,new u(l*Math.cos(f),l*Math.sin(f))},sqrt:function(){var l=this.re,f=this.im,d=this.abs(),c,m;if(l>=0){if(f===0)return new u(Math.sqrt(l),0);c=.5*Math.sqrt(2*(d+l))}else c=Math.abs(f)/Math.sqrt(2*(d-l));return l<=0?m=.5*Math.sqrt(2*(d-l)):m=Math.abs(f)/Math.sqrt(2*(d+l)),new u(c,f<0?-m:m)},exp:function(){var l=Math.exp(this.re);return this.im,new u(l*Math.cos(this.im),l*Math.sin(this.im))},expm1:function(){var l=this.re,f=this.im;return new u(Math.expm1(l)*Math.cos(f)+t(f),Math.exp(l)*Math.sin(f))},log:function(){var l=this.re,f=this.im;return f===0&&l>0,new u(s(l,f),Math.atan2(f,l))},abs:function(){return r(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var l=this.re,f=this.im;return new u(Math.sin(l)*e(f),Math.cos(l)*i(f))},cos:function(){var l=this.re,f=this.im;return new u(Math.cos(l)*e(f),-Math.sin(l)*i(f))},tan:function(){var l=2*this.re,f=2*this.im,d=Math.cos(l)+e(f);return new u(Math.sin(l)/d,i(f)/d)},cot:function(){var l=2*this.re,f=2*this.im,d=Math.cos(l)-e(f);return new u(-Math.sin(l)/d,i(f)/d)},sec:function(){var l=this.re,f=this.im,d=.5*e(2*f)+.5*Math.cos(2*l);return new u(Math.cos(l)*e(f)/d,Math.sin(l)*i(f)/d)},csc:function(){var l=this.re,f=this.im,d=.5*e(2*f)-.5*Math.cos(2*l);return new u(Math.sin(l)*e(f)/d,-Math.cos(l)*i(f)/d)},asin:function(){var l=this.re,f=this.im,d=new u(f*f-l*l+1,-2*l*f).sqrt(),c=new u(d.re-f,d.im+l).log();return new u(c.im,-c.re)},acos:function(){var l=this.re,f=this.im,d=new u(f*f-l*l+1,-2*l*f).sqrt(),c=new u(d.re-f,d.im+l).log();return new u(Math.PI/2-c.im,c.re)},atan:function(){var l=this.re,f=this.im;if(l===0){if(f===1)return new u(0,1/0);if(f===-1)return new u(0,-1/0)}var d=l*l+(1-f)*(1-f),c=new u((1-f*f-l*l)/d,-2*l/d).log();return new u(-.5*c.im,.5*c.re)},acot:function(){var l=this.re,f=this.im;if(f===0)return new u(Math.atan2(1,l),0);var d=l*l+f*f;return d!==0?new u(l/d,-f/d).atan():new u(l!==0?l/0:0,f!==0?-f/0:0).atan()},asec:function(){var l=this.re,f=this.im;if(l===0&&f===0)return new u(0,1/0);var d=l*l+f*f;return d!==0?new u(l/d,-f/d).acos():new u(l!==0?l/0:0,f!==0?-f/0:0).acos()},acsc:function(){var l=this.re,f=this.im;if(l===0&&f===0)return new u(Math.PI/2,1/0);var d=l*l+f*f;return d!==0?new u(l/d,-f/d).asin():new u(l!==0?l/0:0,f!==0?-f/0:0).asin()},sinh:function(){var l=this.re,f=this.im;return new u(i(l)*Math.cos(f),e(l)*Math.sin(f))},cosh:function(){var l=this.re,f=this.im;return new u(e(l)*Math.cos(f),i(l)*Math.sin(f))},tanh:function(){var l=2*this.re,f=2*this.im,d=e(l)+Math.cos(f);return new u(i(l)/d,Math.sin(f)/d)},coth:function(){var l=2*this.re,f=2*this.im,d=e(l)-Math.cos(f);return new u(i(l)/d,-Math.sin(f)/d)},csch:function(){var l=this.re,f=this.im,d=Math.cos(2*f)-e(2*l);return new u(-2*i(l)*Math.cos(f)/d,2*e(l)*Math.sin(f)/d)},sech:function(){var l=this.re,f=this.im,d=Math.cos(2*f)+e(2*l);return new u(2*e(l)*Math.cos(f)/d,-2*i(l)*Math.sin(f)/d)},asinh:function(){var l=this.im;this.im=-this.re,this.re=l;var f=this.asin();return this.re=-this.im,this.im=l,l=f.re,f.re=-f.im,f.im=l,f},acosh:function(){var l=this.acos();if(l.im<=0){var f=l.re;l.re=-l.im,l.im=f}else{var f=l.im;l.im=-l.re,l.re=f}return l},atanh:function(){var l=this.re,f=this.im,d=l>1&&f===0,c=1-l,m=1+l,g=c*c+f*f,h=g!==0?new u((m*c-f*f)/g,(f*c+m*f)/g):new u(l!==-1?l/0:0,f!==0?f/0:0),x=h.re;return h.re=s(h.re,h.im)/2,h.im=Math.atan2(h.im,x)/2,d&&(h.im=-h.im),h},acoth:function(){var l=this.re,f=this.im;if(l===0&&f===0)return new u(0,Math.PI/2);var d=l*l+f*f;return d!==0?new u(l/d,-f/d).atanh():new u(l!==0?l/0:0,f!==0?-f/0:0).atanh()},acsch:function(){var l=this.re,f=this.im;if(f===0)return new u(l!==0?Math.log(l+Math.sqrt(l*l+1)):1/0,0);var d=l*l+f*f;return d!==0?new u(l/d,-f/d).asinh():new u(l!==0?l/0:0,f!==0?-f/0:0).asinh()},asech:function(){var l=this.re,f=this.im;if(this.isZero())return u.INFINITY;var d=l*l+f*f;return d!==0?new u(l/d,-f/d).acosh():new u(l!==0?l/0:0,f!==0?-f/0:0).acosh()},inverse:function(){if(this.isZero())return u.INFINITY;if(this.isInfinite())return u.ZERO;var l=this.re,f=this.im,d=l*l+f*f;return new u(l/d,-f/d)},conjugate:function(){return new u(this.re,-this.im)},neg:function(){return new u(-this.re,-this.im)},ceil:function(l){return l=Math.pow(10,l||0),new u(Math.ceil(this.re*l)/l,Math.ceil(this.im*l)/l)},floor:function(l){return l=Math.pow(10,l||0),new u(Math.floor(this.re*l)/l,Math.floor(this.im*l)/l)},round:function(l){return l=Math.pow(10,l||0),new u(Math.round(this.re*l)/l,Math.round(this.im*l)/l)},equals:function(l,f){var d=new u(l,f);return Math.abs(d.re-this.re)<=u.EPSILON&&Math.abs(d.im-this.im)<=u.EPSILON},clone:function(){return new u(this.re,this.im)},toString:function(){var l=this.re,f=this.im,d="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(l)<u.EPSILON&&(l=0),Math.abs(f)<u.EPSILON&&(f=0),f===0?d+l:(l!==0?(d+=l,d+=" ",f<0?(f=-f,d+="-"):d+="+",d+=" "):f<0&&(f=-f,d+="-"),f!==1&&(d+=f),d+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},u.ZERO=new u(0,0),u.ONE=new u(1,0),u.I=new u(0,1),u.PI=new u(Math.PI,0),u.E=new u(Math.E,0),u.INFINITY=new u(1/0,1/0),u.NAN=new u(NaN,NaN),u.EPSILON=1e-15,typeof define=="function"&&define.amd?define([],function(){return u}):typeof Hr=="object"?(Object.defineProperty(u,"__esModule",{value:!0}),u.default=u,u.Complex=u,Es.exports=u):n.Complex=u})(Hr)});var Ud={};cl(Ud,{ADDITION_PRECEDENCE:()=>re,ARROW_PRECEDENCE:()=>sn,ASSIGNMENT_PRECEDENCE:()=>di,COMPARISON_PRECEDENCE:()=>A,ComputeEngine:()=>ji,DIVISION_PRECEDENCE:()=>an,EXPONENTIATION_PRECEDENCE:()=>pl,MULTIPLICATION_PRECEDENCE:()=>ze,POSTFIX_PRECEDENCE:()=>Ct,isEnvironmentEntry:()=>Zr,isExpressionEntry:()=>Gr,isFunctionEntry:()=>hl,isInfixEntry:()=>Mt,isMatchfixEntry:()=>ci,isPostfixEntry:()=>At,isPrefixEntry:()=>Zi,isSymbolEntry:()=>jr,version:()=>zd});var A=245,di=260,sn=270,re=275,ze=390,an=600,pl=700,Ct=810;function Gr(n){return!("kind"in n)||n.kind==="expression"}function jr(n){return"kind"in n&&n.kind==="symbol"}function hl(n){return"kind"in n&&n.kind==="function"}function ci(n){return"kind"in n&&n.kind==="matchfix"}function Mt(n){return"kind"in n&&n.kind==="infix"}function Zi(n){return"kind"in n&&n.kind==="prefix"}function At(n){return"kind"in n&&n.kind==="postfix"}function Zr(n){return"kind"in n&&n.kind==="environment"}var Gi=pe(ce(),1);var mi=9e15,Pn=1e9,Jr="0123456789abcdef",Pt="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ft="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Wr={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-mi,maxE:mi,crypto:!1},Ss,En,C=!0,Lt="[DecimalError] ",On=Lt+"Invalid argument: ",Ts=Lt+"Precision limit exceeded",Bs=Lt+"crypto unavailable",Ds="[object Decimal]",ke=Math.floor,ye=Math.pow,gl=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,xl=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,bl=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Is=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Xe=1e7,I=7,yl=9007199254740991,El=Pt.length-1,Yr=Ft.length-1,y={toStringTag:Ds};y.absoluteValue=y.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),D(n)};y.ceil=function(){return D(new this.constructor(this),this.e+1,2)};y.clampedTo=y.clamp=function(n,e){var i,t=this,r=t.constructor;if(n=new r(n),e=new r(e),!n.s||!e.s)return new r(NaN);if(n.gt(e))throw Error(On+e);return i=t.cmp(n),i<0?n:t.cmp(e)>0?e:new r(t)};y.comparedTo=y.cmp=function(n){var e,i,t,r,o=this,s=o.d,a=(n=new o.constructor(n)).d,u=o.s,l=n.s;if(!s||!a)return!u||!l?NaN:u!==l?u:s===a?0:!s^u<0?1:-1;if(!s[0]||!a[0])return s[0]?u:a[0]?-l:0;if(u!==l)return u;if(o.e!==n.e)return o.e>n.e^u<0?1:-1;for(t=s.length,r=a.length,e=0,i=t<r?t:r;e<i;++e)if(s[e]!==a[e])return s[e]>a[e]^u<0?1:-1;return t===r?0:t>r^u<0?1:-1};y.cosine=y.cos=function(){var n,e,i=this,t=i.constructor;return i.d?i.d[0]?(n=t.precision,e=t.rounding,t.precision=n+Math.max(i.e,i.sd())+I,t.rounding=1,i=vl(t,As(t,i)),t.precision=n,t.rounding=e,D(En==2||En==3?i.neg():i,n,e,!0)):new t(1):new t(NaN)};y.cubeRoot=y.cbrt=function(){var n,e,i,t,r,o,s,a,u,l,f=this,d=f.constructor;if(!f.isFinite()||f.isZero())return new d(f);for(C=!1,o=f.s*ye(f.s*f,1/3),!o||Math.abs(o)==1/0?(i=Te(f.d),n=f.e,(o=(n-i.length+1)%3)&&(i+=o==1||o==-2?"0":"00"),o=ye(i,1/3),n=ke((n+1)/3)-(n%3==(n<0?-1:2)),o==1/0?i="5e"+n:(i=o.toExponential(),i=i.slice(0,i.indexOf("e")+1)+n),t=new d(i),t.s=f.s):t=new d(o.toString()),s=(n=d.precision)+3;;)if(a=t,u=a.times(a).times(a),l=u.plus(f),t=ee(l.plus(f).times(a),l.plus(u),s+2,1),Te(a.d).slice(0,s)===(i=Te(t.d)).slice(0,s))if(i=i.slice(s-3,s+1),i=="9999"||!r&&i=="4999"){if(!r&&(D(a,n+1,0),a.times(a).times(a).eq(f))){t=a;break}s+=4,r=1}else{(!+i||!+i.slice(1)&&i.charAt(0)=="5")&&(D(t,n+1,1),e=!t.times(t).times(t).eq(f));break}return C=!0,D(t,n,d.rounding,e)};y.decimalPlaces=y.dp=function(){var n,e=this.d,i=NaN;if(e){if(n=e.length-1,i=(n-ke(this.e/I))*I,n=e[n],n)for(;n%10==0;n/=10)i--;i<0&&(i=0)}return i};y.dividedBy=y.div=function(n){return ee(this,new this.constructor(n))};y.dividedToIntegerBy=y.divToInt=function(n){var e=this,i=e.constructor;return D(ee(e,new i(n),0,1,1),i.precision,i.rounding)};y.equals=y.eq=function(n){return this.cmp(n)===0};y.floor=function(){return D(new this.constructor(this),this.e+1,3)};y.greaterThan=y.gt=function(n){return this.cmp(n)>0};y.greaterThanOrEqualTo=y.gte=function(n){var e=this.cmp(n);return e==1||e===0};y.hyperbolicCosine=y.cosh=function(){var n,e,i,t,r,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;i=s.precision,t=s.rounding,s.precision=i+Math.max(o.e,o.sd())+4,s.rounding=1,r=o.d.length,r<32?(n=Math.ceil(r/3),e=(1/Vt(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),o=pi(s,1,o.times(e),new s(1),!0);for(var u,l=n,f=new s(8);l--;)u=o.times(o),o=a.minus(u.times(f.minus(u.times(f))));return D(o,s.precision=i,s.rounding=t,!0)};y.hyperbolicSine=y.sinh=function(){var n,e,i,t,r=this,o=r.constructor;if(!r.isFinite()||r.isZero())return new o(r);if(e=o.precision,i=o.rounding,o.precision=e+Math.max(r.e,r.sd())+4,o.rounding=1,t=r.d.length,t<3)r=pi(o,2,r,r,!0);else{n=1.4*Math.sqrt(t),n=n>16?16:n|0,r=r.times(1/Vt(5,n)),r=pi(o,2,r,r,!0);for(var s,a=new o(5),u=new o(16),l=new o(20);n--;)s=r.times(r),r=r.times(a.plus(s.times(u.times(s).plus(l))))}return o.precision=e,o.rounding=i,D(r,e,i,!0)};y.hyperbolicTangent=y.tanh=function(){var n,e,i=this,t=i.constructor;return i.isFinite()?i.isZero()?new t(i):(n=t.precision,e=t.rounding,t.precision=n+7,t.rounding=1,ee(i.sinh(),i.cosh(),t.precision=n,t.rounding=e)):new t(i.s)};y.inverseCosine=y.acos=function(){var n,e=this,i=e.constructor,t=e.abs().cmp(1),r=i.precision,o=i.rounding;return t!==-1?t===0?e.isNeg()?Qe(i,r,o):new i(0):new i(NaN):e.isZero()?Qe(i,r+4,o).times(.5):(i.precision=r+6,i.rounding=1,e=e.asin(),n=Qe(i,r+4,o).times(.5),i.precision=r,i.rounding=o,n.minus(e))};y.inverseHyperbolicCosine=y.acosh=function(){var n,e,i=this,t=i.constructor;return i.lte(1)?new t(i.eq(1)?0:NaN):i.isFinite()?(n=t.precision,e=t.rounding,t.precision=n+Math.max(Math.abs(i.e),i.sd())+4,t.rounding=1,C=!1,i=i.times(i).minus(1).sqrt().plus(i),C=!0,t.precision=n,t.rounding=e,i.ln()):new t(i)};y.inverseHyperbolicSine=y.asinh=function(){var n,e,i=this,t=i.constructor;return!i.isFinite()||i.isZero()?new t(i):(n=t.precision,e=t.rounding,t.precision=n+2*Math.max(Math.abs(i.e),i.sd())+6,t.rounding=1,C=!1,i=i.times(i).plus(1).sqrt().plus(i),C=!0,t.precision=n,t.rounding=e,i.ln())};y.inverseHyperbolicTangent=y.atanh=function(){var n,e,i,t,r=this,o=r.constructor;return r.isFinite()?r.e>=0?new o(r.abs().eq(1)?r.s/0:r.isZero()?r:NaN):(n=o.precision,e=o.rounding,t=r.sd(),Math.max(t,n)<2*-r.e-1?D(new o(r),n,e,!0):(o.precision=i=t-r.e,r=ee(r.plus(1),new o(1).minus(r),i+n,1),o.precision=n+4,o.rounding=1,r=r.ln(),o.precision=n,o.rounding=e,r.times(.5))):new o(NaN)};y.inverseSine=y.asin=function(){var n,e,i,t,r=this,o=r.constructor;return r.isZero()?new o(r):(e=r.abs().cmp(1),i=o.precision,t=o.rounding,e!==-1?e===0?(n=Qe(o,i+4,t).times(.5),n.s=r.s,n):new o(NaN):(o.precision=i+6,o.rounding=1,r=r.div(new o(1).minus(r.times(r)).sqrt().plus(1)).atan(),o.precision=i,o.rounding=t,r.times(2)))};y.inverseTangent=y.atan=function(){var n,e,i,t,r,o,s,a,u,l=this,f=l.constructor,d=f.precision,c=f.rounding;if(l.isFinite()){if(l.isZero())return new f(l);if(l.abs().eq(1)&&d+4<=Yr)return s=Qe(f,d+4,c).times(.25),s.s=l.s,s}else{if(!l.s)return new f(NaN);if(d+4<=Yr)return s=Qe(f,d+4,c).times(.5),s.s=l.s,s}for(f.precision=a=d+10,f.rounding=1,i=Math.min(28,a/I+2|0),n=i;n;--n)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(C=!1,e=Math.ceil(a/I),t=1,u=l.times(l),s=new f(l),r=l;n!==-1;)if(r=r.times(u),o=s.minus(r.div(t+=2)),r=r.times(u),s=o.plus(r.div(t+=2)),s.d[e]!==void 0)for(n=e;s.d[n]===o.d[n]&&n--;);return i&&(s=s.times(2<<i-1)),C=!0,D(s,f.precision=d,f.rounding=c,!0)};y.isFinite=function(){return!!this.d};y.isInteger=y.isInt=function(){return!!this.d&&ke(this.e/I)>this.d.length-2};y.isNaN=function(){return!this.s};y.isNegative=y.isNeg=function(){return this.s<0};y.isPositive=y.isPos=function(){return this.s>0};y.isZero=function(){return!!this.d&&this.d[0]===0};y.lessThan=y.lt=function(n){return this.cmp(n)<0};y.lessThanOrEqualTo=y.lte=function(n){return this.cmp(n)<1};y.logarithm=y.log=function(n){var e,i,t,r,o,s,a,u,l=this,f=l.constructor,d=f.precision,c=f.rounding,m=5;if(n==null)n=new f(10),e=!0;else{if(n=new f(n),i=n.d,n.s<0||!i||!i[0]||n.eq(1))return new f(NaN);e=n.eq(10)}if(i=l.d,l.s<0||!i||!i[0]||l.eq(1))return new f(i&&!i[0]?-1/0:l.s!=1?NaN:i?0:1/0);if(e)if(i.length>1)o=!0;else{for(r=i[0];r%10===0;)r/=10;o=r!==1}if(C=!1,a=d+m,s=An(l,a),t=e?Rt(f,a+10):An(n,a),u=ee(s,t,a,1),Hi(u.d,r=d,c))do if(a+=10,s=An(l,a),t=e?Rt(f,a+10):An(n,a),u=ee(s,t,a,1),!o){+Te(u.d).slice(r+1,r+15)+1==1e14&&(u=D(u,d+1,0));break}while(Hi(u.d,r+=10,c));return C=!0,D(u,d,c)};y.minus=y.sub=function(n){var e,i,t,r,o,s,a,u,l,f,d,c,m=this,g=m.constructor;if(n=new g(n),!m.d||!n.d)return!m.s||!n.s?n=new g(NaN):m.d?n.s=-n.s:n=new g(n.d||m.s!==n.s?m:NaN),n;if(m.s!=n.s)return n.s=-n.s,m.plus(n);if(l=m.d,c=n.d,a=g.precision,u=g.rounding,!l[0]||!c[0]){if(c[0])n.s=-n.s;else if(l[0])n=new g(m);else return new g(u===3?-0:0);return C?D(n,a,u):n}if(i=ke(n.e/I),f=ke(m.e/I),l=l.slice(),o=f-i,o){for(d=o<0,d?(e=l,o=-o,s=c.length):(e=c,i=f,s=l.length),t=Math.max(Math.ceil(a/I),s)+2,o>t&&(o=t,e.length=1),e.reverse(),t=o;t--;)e.push(0);e.reverse()}else{for(t=l.length,s=c.length,d=t<s,d&&(s=t),t=0;t<s;t++)if(l[t]!=c[t]){d=l[t]<c[t];break}o=0}for(d&&(e=l,l=c,c=e,n.s=-n.s),s=l.length,t=c.length-s;t>0;--t)l[s++]=0;for(t=c.length;t>o;){if(l[--t]<c[t]){for(r=t;r&&l[--r]===0;)l[r]=Xe-1;--l[r],l[t]+=Xe}l[t]-=c[t]}for(;l[--s]===0;)l.pop();for(;l[0]===0;l.shift())--i;return l[0]?(n.d=l,n.e=qt(l,i),C?D(n,a,u):n):new g(u===3?-0:0)};y.modulo=y.mod=function(n){var e,i=this,t=i.constructor;return n=new t(n),!i.d||!n.s||n.d&&!n.d[0]?new t(NaN):!n.d||i.d&&!i.d[0]?D(new t(i),t.precision,t.rounding):(C=!1,t.modulo==9?(e=ee(i,n.abs(),0,3,1),e.s*=n.s):e=ee(i,n,0,t.modulo,1),e=e.times(n),C=!0,i.minus(e))};y.naturalExponential=y.exp=function(){return Qr(this)};y.naturalLogarithm=y.ln=function(){return An(this)};y.negated=y.neg=function(){var n=new this.constructor(this);return n.s=-n.s,D(n)};y.plus=y.add=function(n){var e,i,t,r,o,s,a,u,l,f,d=this,c=d.constructor;if(n=new c(n),!d.d||!n.d)return!d.s||!n.s?n=new c(NaN):d.d||(n=new c(n.d||d.s===n.s?d:NaN)),n;if(d.s!=n.s)return n.s=-n.s,d.minus(n);if(l=d.d,f=n.d,a=c.precision,u=c.rounding,!l[0]||!f[0])return f[0]||(n=new c(d)),C?D(n,a,u):n;if(o=ke(d.e/I),t=ke(n.e/I),l=l.slice(),r=o-t,r){for(r<0?(i=l,r=-r,s=f.length):(i=f,t=o,s=l.length),o=Math.ceil(a/I),s=o>s?o+1:s+1,r>s&&(r=s,i.length=1),i.reverse();r--;)i.push(0);i.reverse()}for(s=l.length,r=f.length,s-r<0&&(r=s,i=f,f=l,l=i),e=0;r;)e=(l[--r]=l[r]+f[r]+e)/Xe|0,l[r]%=Xe;for(e&&(l.unshift(e),++t),s=l.length;l[--s]==0;)l.pop();return n.d=l,n.e=qt(l,t),C?D(n,a,u):n};y.precision=y.sd=function(n){var e,i=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(On+n);return i.d?(e=ks(i.d),n&&i.e+1>e&&(e=i.e+1)):e=NaN,e};y.round=function(){var n=this,e=n.constructor;return D(new e(n),n.e+1,e.rounding)};y.sine=y.sin=function(){var n,e,i=this,t=i.constructor;return i.isFinite()?i.isZero()?new t(i):(n=t.precision,e=t.rounding,t.precision=n+Math.max(i.e,i.sd())+I,t.rounding=1,i=_l(t,As(t,i)),t.precision=n,t.rounding=e,D(En>2?i.neg():i,n,e,!0)):new t(NaN)};y.squareRoot=y.sqrt=function(){var n,e,i,t,r,o,s=this,a=s.d,u=s.e,l=s.s,f=s.constructor;if(l!==1||!a||!a[0])return new f(!l||l<0&&(!a||a[0])?NaN:a?s:1/0);for(C=!1,l=Math.sqrt(+s),l==0||l==1/0?(e=Te(a),(e.length+u)%2==0&&(e+="0"),l=Math.sqrt(e),u=ke((u+1)/2)-(u<0||u%2),l==1/0?e="5e"+u:(e=l.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),t=new f(e)):t=new f(l.toString()),i=(u=f.precision)+3;;)if(o=t,t=o.plus(ee(s,o,i+2,1)).times(.5),Te(o.d).slice(0,i)===(e=Te(t.d)).slice(0,i))if(e=e.slice(i-3,i+1),e=="9999"||!r&&e=="4999"){if(!r&&(D(o,u+1,0),o.times(o).eq(s))){t=o;break}i+=4,r=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(D(t,u+1,1),n=!t.times(t).eq(s));break}return C=!0,D(t,u,f.rounding,n)};y.tangent=y.tan=function(){var n,e,i=this,t=i.constructor;return i.isFinite()?i.isZero()?new t(i):(n=t.precision,e=t.rounding,t.precision=n+10,t.rounding=1,i=i.sin(),i.s=1,i=ee(i,new t(1).minus(i.times(i)).sqrt(),n+10,0),t.precision=n,t.rounding=e,D(En==2||En==4?i.neg():i,n,e,!0)):new t(NaN)};y.times=y.mul=function(n){var e,i,t,r,o,s,a,u,l,f=this,d=f.constructor,c=f.d,m=(n=new d(n)).d;if(n.s*=f.s,!c||!c[0]||!m||!m[0])return new d(!n.s||c&&!c[0]&&!m||m&&!m[0]&&!c?NaN:!c||!m?n.s/0:n.s*0);for(i=ke(f.e/I)+ke(n.e/I),u=c.length,l=m.length,u<l&&(o=c,c=m,m=o,s=u,u=l,l=s),o=[],s=u+l,t=s;t--;)o.push(0);for(t=l;--t>=0;){for(e=0,r=u+t;r>t;)a=o[r]+m[t]*c[r-t-1]+e,o[r--]=a%Xe|0,e=a/Xe|0;o[r]=(o[r]+e)%Xe|0}for(;!o[--s];)o.pop();return e?++i:o.shift(),n.d=o,n.e=qt(o,i),C?D(n,d.precision,d.rounding):n};y.toBinary=function(n,e){return Kr(this,2,n,e)};y.toDecimalPlaces=y.toDP=function(n,e){var i=this,t=i.constructor;return i=new t(i),n===void 0?i:(Me(n,0,Pn),e===void 0?e=t.rounding:Me(e,0,8),D(i,n+i.e+1,e))};y.toExponential=function(n,e){var i,t=this,r=t.constructor;return n===void 0?i=un(t,!0):(Me(n,0,Pn),e===void 0?e=r.rounding:Me(e,0,8),t=D(new r(t),n+1,e),i=un(t,!0,n+1)),t.isNeg()&&!t.isZero()?"-"+i:i};y.toFixed=function(n,e){var i,t,r=this,o=r.constructor;return n===void 0?i=un(r):(Me(n,0,Pn),e===void 0?e=o.rounding:Me(e,0,8),t=D(new o(r),n+r.e+1,e),i=un(t,!1,n+t.e+1)),r.isNeg()&&!r.isZero()?"-"+i:i};y.toFraction=function(n){var e,i,t,r,o,s,a,u,l,f,d,c,m=this,g=m.d,h=m.constructor;if(!g)return new h(m);if(l=i=new h(1),t=u=new h(0),e=new h(t),o=e.e=ks(g)-m.e-1,s=o%I,e.d[0]=ye(10,s<0?I+s:s),n==null)n=o>0?e:l;else{if(a=new h(n),!a.isInt()||a.lt(l))throw Error(On+a);n=a.gt(e)?o>0?e:l:a}for(C=!1,a=new h(Te(g)),f=h.precision,h.precision=o=g.length*I*2;d=ee(a,e,0,1,1),r=i.plus(d.times(t)),r.cmp(n)!=1;)i=t,t=r,r=l,l=u.plus(d.times(r)),u=r,r=e,e=a.minus(d.times(r)),a=r;return r=ee(n.minus(i),t,0,1,1),u=u.plus(r.times(l)),i=i.plus(r.times(t)),u.s=l.s=m.s,c=ee(l,t,o,1).minus(m).abs().cmp(ee(u,i,o,1).minus(m).abs())<1?[l,t]:[u,i],h.precision=f,C=!0,c};y.toHexadecimal=y.toHex=function(n,e){return Kr(this,16,n,e)};y.toNearest=function(n,e){var i=this,t=i.constructor;if(i=new t(i),n==null){if(!i.d)return i;n=new t(1),e=t.rounding}else{if(n=new t(n),e===void 0?e=t.rounding:Me(e,0,8),!i.d)return n.s?i:n;if(!n.d)return n.s&&(n.s=i.s),n}return n.d[0]?(C=!1,i=ee(i,n,0,e,1).times(n),C=!0,D(i)):(n.s=i.s,i=n),i};y.toNumber=function(){return+this};y.toOctal=function(n,e){return Kr(this,8,n,e)};y.toPower=y.pow=function(n){var e,i,t,r,o,s,a=this,u=a.constructor,l=+(n=new u(n));if(!a.d||!n.d||!a.d[0]||!n.d[0])return new u(ye(+a,l));if(a=new u(a),a.eq(1))return a;if(t=u.precision,o=u.rounding,n.eq(1))return D(a,t,o);if(e=ke(n.e/I),e>=n.d.length-1&&(i=l<0?-l:l)<=yl)return r=ws(u,a,i,t),n.s<0?new u(1).div(r):D(r,t,o);if(s=a.s,s<0){if(e<n.d.length-1)return new u(NaN);if(n.d[e]&1||(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return i=ye(+a,l),e=i==0||!isFinite(i)?ke(l*(Math.log("0."+Te(a.d))/Math.LN10+a.e+1)):new u(i+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?s/0:0):(C=!1,u.rounding=a.s=1,i=Math.min(12,(e+"").length),r=Qr(n.times(An(a,t+i)),t),r.d&&(r=D(r,t+5,1),Hi(r.d,t,o)&&(e=t+10,r=D(Qr(n.times(An(a,e+i)),e),e+5,1),+Te(r.d).slice(t+1,t+15)+1==1e14&&(r=D(r,t+1,0)))),r.s=s,C=!0,u.rounding=o,D(r,t,o))};y.toPrecision=function(n,e){var i,t=this,r=t.constructor;return n===void 0?i=un(t,t.e<=r.toExpNeg||t.e>=r.toExpPos):(Me(n,1,Pn),e===void 0?e=r.rounding:Me(e,0,8),t=D(new r(t),n,e),i=un(t,n<=t.e||t.e<=r.toExpNeg,n)),t.isNeg()&&!t.isZero()?"-"+i:i};y.toSignificantDigits=y.toSD=function(n,e){var i=this,t=i.constructor;return n===void 0?(n=t.precision,e=t.rounding):(Me(n,1,Pn),e===void 0?e=t.rounding:Me(e,0,8)),D(new t(i),n,e)};y.toString=function(){var n=this,e=n.constructor,i=un(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+i:i};y.truncated=y.trunc=function(){return D(new this.constructor(this),this.e+1,1)};y.valueOf=y.toJSON=function(){var n=this,e=n.constructor,i=un(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+i:i};function Te(n){var e,i,t,r=n.length-1,o="",s=n[0];if(r>0){for(o+=s,e=1;e<r;e++)t=n[e]+"",i=I-t.length,i&&(o+=Mn(i)),o+=t;s=n[e],t=s+"",i=I-t.length,i&&(o+=Mn(i))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function Me(n,e,i){if(n!==~~n||n<e||n>i)throw Error(On+n)}function Hi(n,e,i,t){var r,o,s,a;for(o=n[0];o>=10;o/=10)--e;return--e<0?(e+=I,r=0):(r=Math.ceil((e+1)/I),e%=I),o=ye(10,I-e),a=n[r]%o|0,t==null?e<3?(e==0?a=a/100|0:e==1&&(a=a/10|0),s=i<4&&a==99999||i>3&&a==49999||a==5e4||a==0):s=(i<4&&a+1==o||i>3&&a+1==o/2)&&(n[r+1]/o/100|0)==ye(10,e-2)-1||(a==o/2||a==0)&&(n[r+1]/o/100|0)==0:e<4?(e==0?a=a/1e3|0:e==1?a=a/100|0:e==2&&(a=a/10|0),s=(t||i<4)&&a==9999||!t&&i>3&&a==4999):s=((t||i<4)&&a+1==o||!t&&i>3&&a+1==o/2)&&(n[r+1]/o/1e3|0)==ye(10,e-3)-1,s}function Ot(n,e,i){for(var t,r=[0],o,s=0,a=n.length;s<a;){for(o=r.length;o--;)r[o]*=e;for(r[0]+=Jr.indexOf(n.charAt(s++)),t=0;t<r.length;t++)r[t]>i-1&&(r[t+1]===void 0&&(r[t+1]=0),r[t+1]+=r[t]/i|0,r[t]%=i)}return r.reverse()}function vl(n,e){var i,t,r;if(e.isZero())return e;t=e.d.length,t<32?(i=Math.ceil(t/3),r=(1/Vt(4,i)).toString()):(i=16,r="2.3283064365386962890625e-10"),n.precision+=i,e=pi(n,1,e.times(r),new n(1));for(var o=i;o--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return n.precision-=i,e}var ee=function(){function n(t,r,o){var s,a=0,u=t.length;for(t=t.slice();u--;)s=t[u]*r+a,t[u]=s%o|0,a=s/o|0;return a&&t.unshift(a),t}function e(t,r,o,s){var a,u;if(o!=s)u=o>s?1:-1;else for(a=u=0;a<o;a++)if(t[a]!=r[a]){u=t[a]>r[a]?1:-1;break}return u}function i(t,r,o,s){for(var a=0;o--;)t[o]-=a,a=t[o]<r[o]?1:0,t[o]=a*s+t[o]-r[o];for(;!t[0]&&t.length>1;)t.shift()}return function(t,r,o,s,a,u){var l,f,d,c,m,g,h,x,S,T,_,w,j,Z,De,$e,Ce,zr,Ye,It,kt=t.constructor,Ur=t.s==r.s?1:-1,Ie=t.d,ne=r.d;if(!Ie||!Ie[0]||!ne||!ne[0])return new kt(!t.s||!r.s||(Ie?ne&&Ie[0]==ne[0]:!ne)?NaN:Ie&&Ie[0]==0||!ne?Ur*0:Ur/0);for(u?(m=1,f=t.e-r.e):(u=Xe,m=I,f=ke(t.e/m)-ke(r.e/m)),Ye=ne.length,Ce=Ie.length,S=new kt(Ur),T=S.d=[],d=0;ne[d]==(Ie[d]||0);d++);if(ne[d]>(Ie[d]||0)&&f--,o==null?(Z=o=kt.precision,s=kt.rounding):a?Z=o+(t.e-r.e)+1:Z=o,Z<0)T.push(1),g=!0;else{if(Z=Z/m+2|0,d=0,Ye==1){for(c=0,ne=ne[0],Z++;(d<Ce||c)&&Z--;d++)De=c*u+(Ie[d]||0),T[d]=De/ne|0,c=De%ne|0;g=c||d<Ce}else{for(c=u/(ne[0]+1)|0,c>1&&(ne=n(ne,c,u),Ie=n(Ie,c,u),Ye=ne.length,Ce=Ie.length),$e=Ye,_=Ie.slice(0,Ye),w=_.length;w<Ye;)_[w++]=0;It=ne.slice(),It.unshift(0),zr=ne[0],ne[1]>=u/2&&++zr;do c=0,l=e(ne,_,Ye,w),l<0?(j=_[0],Ye!=w&&(j=j*u+(_[1]||0)),c=j/zr|0,c>1?(c>=u&&(c=u-1),h=n(ne,c,u),x=h.length,w=_.length,l=e(h,_,x,w),l==1&&(c--,i(h,Ye<x?It:ne,x,u))):(c==0&&(l=c=1),h=ne.slice()),x=h.length,x<w&&h.unshift(0),i(_,h,w,u),l==-1&&(w=_.length,l=e(ne,_,Ye,w),l<1&&(c++,i(_,Ye<w?It:ne,w,u))),w=_.length):l===0&&(c++,_=[0]),T[d++]=c,l&&_[0]?_[w++]=Ie[$e]||0:(_=[Ie[$e]],w=1);while(($e++<Ce||_[0]!==void 0)&&Z--);g=_[0]!==void 0}T[0]||T.shift()}if(m==1)S.e=f,Ss=g;else{for(d=1,c=T[0];c>=10;c/=10)d++;S.e=d+f*m-1,D(S,a?o+S.e+1:o,s,g)}return S}}();function D(n,e,i,t){var r,o,s,a,u,l,f,d,c,m=n.constructor;e:if(e!=null){if(d=n.d,!d)return n;for(r=1,a=d[0];a>=10;a/=10)r++;if(o=e-r,o<0)o+=I,s=e,f=d[c=0],u=f/ye(10,r-s-1)%10|0;else if(c=Math.ceil((o+1)/I),a=d.length,c>=a)if(t){for(;a++<=c;)d.push(0);f=u=0,r=1,o%=I,s=o-I+1}else break e;else{for(f=a=d[c],r=1;a>=10;a/=10)r++;o%=I,s=o-I+r,u=s<0?0:f/ye(10,r-s-1)%10|0}if(t=t||e<0||d[c+1]!==void 0||(s<0?f:f%ye(10,r-s-1)),l=i<4?(u||t)&&(i==0||i==(n.s<0?3:2)):u>5||u==5&&(i==4||t||i==6&&(o>0?s>0?f/ye(10,r-s):0:d[c-1])%10&1||i==(n.s<0?8:7)),e<1||!d[0])return d.length=0,l?(e-=n.e+1,d[0]=ye(10,(I-e%I)%I),n.e=-e||0):d[0]=n.e=0,n;if(o==0?(d.length=c,a=1,c--):(d.length=c+1,a=ye(10,I-o),d[c]=s>0?(f/ye(10,r-s)%ye(10,s)|0)*a:0),l)for(;;)if(c==0){for(o=1,s=d[0];s>=10;s/=10)o++;for(s=d[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(n.e++,d[0]==Xe&&(d[0]=1));break}else{if(d[c]+=a,d[c]!=Xe)break;d[c--]=0,a=1}for(o=d.length;d[--o]===0;)d.pop()}return C&&(n.e>m.maxE?(n.d=null,n.e=NaN):n.e<m.minE&&(n.e=0,n.d=[0])),n}function un(n,e,i){if(!n.isFinite())return Ms(n);var t,r=n.e,o=Te(n.d),s=o.length;return e?(i&&(t=i-s)>0?o=o.charAt(0)+"."+o.slice(1)+Mn(t):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(n.e<0?"e":"e+")+n.e):r<0?(o="0."+Mn(-r-1)+o,i&&(t=i-s)>0&&(o+=Mn(t))):r>=s?(o+=Mn(r+1-s),i&&(t=i-r-1)>0&&(o=o+"."+Mn(t))):((t=r+1)<s&&(o=o.slice(0,t)+"."+o.slice(t)),i&&(t=i-s)>0&&(r+1===s&&(o+="."),o+=Mn(t))),o}function qt(n,e){var i=n[0];for(e*=I;i>=10;i/=10)e++;return e}function Rt(n,e,i){if(e>El)throw C=!0,i&&(n.precision=i),Error(Ts);return D(new n(Pt),e,1,!0)}function Qe(n,e,i){if(e>Yr)throw Error(Ts);return D(new n(Ft),e,i,!0)}function ks(n){var e=n.length-1,i=e*I+1;if(e=n[e],e){for(;e%10==0;e/=10)i--;for(e=n[0];e>=10;e/=10)i++}return i}function Mn(n){for(var e="";n--;)e+="0";return e}function ws(n,e,i,t){var r,o=new n(1),s=Math.ceil(t/I+4);for(C=!1;;){if(i%2&&(o=o.times(e),Ns(o.d,s)&&(r=!0)),i=ke(i/2),i===0){i=o.d.length-1,r&&o.d[i]===0&&++o.d[i];break}e=e.times(e),Ns(e.d,s)}return C=!0,o}function vs(n){return n.d[n.d.length-1]&1}function Cs(n,e,i){for(var t,r=new n(e[0]),o=0;++o<e.length;)if(t=new n(e[o]),t.s)r[i](t)&&(r=t);else{r=t;break}return r}function Qr(n,e){var i,t,r,o,s,a,u,l=0,f=0,d=0,c=n.constructor,m=c.rounding,g=c.precision;if(!n.d||!n.d[0]||n.e>17)return new c(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(C=!1,u=g):u=e,a=new c(.03125);n.e>-2;)n=n.times(a),d+=5;for(t=Math.log(ye(2,d))/Math.LN10*2+5|0,u+=t,i=o=s=new c(1),c.precision=u;;){if(o=D(o.times(n),u,1),i=i.times(++f),a=s.plus(ee(o,i,u,1)),Te(a.d).slice(0,u)===Te(s.d).slice(0,u)){for(r=d;r--;)s=D(s.times(s),u,1);if(e==null)if(l<3&&Hi(s.d,u-t,m,l))c.precision=u+=10,i=o=a=new c(1),f=0,l++;else return D(s,c.precision=g,m,C=!0);else return c.precision=g,s}s=a}}function An(n,e){var i,t,r,o,s,a,u,l,f,d,c,m=1,g=10,h=n,x=h.d,S=h.constructor,T=S.rounding,_=S.precision;if(h.s<0||!x||!x[0]||!h.e&&x[0]==1&&x.length==1)return new S(x&&!x[0]?-1/0:h.s!=1?NaN:x?0:h);if(e==null?(C=!1,f=_):f=e,S.precision=f+=g,i=Te(x),t=i.charAt(0),Math.abs(o=h.e)<15e14){for(;t<7&&t!=1||t==1&&i.charAt(1)>3;)h=h.times(n),i=Te(h.d),t=i.charAt(0),m++;o=h.e,t>1?(h=new S("0."+i),o++):h=new S(t+"."+i.slice(1))}else return l=Rt(S,f+2,_).times(o+""),h=An(new S(t+"."+i.slice(1)),f-g).plus(l),S.precision=_,e==null?D(h,_,T,C=!0):h;for(d=h,u=s=h=ee(h.minus(1),h.plus(1),f,1),c=D(h.times(h),f,1),r=3;;){if(s=D(s.times(c),f,1),l=u.plus(ee(s,new S(r),f,1)),Te(l.d).slice(0,f)===Te(u.d).slice(0,f))if(u=u.times(2),o!==0&&(u=u.plus(Rt(S,f+2,_).times(o+""))),u=ee(u,new S(m),f,1),e==null)if(Hi(u.d,f-g,T,a))S.precision=f+=g,l=s=h=ee(d.minus(1),d.plus(1),f,1),c=D(h.times(h),f,1),r=a=1;else return D(u,S.precision=_,T,C=!0);else return S.precision=_,u;u=l,r+=2}}function Ms(n){return String(n.s*n.s/0)}function Xr(n,e){var i,t,r;for((i=e.indexOf("."))>-1&&(e=e.replace(".","")),(t=e.search(/e/i))>0?(i<0&&(i=t),i+=+e.slice(t+1),e=e.substring(0,t)):i<0&&(i=e.length),t=0;e.charCodeAt(t)===48;t++);for(r=e.length;e.charCodeAt(r-1)===48;--r);if(e=e.slice(t,r),e){if(r-=t,n.e=i=i-t-1,n.d=[],t=(i+1)%I,i<0&&(t+=I),t<r){for(t&&n.d.push(+e.slice(0,t)),r-=I;t<r;)n.d.push(+e.slice(t,t+=I));e=e.slice(t),t=I-e.length}else t-=r;for(;t--;)e+="0";n.d.push(+e),C&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function Nl(n,e){var i,t,r,o,s,a,u,l,f;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),Is.test(e))return Xr(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(xl.test(e))i=16,e=e.toLowerCase();else if(gl.test(e))i=2;else if(bl.test(e))i=8;else throw Error(On+e);for(o=e.search(/p/i),o>0?(u=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),o=e.indexOf("."),s=o>=0,t=n.constructor,s&&(e=e.replace(".",""),a=e.length,o=a-o,r=ws(t,new t(i),o,o*2)),l=Ot(e,i,Xe),f=l.length-1,o=f;l[o]===0;--o)l.pop();return o<0?new t(n.s*0):(n.e=qt(l,f),n.d=l,C=!1,s&&(n=ee(n,r,a*4)),u&&(n=n.times(Math.abs(u)<54?ye(2,u):v.pow(2,u))),C=!0,n)}function _l(n,e){var i,t=e.d.length;if(t<3)return e.isZero()?e:pi(n,2,e,e);i=1.4*Math.sqrt(t),i=i>16?16:i|0,e=e.times(1/Vt(5,i)),e=pi(n,2,e,e);for(var r,o=new n(5),s=new n(16),a=new n(20);i--;)r=e.times(e),e=e.times(o.plus(r.times(s.times(r).minus(a))));return e}function pi(n,e,i,t,r){var o,s,a,u,l=1,f=n.precision,d=Math.ceil(f/I);for(C=!1,u=i.times(i),a=new n(t);;){if(s=ee(a.times(u),new n(e++*e++),f,1),a=r?t.plus(s):t.minus(s),t=ee(s.times(u),new n(e++*e++),f,1),s=a.plus(t),s.d[d]!==void 0){for(o=d;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=t,t=s,s=o,l++}return C=!0,s.d.length=d+1,s}function Vt(n,e){for(var i=n;--e;)i*=n;return i}function As(n,e){var i,t=e.s<0,r=Qe(n,n.precision,1),o=r.times(.5);if(e=e.abs(),e.lte(o))return En=t?4:1,e;if(i=e.divToInt(r),i.isZero())En=t?3:2;else{if(e=e.minus(i.times(r)),e.lte(o))return En=vs(i)?t?2:3:t?4:1,e;En=vs(i)?t?1:4:t?3:2}return e.minus(r).abs()}function Kr(n,e,i,t){var r,o,s,a,u,l,f,d,c,m=n.constructor,g=i!==void 0;if(g?(Me(i,1,Pn),t===void 0?t=m.rounding:Me(t,0,8)):(i=m.precision,t=m.rounding),!n.isFinite())f=Ms(n);else{for(f=un(n),s=f.indexOf("."),g?(r=2,e==16?i=i*4-3:e==8&&(i=i*3-2)):r=e,s>=0&&(f=f.replace(".",""),c=new m(1),c.e=f.length-s,c.d=Ot(un(c),10,r),c.e=c.d.length),d=Ot(f,10,r),o=u=d.length;d[--u]==0;)d.pop();if(!d[0])f=g?"0p+0":"0";else{if(s<0?o--:(n=new m(n),n.d=d,n.e=o,n=ee(n,c,i,t,0,r),d=n.d,o=n.e,l=Ss),s=d[i],a=r/2,l=l||d[i+1]!==void 0,l=t<4?(s!==void 0||l)&&(t===0||t===(n.s<0?3:2)):s>a||s===a&&(t===4||l||t===6&&d[i-1]&1||t===(n.s<0?8:7)),d.length=i,l)for(;++d[--i]>r-1;)d[i]=0,i||(++o,d.unshift(1));for(u=d.length;!d[u-1];--u);for(s=0,f="";s<u;s++)f+=Jr.charAt(d[s]);if(g){if(u>1)if(e==16||e==8){for(s=e==16?4:3,--u;u%s;u++)f+="0";for(d=Ot(f,r,e),u=d.length;!d[u-1];--u);for(s=1,f="1.";s<u;s++)f+=Jr.charAt(d[s])}else f=f.charAt(0)+"."+f.slice(1);f=f+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)f="0"+f;f="0."+f}else if(++o>u)for(o-=u;o--;)f+="0";else o<u&&(f=f.slice(0,o)+"."+f.slice(o))}f=(e==16?"0x":e==2?"0b":e==8?"0o":"")+f}return n.s<0?"-"+f:f}function Ns(n,e){if(n.length>e)return n.length=e,!0}function Sl(n){return new this(n).abs()}function Tl(n){return new this(n).acos()}function Bl(n){return new this(n).acosh()}function Dl(n,e){return new this(n).plus(e)}function Il(n){return new this(n).asin()}function kl(n){return new this(n).asinh()}function wl(n){return new this(n).atan()}function Cl(n){return new this(n).atanh()}function Ml(n,e){n=new this(n),e=new this(e);var i,t=this.precision,r=this.rounding,o=t+4;return!n.s||!e.s?i=new this(NaN):!n.d&&!e.d?(i=Qe(this,o,1).times(e.s>0?.25:.75),i.s=n.s):!e.d||n.isZero()?(i=e.s<0?Qe(this,t,r):new this(0),i.s=n.s):!n.d||e.isZero()?(i=Qe(this,o,1).times(.5),i.s=n.s):e.s<0?(this.precision=o,this.rounding=1,i=this.atan(ee(n,e,o,1)),e=Qe(this,o,1),this.precision=t,this.rounding=r,i=n.s<0?i.minus(e):i.plus(e)):i=this.atan(ee(n,e,o,1)),i}function Al(n){return new this(n).cbrt()}function Ol(n){return D(n=new this(n),n.e+1,2)}function Pl(n,e,i){return new this(n).clamp(e,i)}function Fl(n){if(!n||typeof n!="object")throw Error(Lt+"Object expected");var e,i,t,r=n.defaults===!0,o=["precision",1,Pn,"rounding",0,8,"toExpNeg",-mi,0,"toExpPos",0,mi,"maxE",0,mi,"minE",-mi,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(i=o[e],r&&(this[i]=Wr[i]),(t=n[i])!==void 0)if(ke(t)===t&&t>=o[e+1]&&t<=o[e+2])this[i]=t;else throw Error(On+i+": "+t);if(i="crypto",r&&(this[i]=Wr[i]),(t=n[i])!==void 0)if(t===!0||t===!1||t===0||t===1)if(t)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[i]=!0;else throw Error(Bs);else this[i]=!1;else throw Error(On+i+": "+t);return this}function Rl(n){return new this(n).cos()}function Ll(n){return new this(n).cosh()}function Os(n){var e,i,t;function r(o){var s,a,u,l=this;if(!(l instanceof r))return new r(o);if(l.constructor=r,_s(o)){l.s=o.s,C?!o.d||o.e>r.maxE?(l.e=NaN,l.d=null):o.e<r.minE?(l.e=0,l.d=[0]):(l.e=o.e,l.d=o.d.slice()):(l.e=o.e,l.d=o.d?o.d.slice():o.d);return}if(u=typeof o,u==="number"){if(o===0){l.s=1/o<0?-1:1,l.e=0,l.d=[0];return}if(o<0?(o=-o,l.s=-1):l.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;C?s>r.maxE?(l.e=NaN,l.d=null):s<r.minE?(l.e=0,l.d=[0]):(l.e=s,l.d=[o]):(l.e=s,l.d=[o]);return}else if(o*0!==0){o||(l.s=NaN),l.e=NaN,l.d=null;return}return Xr(l,o.toString())}else if(u!=="string")throw Error(On+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),l.s=-1):(a===43&&(o=o.slice(1)),l.s=1),Is.test(o)?Xr(l,o):Nl(l,o)}if(r.prototype=y,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=Fl,r.clone=Os,r.isDecimal=_s,r.abs=Sl,r.acos=Tl,r.acosh=Bl,r.add=Dl,r.asin=Il,r.asinh=kl,r.atan=wl,r.atanh=Cl,r.atan2=Ml,r.cbrt=Al,r.ceil=Ol,r.clamp=Pl,r.cos=Rl,r.cosh=Ll,r.div=ql,r.exp=Vl,r.floor=$l,r.hypot=zl,r.ln=Ul,r.log=Gl,r.log10=Zl,r.log2=jl,r.max=Hl,r.min=Jl,r.mod=Wl,r.mul=Yl,r.pow=Ql,r.random=Xl,r.round=Kl,r.sign=ef,r.sin=nf,r.sinh=tf,r.sqrt=rf,r.sub=of,r.sum=sf,r.tan=af,r.tanh=uf,r.trunc=lf,n===void 0&&(n={}),n&&n.defaults!==!0)for(t=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<t.length;)n.hasOwnProperty(i=t[e++])||(n[i]=this[i]);return r.config(n),r}function ql(n,e){return new this(n).div(e)}function Vl(n){return new this(n).exp()}function $l(n){return D(n=new this(n),n.e+1,3)}function zl(){var n,e,i=new this(0);for(C=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)i.d&&(i=i.plus(e.times(e)));else{if(e.s)return C=!0,new this(1/0);i=e}return C=!0,i.sqrt()}function _s(n){return n instanceof v||n&&n.toStringTag===Ds||!1}function Ul(n){return new this(n).ln()}function Gl(n,e){return new this(n).log(e)}function jl(n){return new this(n).log(2)}function Zl(n){return new this(n).log(10)}function Hl(){return Cs(this,arguments,"lt")}function Jl(){return Cs(this,arguments,"gt")}function Wl(n,e){return new this(n).mod(e)}function Yl(n,e){return new this(n).mul(e)}function Ql(n,e){return new this(n).pow(e)}function Xl(n){var e,i,t,r,o=0,s=new this(1),a=[];if(n===void 0?n=this.precision:Me(n,1,Pn),t=Math.ceil(n/I),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(t));o<t;)r=e[o],r>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=r%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(t*=4);o<t;)r=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((e[o+3]&127)<<24),r>=214e7?crypto.randomBytes(4).copy(e,o):(a.push(r%1e7),o+=4);o=t/4}else throw Error(Bs);else for(;o<t;)a[o++]=Math.random()*1e7|0;for(t=a[--o],n%=I,t&&n&&(r=ye(10,I-n),a[o]=(t/r|0)*r);a[o]===0;o--)a.pop();if(o<0)i=0,a=[0];else{for(i=-1;a[0]===0;i-=I)a.shift();for(t=1,r=a[0];r>=10;r/=10)t++;t<I&&(i-=I-t)}return s.e=i,s.d=a,s}function Kl(n){return D(n=new this(n),n.e+1,this.rounding)}function ef(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function nf(n){return new this(n).sin()}function tf(n){return new this(n).sinh()}function rf(n){return new this(n).sqrt()}function of(n,e){return new this(n).sub(e)}function sf(){var n=0,e=arguments,i=new this(e[n]);for(C=!1;i.s&&++n<e.length;)i=i.plus(e[n]);return C=!0,D(i,this.precision,this.rounding)}function af(n){return new this(n).tan()}function uf(n){return new this(n).tanh()}function lf(n){return D(n=new this(n),n.e+1,1)}y[Symbol.for("nodejs.util.inspect.custom")]=y.toString;y[Symbol.toStringTag]="Decimal";var v=y.constructor=Os(Wr);Pt=new v(Pt);Ft=new v(Ft);var Ue=v;function ff(n){let e=[];for(let i=0;i<n.length;i++){let t=n.charCodeAt(i);if(t>=55296&&t<=56319){let r=n.charCodeAt(i+1);if(r>=56320&&r<=57343){let o=t-55296,s=r-56320;t=2**16+o*2**10+s,i++}}e.push(t)}return e}var $t=8205,Ps=[127462,127487];function Fs(n){return n===$t||n===65038||n===65039||n>=127995&&n<=128e3||n>=129456&&n<=129460||n>=917536&&n<=917632}function df(n){return n>=Ps[0]&&n<=Ps[1]}function Rs(n){if(/^[\u0020-\u00FF]*$/.test(n))return n;let e=[],i=ff(n),t=0;for(;t<i.length;){let r=i[t++],o=i[t];if(o===$t){let s=t-1;for(t+=2;i[t]===$t;)t+=2;e.push(String.fromCodePoint(...i.slice(s,2*t-s+1)))}else if(Fs(o)){let s=t-1;for(;Fs(i[t]);)t+=i[t]===$t?2:1;e.push(String.fromCodePoint(...i.slice(s,2*t-s-1)))}else df(r)?(t+=1,e.push(String.fromCodePoint(...i.slice(t-2,2)))):e.push(String.fromCodePoint(r))}return e}var eo=class{constructor(e){this.obeyspaces=!1;e=e.replace(/[\u200E\u200F\u2066-\u2069\u202A-\u202E]/g,""),this.s=Rs(e),this.pos=0}end(){return this.pos>=this.s.length}get(){return this.pos<this.s.length?this.s[this.pos++]:""}peek(){return this.s[this.pos]}match(e){let i;return typeof this.s=="string"?i=e.exec(this.s.slice(this.pos)):i=e.exec(this.s.slice(this.pos).join("")),i?.[0]?(this.pos+=i[0].length,i[0]):null}next(){if(this.end())return null;if(!this.obeyspaces&&this.match(/^[ \f\n\r\t\v\xA0\u2028\u2029]+/))return"<space>";if(this.obeyspaces&&this.match(/^[ \f\n\r\t\v\xA0\u2028\u2029]/))return"<space>";let e=this.get();if(e==="\\"){if(!this.end()){let i=this.match(/^[a-zA-Z*]+/);if(i)this.match(/^[ \f\n\r\t\v\xA0\u2028\u2029]*/);else if(i=this.get(),i===" ")return"<space>";return"\\"+i}}else{if(e==="{")return"<{>";if(e==="}")return"<}>";if(e==="^"){if(this.peek()==="^"){this.get();let i=this.match(/^(\^(\^(\^(\^[0-9a-f])?[0-9a-f])?[0-9a-f])?[0-9a-f])?[0-9a-f][0-9a-f]/);if(i)return String.fromCodePoint(parseInt(i.slice(i.lastIndexOf("^")+1),16))}return e}else if(e==="#"){if(!this.end()){let i=!1;if(/[0-9?]/.test(this.peek())&&(i=!0,this.pos+1<this.s.length)){let t=this.s[this.pos+1];i=/[^0-9A-Za-z]/.test(t)}return i?"#"+this.get():"#"}}else if(e==="$")return this.peek()==="$"?(this.get(),"<$$>"):"<$>"}return e}};function cf(n,e){let i=n.next();if(!i)return[];let t=[];if(i!=="\\relax"){if(i==="\\noexpand")i=n.next(),i&&t.push(i);else if(i==="\\obeyspaces")n.obeyspaces=!0;else if(i==="\\space"||i==="~")t.push("<space>");else if(i==="\\bgroup")t.push("<{>");else if(i==="\\egroup")t.push("<}>");else if(i==="\\string")i=n.next(),i&&(i[0]==="\\"?Array.from(i).forEach(r=>t.push(r==="\\"?"\\backslash":r)):i==="<{>"?t.push("\\{"):i==="<space>"?t.push("~"):i==="<}>"&&t.push("\\}"));else if(i==="\\csname"){for(;n.peek()==="<space>";)n.next();let r="",o=!1,s=[];do{if(s.length===0)if(/^#[0-9?]$/.test(n.peek())){let a=n.get().slice(1);s=$(e?.[a]??e?.["?"]??"\\placeholder{}",e),i=s[0]}else i=n.next(),s=i?[i]:[];o=s.length===0,!o&&i==="\\endcsname"&&(o=!0,s.shift()),o||(o=i==="<$>"||i==="<$$>"||i==="<{>"||i==="<}>"||!!i&&i.length>1&&i[0]==="\\"),o||(r+=s.shift())}while(!o);r&&t.push("\\"+r),t=t.concat(s)}else if(i!=="\\endcsname")if(i.length>1&&i[0]==="#"){let r=i.slice(1);t=t.concat($(e?.[r]??e?.["?"]??"\\placeholder{}",e))}else t.push(i)}return t}function $(n,e){let i=n.toString().split(/\r?\n/),t="",r="";for(let a of i){t+=r,r=" ";let u=a.match(/((?:\\%)|[^%])*/);u!==null&&(t+=u[0])}let o=new eo(t),s=[];do s.push(...cf(o,e));while(!o.end());return s}function zt(n){return $(n,[]).length}function N(n){let e="",i="";for(let t of n)t&&(/[a-zA-Z*]/.test(t[0])&&(i+=e),/\\[a-zA-Z]+\*?$/.test(t)?e=" ":e="",i+=t);return i}function ln(n){let e=[];if(Array.isArray(n))for(let t of n)Array.isArray(t)?e=[...e,...t]:e.push(t);else e=[n];return N(e.map(t=>({"<space>":" ","<$$>":"$$","<$>":"$","<{>":"{","<}>":"}"})[t]??t))}var Ls=[{name:"To",latexTrigger:["\\to"],kind:"infix",precedence:270},{latexTrigger:["\\rightarrow"],kind:"infix",precedence:270,parse:"To"}];var Yn=["Error","'missing'"];function Fn(n){return!!(typeof n=="number"||Qn(n)||typeof n=="string"&&/^[+-]?[0-9\.]/.test(n))}function Qn(n){return n!==null&&typeof n=="object"&&"num"in n}function Wi(n){return n!==null&&typeof n=="object"&&"sym"in n}function zs(n){return n!==null&&typeof n=="object"&&"str"in n}function hi(n){return n!==null&&typeof n=="object"&&"fn"in n}var no;function Us(n){if(!no){let i=`^[${["Zyyy","Zinh","Arab","Armn","Beng","Bopo","Cyrl","Deva","Ethi","Geor","Grek","Gujr","Guru","Hang","Hani","Hebr","Hira","Kana","Knda","Khmr","Laoo","Latn","Mlym","Mymr","Orya","Sinh","Taml","Telu","Thaa","Thai","Tibt"].map(t=>`\\p{Script=${t}}`).join("")}]*$`;no=new RegExp(i,"u")}return no.test(n)}function Ee(n){return/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(n)||gi.test(n)?!0:Us(n)?/^[\p{XIDS}_]\p{XIDC}*$/u.test(n):!1}var mf="\\u{FE0F}",pf="\\u{20E3}",hf="\\u{200D}",gf="\\p{RI}\\p{RI}",xf="(?:[\\u{E0020}-\\u{E007E}]+\\u{E007F})",qs=`(?:\\p{EMod}|${mf}${pf}?|${xf})`,bf="(?:(?=\\P{XIDC})\\p{Emoji})",Vs=`(?:${bf}${qs}*|\\p{Emoji}${qs}+|${gf})`,Gs=`(?:${Vs})(${hf}${Vs})*`,yf=new RegExp(`(?:${Gs})+`,"u"),gi=new RegExp(`^(?:${Gs})+$`,"u");function en(n){return typeof n!="string"?"not-a-string":n===""?"empty-string":n.normalize()!==n?"expected-nfc":/[\u200E\u200F\u2066-\u2069\u202A-\u202E]/.test(n)?"unexpected-bidi-marker":gi.test(n)?"valid":/\p{XIDC}/u.test(n)&&yf.test(n)?"unexpected-mixed-emoji":Us(n)?Ee(n)?"valid":Ee(n[0])?"invalid-char":"invalid-first-char":"unexpected-script"}function z(n){return n==null?null:typeof n=="object"&&"str"in n?n.str:typeof n!="string"||n.length<2||n[0]!=="'"||n[n.length-1]!=="'"?null:n.substring(1,n.length-1)}function to(n){if(n==null||z(n)!==null)return null;let e=b(n);return e==null?n:[e,...(B(n)??[]).map(i=>to(i)).filter(i=>i!==null)]}function b(n){return Array.isArray(n)?typeof n[0]=="string"&&!Ee(n[0])?(console.error(`Invalid identifier "${n[0]}": ${en(n[0])}`),null):n[0]:n==null?null:hi(n)?n.fn[0]:null}function ro(n){let e=b(n);return typeof e=="string"?e:""}function B(n){return Array.isArray(n)?n.slice(1):n==null?null:hi(n)?n.fn.slice(1):null}function p(n,e){return Array.isArray(n)?n[e]??null:n==null?null:hi(n)?n.fn[e]??null:null}function Be(n){return p(n,1)}function Ke(n){return p(n,2)}function G(n){return n==null?0:Array.isArray(n)?Math.max(0,n.length-1):hi(n)?Math.max(0,n.fn.length-1):0}function oo(n){return n==null?null:b(n)==="Hold"?p(n,1):n}function V(n){if(typeof n=="string")return/^[+-]?[0-9\.]/.test(n)||n.length>=2&&n[0]==="'"&&n[n.length-1]==="'"?null:n;if(n==null)return null;let e=Wi(n)?n.sym:n;return typeof e!="string"?null:e}function $s(n){let e=b(n);if(e==="KeyValuePair"||e==="Tuple"||e==="Pair"){let i=z(Be(n));return i?[i,Ke(n)??"Nothing"]:null}return null}function Xn(n){if(n===null)return null;if(typeof n=="object"&&"dict"in n)return n.dict;let e=$s(n);if(e)return{[e[0]]:e[1]};if(b(n)==="Dictionary"){let t={};for(let r=1;r<G(n);r++){let o=$s(p(n,r));o&&(t[o[0]]=o[1])}return t}return null}function Ef(n){if(n=n.toLowerCase().replace(/[nd]$/,"").replace(/[\u0009-\u000d\u0020\u00a0]/g,""),n==="nan")return NaN;if(n==="infinity"||n==="+infinity")return 1/0;if(n==="-infinity")return-1/0;if(/\([0-9]+\)/.test(n)){let[e,i,t,r]=n.match(/(.+)\(([0-9]+)\)(.*)$/)??[];n=i+t.repeat(Math.ceil(16/t.length))+(r??"")}return parseFloat(n)}function M(n){return typeof n=="number"?n:typeof n=="string"?Ef(n):n==null?null:Qn(n)?M(n.num):null}function xi(n){if(n==null)return null;if(V(n)==="Half")return[1,2];let e=b(n);if(!e)return null;let i=null,t=null;if(e==="Negate"){let r=xi(Be(n));if(r)return[-r[0],r[1]]}if((e==="Rational"||e==="Divide")&&(i=M(Be(n))??NaN,t=M(Ke(n))??NaN),e==="Power"){let r=M(Ke(n));r===1?(i=M(Be(n)),t=1):r===-1&&(i=1,t=M(Be(n)))}return e==="Multiply"&&b(Ke(n))==="Power"&&M(Ke(Ke(n)))===-1&&(i=M(Be(n)),t=M(Be(Ke(n)))),i===null||t===null?null:Number.isInteger(i)&&Number.isInteger(t)?[i,t]:null}function Ji(n,e){let i=b(n);if(i!==null)return[Ji(i,e),...(B(n)??[]).map(o=>Ji(o,e))];let t=Xn(n);if(t!==null){let o=Object.keys(t),s={};for(let a of o)s[a]=Ji(t[a],e);return{dict:s}}let r=V(n);return r&&e[r]?e[r]:n}function Yi(n,e){let i=null;if(Array.isArray(n)&&(i=n),hi(n)&&(i=n.fn),i===null)return[];let t=1,r=[];for(;t<i.length;)r.push(e(i[t])),t+=1;return r}function bi(n,e,i,t="both"){if(t==="non")return[n,e,i];let r=b(e),o=b(i);return t==="left"?r===n?[n,...B(e)??[],i]:[n,e,i]:t==="right"?o===n?[n,e,...B(i)??[]]:[n,e,i]:r===n&&o===n?[n,...B(e)??[],...B(i)??[]]:r===n?[n,...B(e)??[],i]:o===n?[n,e,...B(i)??[]]:[n,e,i]}function Ut(n){if(n===null)return null;let e=b(n);if(e==="Delimiter"){if(n=p(n,1),n===null)return[];if(e=b(n),e!=="Sequence")return[n]}return e!=="Sequence"?null:B(n)??[]}function oe(n){return b(n)==="Sequence"&&G(n)===0}function H(n){return oe(n)?Yn:n??Yn}function io(n){return n[0]==="Square"?io(n.slice(1))+2:n.reduce((e,i)=>e+Qi(i),0)}function Qi(n){if(n===null)return 0;if(typeof n=="number"||typeof n=="string"||Fn(n)||Wi(n)||zs(n))return 1;if(Array.isArray(n))return io(n);if("fn"in n)return io(n.fn);let e=Xn(n);if(e){let i=Object.keys(e);return 1+i.length+i.reduce((t,r)=>t+Qi(e[r]),0)}return 0}function vf(n){if(b(n)!=="Multiply")return[[],[]];let e=[],i=[],t=B(n)??[];for(let r of t)if(b(r)==="Power"){let o=p(r,1),s=p(r,2);if(b(s)==="Negate"){let a=p(s,1);o&&a&&i.push(["Power",o,a])}else{let a=M(s)??NaN;a===-1?o&&i.push(o):a<0?o&&i.push(["Power",o,-a]):e.push(r)}}else if(b(r)==="Rational"&&G(r)===2){let o=p(r,1),s=p(r,2);M(o)!==1&&e.push(o),M(s)!==1&&i.push(s)}else{let o=xi(r);o!==null?(o[0]!==1&&e.push(o[0]),i.push(o[1])):e.push(r)}return[e,i]}function Nf(n){let e=n.parseOptionalGroup(),i=n.parseGroup()??n.parseToken();return i===null||oe(i)?e!==null?["Root",Yn,H(e)]:["Sqrt",Yn]:e!==null?["Root",i,e]:["Sqrt",i]}function Xi(n,e,i,t){return i===null?"\\sqrt{}":(t=t??2,e==="solidus"?n.wrapShort(i)+"^{1\\/"+n.serialize(t)+"}":e==="quotient"?n.wrapShort(i)+"^{\\frac{1}{"+n.serialize(t)+"}}":M(t)===2?"\\sqrt{"+n.serialize(i)+"}":"\\sqrt["+n.serialize(t)+"]{"+n.serialize(i)+"}")}function _f(n,e){n.level-=1;let i=b(e),t="",r=p(e,1);if(i==="Negate")t="-"+n.wrap(r,276);else if(i==="Add"){if(n.canonical&&G(e)===2&&n.options.invisiblePlus!=="+"){let[a,u]=[p(e,1),p(e,2)],[l,f]=[a,u],d=M(l),c=xi(f);if((d===null||c===null)&&([l,f]=[u,a],d=M(l),c=xi(f)),d!==null&&c!==null&&isFinite(d)&&Number.isInteger(d)&&d>=0&&d<=1e3&&isFinite(c[0])&&isFinite(c[1])&&c[0]>0&&c[0]<=100&&c[1]<=100)return t=N([n.serialize(l),n.options.invisiblePlus,n.serialize(f)]),n.level+=1,t}let o=M(r)??NaN;t=n.serialize(r);let s=G(e)+1;for(let a=2;a<s;a++)if(r=p(e,a),o=M(r)??NaN,o<0)t+=n.serialize(r);else if(b(r)==="Negate")t+=n.wrap(r,re);else{let u=n.wrap(r,re);u[0]==="-"||u[0]==="+"?t+=u:t+="+"+u}}else if(i==="Subtract"){t=n.wrap(r,re);let o=p(e,2);if(o!==null){let s=n.wrap(o,re);s[0]==="-"?t+="+"+s.slice(1):s[0]==="+"?t+="-"+s.slice(1):t=t+"-"+s}}return n.level+=1,t}function Ws(n,e){if(e===null)return"";n.level-=1;let i="";if(n.canonical===!0){let[a,u]=vf(e);u.length>0&&(u.length===1&&u[0]===1?a.length===0?i="1":a.length===1?i=n.serialize(a[0]):i=Ws(n,["Multiply",...a]):i=n.serialize(["Divide",a.length===1?a[0]:["Multiply",...a],u.length===1?u[0]:["Multiply",...u]]))}if(i)return n.level+=1,i;let t=!1,r=null,o=G(e)+1,s=!1;for(let a=1;a<o;a++){if(r=p(e,a),r===null)continue;let u;if(Fn(r)){u=n.serialize(r),u==="-1"&&!i?(i="",t=!t):(u[0]==="-"&&(u=u.slice(1),t=!t),i=i?N([i,n.options.multiply,u]):u),s=!0;continue}if(b(r)==="Power"){let l=xi(p(r,2));if(l){let[f,d]=l;if(f===1&&d!==null){i+=Xi(n,n.rootStyle(r,n.level),p(r,1),d),s=!1;continue}}}if(b(r)==="Power"&&!isNaN(M(p(r,1))??NaN)){u=n.serialize(r),i=i?N([i,n.options.multiply,u]):u,s=!0;continue}if(b(r)==="Negate"&&(r=p(r,1),t=!t),u=n.wrap(r,ze),!i)i=u;else{let l=b(r);s&&(l==="Divide"||l==="Rational")?i=N([i,n.options.multiply,u]):n.options.invisibleMultiply?i=N([i,n.options.invisibleMultiply,u]):i=N([i,u])}s=!1}return n.level+=1,t?"-"+i:i}function Sf(n){let e=n.parseGroup(),i=null;if(e===null?(e=n.parseToken(),i=n.parseToken()):i=n.parseGroup(),e=H(e),i=H(i),b(e)==="PartialDerivative"&&(b(i)==="PartialDerivative"||b(i)==="Multiply"&&b(p(i,1))==="PartialDerivative")){let t=p(e,3)??null,r=p(e,1);r===null&&(r=H(n.parseExpression()));let o=[];if(b(i)==="Multiply"){for(let s of B(i)??[])if(b(s)==="PartialDerivative"){let a=p(s,2);a&&o.push(a)}}else{let s=p(i,2);s&&o.push(s)}return o.length>1&&(o=["List",...o]),["PartialDerivative",r,...o,t===null?1:t]}return["Divide",e,i]}function js(n,e){if(e===null)return"";let i=H(p(e,1)),t=H(p(e,2)),r=n.canonical?n.fractionStyle(e,n.level):"quotient";if(r==="inline-solidus"||r==="nice-solidus"){let u=n.wrapShort(i),l=n.wrapShort(t);return r==="inline-solidus"?`${u}\\/${l}`:`{}^{${u}}\\!\\!/\\!{}_{${l}}`}else{if(r==="reciprocal")return M(i)===1?n.wrap(t)+"^{-1}":n.wrap(i)+n.wrap(t)+"^{-1}";if(r==="factor")return M(t)===1?n.wrap(i):"\\frac{1}{"+n.serialize(t)+"}"+n.wrapString(n.serialize(i),n.groupStyle(e,1))}let o="\\frac";r==="block-quotient"?o="\\dfrac":r==="inline-quotient"&&(o="\\tfrac");let s=n.serialize(i),a=n.serialize(t);return`${o}{${s}}{${a}}`}function so(n,e){if(!e)return"";let i=b(e),t=H(p(e,1));if(i==="Sqrt")return Xi(n,n.rootStyle(e,n.level-1),t,2);let r=H(p(e,2));if(i==="Root")return Xi(n,n.rootStyle(e,n.level-1),t,r);if(n.canonical){let o=M(r)??1;if(o===-1)return n.serialize(["Divide","1",t]);if(o<0)return n.serialize(["Divide","1",["Power",t,-o]]);if(b(r)==="Divide"||b(r)==="Rational"){if(M(p(r,1))===1){let s=n.rootStyle(e,n.level);return Xi(n,s,t,p(r,2))}if(M(p(r,2))===2)return`${n.serialize(["Sqrt",t])}^{${n.serialize(p(r,1))}}`}else if(b(r)==="Power"&&M(p(r,2))===-1){let s=n.rootStyle(e,n.level);return Xi(n,s,t,p(r,1))}}return n.wrapShort(t)+"^{"+n.serialize(r)+"}"}var Ys=[{name:"CatalanConstant",identifierTrigger:"G"},{name:"GoldenRatio",latexTrigger:"\\varphi"},{name:"EulerGamma",latexTrigger:"\\gamma"},{name:"Degrees",latexTrigger:["\\degree"],kind:"postfix",precedence:880,parse:(n,e)=>["Degrees",e],serialize:(n,e)=>N([n.serialize(p(e,1)),"\\degree"])},{latexTrigger:["\\degree"],kind:"postfix",precedence:880,parse:(n,e)=>["Degrees",e]},{latexTrigger:["^","<{>","\\circ","<}>"],kind:"postfix",parse:(n,e)=>["Degrees",e]},{latexTrigger:["^","\\circ"],kind:"postfix",parse:(n,e)=>["Degrees",e]},{latexTrigger:["\xB0"],kind:"postfix",precedence:880,parse:(n,e)=>["Degrees",e]},{latexTrigger:["\\ang"],parse:n=>{let e=n.parseGroup();return e===null?["Degrees"]:["Degrees",e]}},{latexTrigger:["\\infty"],parse:{num:"+Infinity"}},{name:"ComplexInfinity",latexTrigger:["\\tilde","\\infty"],serialize:"\\tilde\\infty"},{latexTrigger:["\\tilde","<{>","\\infty","<}>"],parse:"ComplexInfinity"},{name:"Pi",kind:"symbol",latexTrigger:["\\pi"]},{latexTrigger:["\u03C0"],parse:"Pi"},{name:"ExponentialE",latexTrigger:["\\exponentialE"],parse:"ExponentialE",serialize:"\\exponentialE"},{latexTrigger:"\\operatorname{e}",parse:"ExponentialE"},{latexTrigger:"\\mathrm{e}",parse:"ExponentialE"},{kind:"function",identifierTrigger:"exp",parse:"Exp"},{latexTrigger:"\\exp",parse:"Exp"},{name:"ImaginaryUnit",latexTrigger:["\\imaginaryI"]},{latexTrigger:"\\operatorname{i}",parse:"ImaginaryUnit"},{latexTrigger:"\\mathrm{i}",parse:"ImaginaryUnit"},{name:"Abs",kind:"matchfix",openTrigger:"|",closeTrigger:"|",parse:(n,e)=>oe(e)?null:["Abs",e]},{kind:"matchfix",openTrigger:"\\vert",closeTrigger:"\\vert",parse:(n,e)=>oe(e)?null:["Abs",e]},{identifierTrigger:"abs",kind:"function",parse:"Abs"},{name:"Add",latexTrigger:["+"],kind:"infix",associativity:"both",precedence:re,parse:(n,e,i)=>{if(i&&re<i.minPrec)return null;let t=n.parseExpression({...i,minPrec:re});return t===null?null:bi("Add",e,t)},serialize:_f},{kind:"prefix",latexTrigger:["+"],precedence:re,parse:(n,e)=>e&&re<e.minPrec?null:n.parseExpression({...e,minPrec:400})},{name:"Ceil",kind:"matchfix",openTrigger:"\\lceil",closeTrigger:"\\rceil",parse:(n,e)=>oe(e)?null:["Ceil",e]},{kind:"matchfix",openTrigger:["\u2308"],closeTrigger:["\u2309"],parse:(n,e)=>oe(e)?null:["Ceil",e]},{identifierTrigger:"ceil",kind:"function",parse:"Ceil"},{name:"Chop",identifierTrigger:"chop",kind:"function",parse:"Chop"},{name:"Complex",precedence:re-1,serialize:(n,e)=>{let i=n.serialize(p(e,1)),t=M(p(e,2));if(t===0)return i;let r=t===1?"\\imaginaryI":t===-1?"-\\imaginaryI":N([n.serialize(p(e,2)),"\\imaginaryI"]);return M(p(e,1))===0?r:t!==null&&t<0?N([i,r]):N([i,"+",r])}},{name:"Divide",latexTrigger:"\\frac",precedence:an,parse:Sf,serialize:js},{kind:"infix",latexTrigger:"\\over",precedence:an,parse:"Divide"},{latexTrigger:["\\/"],kind:"infix",associativity:"non",precedence:an,parse:"Divide"},{latexTrigger:["/"],kind:"infix",associativity:"non",precedence:an,parse:"Divide"},{latexTrigger:["\\div"],kind:"infix",associativity:"non",precedence:an,parse:"Divide"},{name:"Exp",serialize:(n,e)=>{let i=p(e,1);return V(i)||M(i)!==null?N(["\\exponentialE^{",n.serialize(i),"}"]):N(["\\exp",n.wrap(H(i))])}},{name:"Factorial",latexTrigger:["!"],kind:"postfix",precedence:Ct},{name:"Factorial2",latexTrigger:["!","!"],kind:"postfix",precedence:Ct},{name:"Floor",kind:"matchfix",openTrigger:"\\lfloor",closeTrigger:"\\rfloor",parse:(n,e)=>oe(e)?null:["Floor",e]},{kind:"matchfix",openTrigger:["\u230A"],closeTrigger:["\u230B"],parse:(n,e)=>oe(e)?null:["Floor",e]},{identifierTrigger:"floor",kind:"function",parse:"Floor"},{latexTrigger:["\\Gamma"],parse:"Gamma"},{name:"GCD",identifierTrigger:"gcd",kind:"function"},{identifierTrigger:"GCD",kind:"function",parse:"GCD"},{name:"Half",serialize:"\\frac12"},{name:"Lg",latexTrigger:["\\lg"],serialize:(n,e)=>"\\log_{10}"+n.wrapArguments(e),parse:n=>{let e=n.parseArguments("implicit");return e===null?"Lg":["Log",...e,10]}},{name:"Lb",latexTrigger:"\\lb",parse:n=>{let e=n.parseArguments("implicit");return e===null?"Log":["Log",...e,2]}},{name:"Ln",latexTrigger:["\\ln"],serialize:(n,e)=>"\\ln"+n.wrapArguments(e),parse:n=>Js("Ln",n)},{name:"Log",latexTrigger:["\\log"],parse:n=>Js("Log",n),serialize:(n,e)=>{let i=Ke(e);return i?N(["\\log_{",i.toString(),"}",n.wrap(Be(e))]):"\\log"+n.wrapArguments(e)}},{name:"LCM",identifierTrigger:"lcm",kind:"function"},{identifierTrigger:"LCM",kind:"function",parse:"LCM"},{identifierTrigger:"max",kind:"function",parse:"Max"},{identifierTrigger:"min",kind:"function",parse:"Min"},{name:"Max",latexTrigger:"\\max",kind:"function"},{name:"Min",latexTrigger:"\\min",kind:"function"},{name:"Supremum",latexTrigger:"\\sup",kind:"function"},{name:"Infimum",latexTrigger:"\\inf",kind:"function"},{name:"Limit",latexTrigger:"\\lim",kind:"expression",parse:n=>{if(!n.match("_"))return;let e=n.parseGroup();if(b(e)!=="To")return;let i=n.parseArguments("implicit");if(i)return["Limit",["Function",i[0],p(e,1)],p(e,2)]},serialize:(n,e)=>{let i=p(e,1),t=p(i,2),r=p(e,2);return N(["\\lim_{",n.serialize(t),"\\to",n.serialize(r),"}",n.serialize(p(i,1))])}},{name:"MinusPlus",latexTrigger:["\\mp"],kind:"infix",associativity:"both",precedence:sn},{name:"Multiply",latexTrigger:["\\times"],kind:"infix",associativity:"both",precedence:ze,serialize:Ws},{latexTrigger:["\\cdot"],kind:"infix",associativity:"both",precedence:ze,parse:(n,e,i)=>{let t=n.parseExpression({...i,minPrec:ze+2});return t===null?["Multiply",e,Yn]:bi("Multiply",e,t)}},{latexTrigger:["*"],kind:"infix",associativity:"both",precedence:ze,parse:(n,e,i)=>{let t=n.parseExpression({...i,minPrec:ze+2});return t===null?["Multiply",e,Yn]:bi("Multiply",e,t)}},{name:"Mod",latexTrigger:"\\bmod",kind:"infix",precedence:an,serialize:(n,e)=>{if(G(e)!==2)return"";let i=n.serialize(p(e,1)),t=n.serialize(p(e,2));return N([i,"\\bmod",t])}},{latexTrigger:"\\mod",kind:"infix",precedence:an,parse:"Mod"},{latexTrigger:"\\pmod",kind:"prefix",precedence:A,parse:n=>{let e=n.parseGroup()??n.parseToken();return["Mod",H(e)]}},{name:"Congruent",serialize:(n,e)=>{let i=n.serialize(p(e,1)),t=n.serialize(p(e,2));if(p(e,3)===null)return N([i,"\\equiv",t]);let r=n.serialize(p(e,3));return N([i,"\\equiv",t,"\\pmod{",r,"}"])}},{name:"Negate",latexTrigger:["-"],kind:"prefix",precedence:re+2,parse:(n,e)=>{if(/\d/.test(n.peek))return null;let i=n.index;if(n.parseNumber()!==null)return n.index=i,null;let t=n.parseExpression({...e,minPrec:re+3});return["Negate",H(t)]}},{kind:"matchfix",openTrigger:"||",closeTrigger:"||",parse:(n,e)=>oe(e)?null:["Norm",e]},{name:"Norm",kind:"matchfix",openTrigger:["\\left","\\Vert"],closeTrigger:["\\right","\\Vert"],parse:(n,e)=>oe(e)?null:["Norm",e]},{name:"PlusMinus",latexTrigger:["\\pm"],kind:"infix",associativity:"both",precedence:sn,serialize:(n,e)=>{let i=p(e,1);if(i===null)return"\\pm";if(G(e)===1)return N(["\\pm",n.serialize(i)]);let t=p(e,2);return N([n.serialize(i),"\\pm",n.serialize(t)])}},{latexTrigger:["\\pm"],kind:"prefix",precedence:sn,parse:(n,e)=>{let i=n.parseExpression({...e,minPrec:400});return["PlusMinus",H(i)]}},{latexTrigger:["\\plusmn"],kind:"infix",associativity:"both",precedence:sn,parse:(n,e,i)=>{let t=n.parseExpression({...i,minPrec:400});return["PlusMinus",e,H(t)]}},{latexTrigger:["\\plusmn"],kind:"prefix",precedence:sn,parse:(n,e)=>{let i=n.parseExpression({...e,minPrec:400});return["PlusMinus",H(i)]}},{name:"Power",latexTrigger:["^"],kind:"infix",serialize:so},{latexTrigger:"\\prod",precedence:ze,name:"Product",parse:Zs("Product",ze),serialize:Hs("\\prod")},{name:"Rational",precedence:an,serialize:(n,e)=>e&&G(e)===1?"\\operatorname{Rational}"+n.wrapArguments(e):js(n,e)},{name:"Root",serialize:so},{name:"Round",identifierTrigger:"round",kind:"function"},{name:"Square",precedence:720,serialize:(n,e)=>n.wrapShort(p(e,1))+"^2"},{latexTrigger:["\\sum"],precedence:re,name:"Sum",parse:Zs("Sum",re),serialize:Hs("\\sum")},{name:"Sign",identifierTrigger:"sgn",kind:"function"},{name:"Sqrt",latexTrigger:["\\sqrt"],parse:Nf,serialize:so},{name:"Subtract",latexTrigger:["-"],kind:"infix",associativity:"both",precedence:re+2,parse:(n,e,i)=>{let t=n.parseExpression({...i,minPrec:re+3});return["Subtract",e,H(t)]},serialize:(n,e)=>{let i=n.wrap(p(e,1),re+2),t=n.wrap(p(e,2),re+3);return N([i,"-",t])}}];function Zs(n,e){return i=>{i.skipSpace();let t=null,r=null;for(;!(r&&t)&&(i.peek==="_"||i.peek==="^");)i.match("_")?r=i.parseGroup()??i.parseToken():i.match("^")&&(t=i.parseGroup()??i.parseToken()),i.skipSpace();(r==="Nothing"||oe(r))&&(r=null),(t==="Nothing"||oe(t))&&(t=null);let o=null,s=null;b(r)==="Equal"?(o=p(r,1),s=p(r,2)):o=r;let a=i.parseExpression({minPrec:e+1});return a?t?[n,a,["Tuple",o??"Nothing",s??1,t]]:s?[n,a,["Tuple",o??"Nothing",s]]:o?[n,a,["Tuple",o]]:[n,a]:[n]}}function Hs(n){return(e,i)=>{if(!p(i,1))return n;let t=p(i,2),r=b(t);r!=="Tuple"&&r!=="Triple"&&r!=="Pair"&&r!=="Single"&&(t=null);let o=p(t,1);o&&b(o)==="Hold"&&(o=p(o,1));let s=p(i,1);if(!t)return p(i,2)?N([n,"_{",e.serialize(p(i,2)),"}",e.serialize(s)]):N([n,e.serialize(s)]);let a=p(t,2),u=[];o&&V(o)!=="Nothing"&&a?u=[e.serialize(o),"=",e.serialize(a)]:o&&V(o)!=="Nothing"?u=[e.serialize(o)]:a&&(u=[e.serialize(a)]),u.length>0&&(u=["_{",...u,"}"]);let l=[];return p(t,3)&&(l=["^{",e.serialize(p(t,3)),"}"]),N([n,...l,...u,e.serialize(s)])}}function Js(n,e){let i=null,t=null;e.match("_")&&(i=e.parseStringGroup()?.trim()??e.nextToken(),t=Number.parseFloat(i??"10"));let r=e.parseArguments("implicit");return r===null?n:t===10?["Log",r[0]]:t===2?["Lb",...r]:i===null?[n,...r]:["Log",...r,i]}function ao(n,e,i,t,r){if(e.minPrec>=t)return null;let o=i?[i]:["Nothing"],s=!1;for(;!s;){for(s=!0,n.skipSpace();n.match(r);)o.push("Nothing"),n.skipSpace();if(n.atTerminator(e))o.push("Nothing");else{let a=n.parseExpression({...e,minPrec:t});o.push(a??"Nothing"),s=a===null}s||(n.skipSpace(),s=!n.match(r))}return o}function Gt(n=""){return(e,i)=>{if(!i)return"";let t=B(i)??[];if(t.length===0)return"";if(t.length===1)return e.serialize(t[0]);n={"&":"\\&",":":"\\colon","|":"\\mvert","-":"-","\xB7":"\\cdot","\u2012":"-","\u2013":"--","\u2014":"---","\u2015":"-","\u2022":"\\bullet","\u2026":"\\ldots"}[n]??n;let r=t.reduce((o,s)=>(o.push(e.serialize(s),n),o),[]);return r.pop(),N(r)}}var Qs=[{latexTrigger:["\\placeholder"],kind:"symbol",parse:n=>{for(;n.match("<space>"););if(n.match("["))for(;!n.match("]")&&!n.atBoundary;)n.nextToken();for(;n.match("<space>"););if(n.match("<{>"))for(;!n.match("<}>")&&!n.atBoundary;)n.nextToken();return"Nothing"}},{name:"Function",latexTrigger:["\\mapsto"],kind:"infix",precedence:sn,parse:(n,e)=>{let i=[];if(b(e)==="Delimiter"&&(e=p(e,1)??"Nothing"),b(e)==="Sequence")for(let r of B(e)??[]){if(!V(r))return null;i.push(V(r))}else{if(!V(e))return null;i=[V(e)]}let t=n.parseExpression({minPrec:sn})??"Nothing";return b(t)==="Delimiter"&&(t=p(t,1)??"Nothing"),b(t)==="Sequence"&&(t=["Block",...B(t)??[]]),["Function",t,...i]},serialize:(n,e)=>{let i=B(e);return i===null||i.length<1?"()\\mapsto()":i.length===1?N(["()","\\mapsto",n.serialize(p(e,1))]):i.length===2?N([n.serialize(p(e,2)),"\\mapsto",n.serialize(p(e,1))]):N([n.wrapString((B(e)?.slice(1)??[]).map(t=>n.serialize(t)).join(", "),"normal"),"\\mapsto",n.serialize(p(e,1))])}},{name:"Apply",kind:"function",identifierTrigger:"apply",serialize:(n,e)=>{if(typeof p(e,1)=="string"){let t=e.slice(1);return n.serialize(t)}return n.serializeFunction(B(e))}},{latexTrigger:"\\lhd",kind:"infix",precedence:20,parse:"Apply"},{latexTrigger:"\\rhd",kind:"infix",precedence:20,parse:(n,e)=>["Apply",n.parseExpression({minPrec:21})??"Nothing",e]},{name:"Assign",latexTrigger:"\\coloneq",kind:"infix",associativity:"right",precedence:di,serialize:(n,e)=>{let i=oo(p(e,1));if(b(p(e,2))==="Function"){let t=p(e,2),r=oo(p(t,1)),o=B(t)?.slice(1)??[];return N([n.serialize(i),n.wrapString(o.map(s=>n.serialize(s)).join(", "),n.options.applyFunctionStyle(e,n.level)),"\\coloneq",n.serialize(r)])}return N([n.serialize(i),"\\coloneq",n.serialize(p(e,2))])},parse:jt},{latexTrigger:"\\coloneqq",kind:"infix",associativity:"right",precedence:di,parse:jt},{latexTrigger:"\\colonequals",kind:"infix",associativity:"right",precedence:di,parse:jt},{latexTrigger:[":","="],kind:"infix",associativity:"right",precedence:di,parse:jt},{name:"BaseForm",serialize:(n,e)=>{let i=M(p(e,2))??NaN;if(isFinite(i)&&i>=2&&i<=36){let t=M(p(e,1))??NaN;if(isFinite(t)&&Number.isInteger(t)){let r=Number(t).toString(i),o=0;if(i===2||i===10?o=4:i===16?o=2:i>16&&(o=4),o>0){let s=r;r="";for(let a=0;a<s.length;a++)a>0&&a%o===0&&(r="\\, "+r),r=s[s.length-a-1]+r}return`(\\text{${r}}_{${i}}`}}return"\\operatorname{BaseForm}("+n.serialize(p(e,1))+", "+n.serialize(p(e,2))+")"}},{name:"Sequence",serialize:Gt(" ")},{name:"InvisibleOperator",serialize:Gt("")},{name:"Delimiter",serialize:(n,e)=>{let i=n.options.groupStyle(e,n.level+1),t=p(e,1),r=b(t),o={Set:"{,}",List:"[,]",Tuple:"(,)",Single:"(,)",Pair:"(,)",Triple:"(,)",Sequence:"(,)",String:'""'}[typeof r=="string"?r:""],s=o?t:["Sequence",t];if(o??(o="(,)"),G(e)>1){let d=z(p(e,2));typeof d=="string"&&d.length<=3&&(o=d)}let[a,u,l]=["","",""];o.length===3?[a,u,l]=o:o.length===2?[a,l]=o:o.length===1&&(u=o);let f=t?s?Gt(u)(n,s):n.serialize(t):"";return n.wrapString(f,i,a+l)}},{name:"Domain",serialize:(n,e)=>b(e)==="Error"?n.serialize(e):`\\mathbf{${n.serialize(p(e,1))}}`},{latexTrigger:["\\mathtip"],parse:n=>{let e=n.parseGroup();return n.parseGroup(),e}},{latexTrigger:["\\texttip"],parse:n=>{let e=n.parseGroup();return n.parseGroup(),e}},{latexTrigger:["\\error"],parse:n=>["Error",n.parseGroup()]},{name:"Error",serialize:(n,e)=>{let i=p(e,1);if(z(i)==="missing")return`\\error{${n.options.missingSymbol??"\\placeholder{}"}}`;let t=Df(n,e)||"\\blacksquare",r=b(i)==="ErrorCode"?z(p(i,1)):z(i);return r==="incompatible-domain"?V(p(i,3))==="Undefined"?`\\mathtip{\\error{${t}}}{\\notin ${n.serialize(p(i,2))}}`:`\\mathtip{\\error{${t}}}{\\in ${n.serialize(p(i,3))}\\notin ${n.serialize(p(i,2))}}`:typeof r=="string"?`\\error{${t}}`:`\\error{${t}}`}},{name:"ErrorCode",serialize:(n,e)=>{let i=z(p(e,1));return i==="missing"?n.options.missingSymbol??"\\placeholder{}":i==="unexpected-command"||i==="unexpected-operator"||i==="unexpected-token"||i==="invalid-identifier"||i==="unknown-environment"||i==="unexpected-base"||i==="incompatible-domain"||i==="invalid-domain"?"":`\\texttip{\\error{\\blacksquare}}{\\mathtt{${i}}}`}},{name:"FromLatex",serialize:(n,e)=>`\\texttt{${Bf(z(p(e,1)))}}`},{name:"Latex",serialize:(n,e)=>e===null?"":N(Yi(e,i=>z(i)??n.serialize(i)))},{name:"LatexString",serialize:(n,e)=>e===null?"":N(Yi(e,i=>n.serialize(i)))},{name:"LatexTokens",serialize:Tf},{name:"List",kind:"matchfix",openTrigger:"[",closeTrigger:"]",parse:Xs,serialize:(n,e)=>N(["\\bigl\\lbrack",Gt(", ")(n,e),"\\bigr\\rbrack"])},{kind:"matchfix",openTrigger:"(",closeTrigger:")",parse:If},{latexTrigger:[","],kind:"infix",precedence:20,parse:(n,e,i)=>{let t=ao(n,i,e,20,",");return t===null?null:["Delimiter",["Sequence",...t],{str:","}]}},{latexTrigger:[","],kind:"prefix",precedence:20,parse:(n,e)=>{let i=ao(n,e,null,20,",");return i===null?null:["Delimiter",["Sequence",...i],{str:","}]}},{name:"Range",latexTrigger:[".","."],kind:"infix",precedence:10,parse:kf,serialize:(n,e)=>{let i=B(e);if(i===null)return"";if(i.length===1)return"1.."+n.serialize(p(e,1));if(i.length===2)return n.wrap(p(e,1),10)+".."+n.wrap(p(e,2),10);if(i.length===3){let t=M(p(e,3)),r=M(p(e,1));return t!==null&&r!==null?n.wrap(p(e,1),10)+","+n.wrap(r+t,10)+".."+n.wrap(p(e,2),10):n.wrap(p(e,1),10)+","+(n.wrap(p(e,3),re)+"+"+n.wrap(p(e,3),re))+".."+n.wrap(p(e,2),10)}return""}},{latexTrigger:[";"],kind:"infix",precedence:19,parse:(n,e,i)=>{let t=ao(n,i,e,19,";");return t===null?null:["Delimiter",["Sequence",...t],"';'"]}},{name:"String",latexTrigger:["\\text"],parse:n=>lo(n),serialize:(n,e)=>{let i=B(e);return i===null||i.length===0?"\\text{}":N(["\\text{",i.map(t=>n.serialize(t)).join(""),"}"])}},{name:"Subscript",latexTrigger:["_"],kind:"infix",serialize:(n,e)=>G(e)===2?n.serialize(p(e,1))+"_{"+n.serialize(p(e,2))+"}":"_{"+n.serialize(p(e,1))+"}"},{name:"Superplus",latexTrigger:["^","+"],kind:"postfix"},{name:"Subplus",latexTrigger:["_","+"],kind:"postfix"},{name:"Superminus",latexTrigger:["^","-"],kind:"postfix"},{name:"Subminus",latexTrigger:["_","-"],kind:"postfix"},{latexTrigger:["^","*"],kind:"postfix",parse:(n,e)=>["Superstar",e]},{latexTrigger:["_","*"],kind:"postfix",parse:(n,e)=>["Substar",e]},{name:"Substar",latexTrigger:["_","\\star"],kind:"postfix"},{name:"Superdagger",latexTrigger:["^","\\dagger"],kind:"postfix"},{latexTrigger:["^","\\dag"],kind:"postfix",parse:(n,e)=>["Superdagger",e]},{name:"Prime",latexTrigger:["^","\\prime"],kind:"postfix",parse:(n,e)=>vn(n,e,1),serialize:(n,e)=>{let i=M(p(e,2))??1,t=n.serialize(p(e,1));return i===1?t+"^\\prime":i===2?t+"^\\doubleprime":i===3?t+"^\\tripleprime":t+"^{("+n.serialize(p(e,2))+")}"}},{latexTrigger:"^{\\prime\\prime}",kind:"postfix",parse:(n,e)=>vn(n,e,2)},{latexTrigger:"^{\\prime\\prime\\prime}",kind:"postfix",parse:(n,e)=>vn(n,e,3)},{latexTrigger:["^","\\doubleprime"],kind:"postfix",parse:(n,e)=>vn(n,e,2)},{latexTrigger:["^","\\tripleprime"],kind:"postfix",parse:(n,e)=>vn(n,e,3)},{latexTrigger:"'",kind:"postfix",precedence:810,parse:(n,e)=>vn(n,e,1)},{latexTrigger:"\\prime",kind:"postfix",precedence:810,parse:(n,e)=>vn(n,e,1)},{latexTrigger:"\\doubleprime",kind:"postfix",precedence:810,parse:(n,e)=>vn(n,e,2)},{latexTrigger:"\\tripleprime",kind:"postfix",precedence:810,parse:(n,e)=>vn(n,e,3)},{latexTrigger:["^","<{>","("],kind:"postfix",parse:(n,e)=>{if(!n.computeEngine?.box(e)?.domain?.isFunction)return null;let i=n.index;n.addBoundary([")"]);let t=n.parseExpression();return!n.matchBoundary()||!n.match("<}>")?(n.index=i,null):["Derivative",e,t]}},{name:"InverseFunction",latexTrigger:"^{-1",kind:"postfix",parse:(n,e)=>{if(!n.computeEngine?.box(e)?.domain?.isFunction)return null;let i=0,t=n.index;for(;!n.atEnd&&!n.match("<}>");)if(n.match("'"))i++;else if(n.match("\\prime"))i++;else if(n.match("\\doubleprime"))i+=2;else if(n.match("\\tripleprime"))i+=3;else return n.index=t,null;return i===1?["Derivative",["InverseFunction",e]]:i>0?["Derivative",["InverseFunction",e],i]:["InverseFunction",e]},serialize:(n,e)=>n.serialize(p(e,1))+"^{-1}"},{name:"Derivative",serialize:(n,e)=>{let i=M(p(e,2))??1,t=n.serialize(p(e,1));return i===1?t+"^{\\prime}":i===2?t+"^{\\doubleprime}":i===3?t+"^{\\tripleprime}":t+"^{("+n.serialize(p(e,2))+")}"}},{kind:"environment",name:"Which",identifierTrigger:"cases",parse:uo,serialize:(n,e)=>{let i=[],t=B(e);if(t)for(let r=0;r<=t.length-2;r+=2){let o=[];o.push(n.serialize(t[r+1])),o.push(n.serialize(t[r])),i.push(o.join("&"))}return N(["\\begin{cases}",i.join("\\\\"),"\\end{cases}"])}},{kind:"environment",identifierTrigger:"dcases",parse:uo},{kind:"environment",identifierTrigger:"rcases",parse:uo}];function lo(n,e){if(!n.match("<{>"))return"''";let i=[],t="",r=null;for(;!n.atEnd&&!n.match("<}>");)if(n.peek==="<{>")i.push(lo(n));else if(n.match("\\textbf")&&n.match("<{>"))i.push(lo(n,{"font-weight":"bold"}));else if(n.match("\\color")){let s=n.parseStringGroup();s!==null&&(r!==null&&t?i.push(["Style",t,{dict:r}]):t&&i.push(["String",t]),t="",r={color:s})}else if(n.match("<space>"))t+=" ";else if(n.match("<$>")){let s=n.index,a=n.parseExpression()??["Sequence"];n.skipSpace(),n.match("<$>")?i.push(a):(t+="$",n.index=s)}else if(n.match("<$$>")){let s=n.index,a=n.parseExpression()??["Sequence"];n.skipSpace(),n.match("<$$>")?i.push(a):(t+="$$",n.index=s)}else{let s=n.matchChar()??n.nextToken();t+={"\\enskip":"\u2002","\\enspace":"\u2002","\\quad":"\u2003","\\qquad":"\u2003\u2003","\\space":"\u2003","\\ ":"\u2003","\\;":"\u2004","\\,":"\u2009","\\:":"\u205F","\\!":"","\\{":"{","\\}":"}","\\$":"$","\\&":"&","\\#":"#","\\%":"%","\\_":"_","\\textbackslash":"\\","\\textasciitilde":"~","\\textasciicircum":"^","\\textless":"<","\\textgreater":">","\\textbar":"|","\\textunderscore":"_","\\textbraceleft":"{","\\textbraceright":"}","\\textasciigrave":"`","\\textquotesingle":"'","\\textquotedblleft":"\u201C","\\textquotedblright":"\u201D","\\textquotedbl":'"',"\\textquoteleft":"\u2018","\\textquoteright":"\u2019","\\textbullet":"\u2022","\\textdagger":"\u2020","\\textdaggerdbl":"\u2021","\\textsection":"\xA7","\\textparagraph":"\xB6","\\textperiodcentered":"\xB7","\\textellipsis":"\u2026","\\textemdash":"\u2014","\\textendash":"\u2013","\\textregistered":"\xAE","\\texttrademark":"\u2122","\\textdegree":"\xB0"}[s]??s}r!==null&&t?i.push(["Style",`'${t}'`,{dict:r}]):t&&i.push(`'${t}'`);let o;return i.length===1?o=i[0]:i.every(s=>z(s)!==null)?o="'"+i.map(s=>z(s)).join()+"'":o=["String",...i],e?["Style",o,{dict:e}]:o}function Tf(n,e){return e===null?"":N(Yi(e,i=>{let t=z(i);return t===null?n.serialize(i):t==="<{>"?"{":t==="<}>"?"}":t==="<$>"?"$":t==="<$$>"?"$$":t==="<space>"?" ":t}))}function Bf(n){return n===null?"":n.replace(/[{}\[\]\\:\-\$%]/g,e=>({"{":"\\lbrace ","}":"\\rbrace ","[":"\\lbrack ","]":"\\rbrack ",":":"\\colon ","\\":"\\backslash "})[e]??"\\"+e)}function Df(n,e){let i=p(e,2);return i?b(i)==="LatexString"?z(p(i,1))??"":b(i)==="Hold"?n.serialize(p(i,1)):n.serialize(i):""}function vn(n,e,i){let t=b(e);if(t==="Derivative"||t==="Prime"){let r=M(p(e,2))??1;return[t,H(p(e,1)),r+i]}return n.computeEngine?.box(e)?.domain?.isFunction?i===1?["Derivative",e]:["Derivative",e,i]:i===1?["Prime",H(e)]:["Prime",H(e),i]}function If(n,e){if(e===null||oe(e))return["Delimiter"];let i=b(e);if(i==="Delimiter"&&p(e,2)){let t=z(p(e,2));if(t?.length===1)return["Delimiter",p(e,1)??["Sequence"],{str:`(${t})`}]}return i==="Sequence"?G(e)===0?["Delimiter"]:G(e)===1?["Delimiter",p(e,1)]:["Delimiter",e]:i==="Matrix"&&(z(p(e,2))??"..")===".."?["Matrix",p(e,1)]:["Delimiter",e]}function Xs(n,e){if(e===null||oe(e))return["List"];let i=b(e);if(i==="Range"||i==="Linspace")return e;if(i==="Sequence")return["List",...B(e)??[]];if(i==="Delimiter"){let t=z(p(e,2))??"...";if(t===";"||t===".;.")return["List",...(B(p(e,1))??[]).map(r=>Xs(n,r))];if(t===","||t===".,.")return e=p(e,1),b(e)==="Sequence"?["List",...B(e)??[]]:["List",e??["Sequence"]]}return["List",e]}function kf(n,e){let i=n.index;if(!e)return null;let t=null,r=null;if(b(e)==="Sequence"){if(G(e)!==2)return null;if(t=p(e,1),r=p(e,2),r===null)return n.index=i,null}else t=p(e,1);if(t===null)return null;let o=n.parseExpression({minPrec:0});if(!o)return n.index=i,null;if(r){let s=M(r),a=M(t);return s!==null&&a!==null?["Range",t,o,s-a]:["Range",t,o,["Subtract",r,t]]}return["Range",t,o]}var yi={"(":"(",")":")","[":"\\lbrack","]":"\\rbrack","\u27E6":"\\llbrack","\u27E7":"\\rrbrack","{":"\\lbrace","}":"\\rbrace","<":"\\langle",">":"\\rangle","\u2016":"\\Vert","\\":"\\backslash","\u2308":"\\lceil","\u2309":"\\rceil","\u230A":"\\lfloor","\u230B":"\\rfloor","\u231C":"\\ulcorner","\u231D":"\\urcorner","\u231E":"\\llcorner","\u231F":"\\lrcorner","\u23B0":"\\lmoustache","\u23B1":"\\rmoustache"};function jt(n,e){let i=n.index;if(b(e)==="InvisibleOperator"&&G(e)===2&&b(p(e,2))==="Delimiter"){let r=V(p(e,1));if(!r)return null;let o=n.parseExpression({minPrec:0});if(o===null)return n.index=i,null;let s=p(p(e,2),1),a=[];return b(s)==="Sequence"?a=B(s)??[]:s&&(a=[s]),["Assign",r,["Function",o,...a??[]]]}if(typeof b(e)=="string"){let r=b(e),o=B(e)??[],s=n.parseExpression({minPrec:0});return s===null?(n.index=i,null):["Assign",r,["Function",s,...o]]}if(!V(e))return null;let t=n.parseExpression({minPrec:0});return t===null?(n.index=i,null):["Assign",e,t]}function uo(n){let e=n.parseTabular();if(!e)return["Which"];let i=["Which"];for(let t of e)if(t.length===1)i.push("True"),i.push(t[0]);else if(t.length===2){let r=z(t[1]);i.push(r?"True":to(t[1])??"True"),i.push(t[0])}return i}var fo=[{latexTrigger:["\\not","<"],kind:"infix",associativity:"right",precedence:246,parse:"NotLess"},{name:"NotLess",latexTrigger:["\\nless"],kind:"infix",associativity:"right",precedence:246},{latexTrigger:["<"],kind:"infix",associativity:"right",precedence:245,parse:"Less"},{name:"Less",latexTrigger:["\\lt"],kind:"infix",associativity:"right",precedence:245},{latexTrigger:["<","="],kind:"infix",associativity:"right",precedence:241,parse:"LessEqual"},{name:"LessEqual",latexTrigger:["\\le"],kind:"infix",associativity:"right",precedence:241},{latexTrigger:["\\leq"],kind:"infix",associativity:"right",precedence:241,parse:"LessEqual"},{latexTrigger:["\\leqslant"],kind:"infix",associativity:"right",precedence:A+5,parse:"LessEqual"},{name:"LessNotEqual",latexTrigger:["\\lneqq"],kind:"infix",associativity:"right",precedence:A},{name:"NotLessNotEqual",latexTrigger:["\\nleqq"],kind:"infix",associativity:"right",precedence:A},{name:"LessOverEqual",latexTrigger:["\\leqq"],kind:"infix",associativity:"right",precedence:A+5},{name:"GreaterOverEqual",latexTrigger:["\\geqq"],kind:"infix",associativity:"right",precedence:A+5,parse:"GreaterEqual"},{name:"Equal",latexTrigger:["="],kind:"infix",associativity:"right",precedence:A},{latexTrigger:["*","="],kind:"infix",associativity:"right",precedence:A,parse:"StarEqual"},{name:"StarEqual",latexTrigger:["\\star","="],kind:"infix",associativity:"right",precedence:A},{name:"PlusEqual",latexTrigger:["+","="],kind:"infix",associativity:"right",precedence:A},{name:"MinusEqual",latexTrigger:["-","="],kind:"infix",associativity:"right",precedence:A},{name:"SlashEqual",latexTrigger:["/","="],kind:"infix",associativity:"right",precedence:A},{name:"EqualEqual",latexTrigger:["=","="],kind:"infix",associativity:"right",precedence:A},{name:"EqualEqualEqual",latexTrigger:["=","=","="],kind:"infix",associativity:"right",precedence:A+5},{name:"TildeFullEqual",latexTrigger:["\\cong"],kind:"infix",associativity:"right",precedence:A},{name:"NotTildeFullEqual",latexTrigger:["\\ncong"],kind:"infix",associativity:"right",precedence:A},{name:"Approx",latexTrigger:["\\approx"],kind:"infix",associativity:"right",precedence:247},{name:"NotApprox",latexTrigger:["\\not","\\approx"],kind:"infix",associativity:"right",precedence:247},{name:"ApproxEqual",latexTrigger:["\\approxeq"],kind:"infix",associativity:"right",precedence:A},{name:"NotApproxEqual",latexTrigger:["\\not","\\approxeq"],kind:"infix",associativity:"right",precedence:250},{name:"NotEqual",latexTrigger:["\\ne"],kind:"infix",associativity:"right",precedence:255},{name:"Unequal",latexTrigger:["!","="],kind:"infix",associativity:"right",precedence:A},{name:"GreaterEqual",latexTrigger:["\\ge"],kind:"infix",associativity:"right",precedence:242},{latexTrigger:["\\geq"],kind:"infix",associativity:"right",precedence:242,parse:"GreaterEqual"},{latexTrigger:[">","="],kind:"infix",associativity:"right",precedence:243,parse:"GreaterEqual"},{latexTrigger:["\\geqslant"],kind:"infix",associativity:"right",precedence:A+5,parse:"GreaterEqual"},{name:"GreaterNotEqual",latexTrigger:["\\gneqq"],kind:"infix",associativity:"right",precedence:A},{name:"NotGreaterNotEqual",latexTrigger:["\\ngeqq"],kind:"infix",associativity:"right",precedence:A},{latexTrigger:[">"],kind:"infix",associativity:"right",precedence:245,parse:"Greater"},{name:"Greater",latexTrigger:["\\gt"],kind:"infix",associativity:"right",precedence:245},{name:"NotGreater",latexTrigger:["\\ngtr"],kind:"infix",associativity:"right",precedence:244},{latexTrigger:["\\not",">"],kind:"infix",associativity:"right",precedence:244,parse:"NotGreater"},{name:"RingEqual",latexTrigger:["\\circeq"],kind:"infix",associativity:"right",precedence:A},{name:"TriangleEqual",latexTrigger:["\\triangleq"],kind:"infix",associativity:"right",precedence:A},{name:"DotEqual",latexTrigger:["\\doteq"],kind:"infix",associativity:"right",precedence:A+5},{name:"DotEqualDot",latexTrigger:["\\doteqdot"],kind:"infix",associativity:"right",precedence:A+5},{name:"FallingDotEqual",latexTrigger:["\\fallingdotseq"],kind:"infix",associativity:"right",precedence:A+5},{name:"RisingDotEqual",latexTrigger:["\\fallingdotseq"],kind:"infix",associativity:"right",precedence:A+5},{name:"QuestionEqual",latexTrigger:["\\questeq"],kind:"infix",associativity:"right",precedence:A},{name:"MuchLess",latexTrigger:["\\ll"],kind:"infix",associativity:"right",precedence:A},{name:"MuchGreater",latexTrigger:["\\gg"],kind:"infix",associativity:"right",precedence:A},{name:"Precedes",latexTrigger:["\\prec"],kind:"infix",associativity:"right",precedence:A},{name:"Succeeds",latexTrigger:["\\succ"],kind:"infix",associativity:"right",precedence:A},{name:"PrecedesEqual",latexTrigger:["\\preccurlyeq"],kind:"infix",associativity:"right",precedence:A},{name:"SucceedsEqual",latexTrigger:["\\curlyeqprec"],kind:"infix",associativity:"right",precedence:A},{name:"NotPrecedes",latexTrigger:["\\nprec"],kind:"infix",associativity:"right",precedence:A},{name:"NotSucceeds",latexTrigger:["\\nsucc"],kind:"infix",associativity:"right",precedence:A},{name:"Between",latexTrigger:["\\between"],kind:"infix",associativity:"right",precedence:A+5}];function Ki(n){return typeof n!="string"?!1:fo.some(e=>e.name===n)}var ea=[{name:"Matrix",serialize:(n,e)=>{let i=B(p(e,1))??[];return Ks(n,i,z(p(e,2)),z(p(e,3)))}},{name:"Vector",serialize:(n,e)=>{let i=B(e)??[];return Ks(n,i.map(t=>["List",t]),z(p(e,2)),z(p(e,3)))}},{kind:"environment",identifierTrigger:"pmatrix",parse:n=>{let e=_n(n),[i,t]=Nn(n);return e?[i,t,{str:"()"},{str:e}]:[i,t]}},{kind:"environment",identifierTrigger:"bmatrix",parse:n=>{let e=_n(n),[i,t]=Nn(n);return e?[i,t,{str:"[]"},{str:e}]:[i,t,{str:"[]"}]}},{kind:"environment",identifierTrigger:"Bmatrix",parse:n=>{let e=_n(n),[i,t]=Nn(n);return e?[i,t,{str:"{}"},{str:e}]:[i,t,{str:"{}"}]}},{kind:"environment",identifierTrigger:"vmatrix",parse:n=>{let e=_n(n),[i,t]=Nn(n);return e?[i,t,{str:"||"},{str:e}]:[i,t,{str:"||"}]}},{kind:"environment",identifierTrigger:"Vmatrix",parse:n=>{let e=_n(n),[i,t]=Nn(n);return e?[i,t,{str:"\u2016\u2016"},{str:e}]:[i,t,{str:"\u2016\u2016"}]}},{kind:"environment",identifierTrigger:"smallmatrix",parse:n=>{let e=_n(n),[i,t]=Nn(n);return e?[i,t,{str:"()"},{str:e}]:[i,t]}},{kind:"environment",identifierTrigger:"array",parse:n=>{let e=_n(n,!1),[i,t]=Nn(n);return e?[i,t,{str:".."},{str:e}]:[i,t,{str:".."}]}},{kind:"environment",identifierTrigger:"matrix",parse:n=>{let e=_n(n),[i,t]=Nn(n);return e?[i,t,{str:".."},{str:e}]:[i,t,{str:".."}]}},{kind:"environment",identifierTrigger:"matrix*",parse:n=>{let e=_n(n),[i,t]=Nn(n);return e?[i,t,{str:".."},{str:e}]:[i,t,{str:".."}]}},{name:"ConjugateTranspose",kind:"postfix",latexTrigger:["^","\\star"]},{kind:"postfix",latexTrigger:["^","\\H"],parse:"ConjugateTranspose"},{kind:"postfix",latexTrigger:["^","\\dagger"],parse:(n,e)=>["ConjugateTranspose",e]},{kind:"postfix",latexTrigger:["^","\\ast"],parse:(n,e)=>["ConjugateTranspose",e]},{kind:"postfix",latexTrigger:["^","\\top"],parse:(n,e)=>["Transpose",e]},{kind:"postfix",latexTrigger:["^","\\intercal"],parse:(n,e)=>["Transpose",e]},{name:"Transpose",kind:"postfix",latexTrigger:["^","T"]},{name:"PseudoInverse",kind:"postfix",latexTrigger:["^","+"]},{name:"Trace",kind:"function",identifierTrigger:"tr"},{name:"Determinant",kind:"function",identifierTrigger:"det"}];function Nn(n){let e=n.parseTabular();return e?["Matrix",["List",...e.map(i=>["List",...i])]]:["",null]}function _n(n,e=!0){let i=n.parseStringGroup(e)?.trim();if(!i)return"";let t="";for(let r of i)r==="c"&&(t+="="),r==="l"&&(t+="<"),r==="r"&&(t+=">"),r==="|"&&(t+="|"),r===":"&&(t+=":");return t}function Ks(n,e,i,t){i??(i="()");let[r,o]=["",""];typeof i=="string"&&i.length===2&&([r,o]=i);let s="";if(t)for(let f of t)f==="<"?s+="l":f===">"?s+="r":f==="="?s+="c":f==="|"?s+="|":f===":"&&(s+=":");let a=[];for(let f of e??[]){let d=[];for(let c of B(f)??[])d.push(n.serialize(c));a.push(d.join(" & "))}let u=a.join(`\\\\
`),l=s.length>0?`[${s}]`:"";return r==="("&&o===")"?N(["\\begin{pmatrix}",l,u,"\\end{pmatrix}"]):r==="["&&o==="]"?N(["\\begin{bmatrix}",l,u,"\\end{bmatrix}"]):r==="{"&&o==="}"?N(["\\begin{Bmatrix}",l,u,"\\end{Bmatrix}"]):r==="|"&&o==="|"?N(["\\begin{vmatrix}",l,u,"\\end{vmatrix}"]):r==="\u2016"&&o==="\u2016"?N(["\\begin{Vmatrix}",l,u,"\\end{Vmatrix}"]):r==="{"&&o==="."?N(["\\begin{dcases}",l,u,"\\end{dcases}"]):r==="."&&o==="}"?N(["\\begin{rcases}",l,u,"\\end{rcases}"]):s||r!=="."||o!=="."?N(["\\left",yi[r]??r,"\\begin{array}",`{${s}}`,u,"\\end{array}","\\right",yi[o]??o]):N(["\\begin{matrix}",u,"\\end{matrix}"])}var na=[{name:"True",kind:"symbol",latexTrigger:["\\top"]},{kind:"symbol",latexTrigger:"\\mathrm{True}",parse:"True"},{kind:"symbol",latexTrigger:"\\operator{True}",parse:"True"},{kind:"symbol",latexTrigger:"\\mathsf{T}",parse:"True"},{name:"False",kind:"symbol",latexTrigger:["\\bot"]},{kind:"symbol",latexTrigger:"\\operator{False}",parse:"False"},{kind:"symbol",latexTrigger:"\\mathsf{F}",parse:"False"},{name:"And",kind:"infix",latexTrigger:["\\land"],precedence:317},{kind:"infix",latexTrigger:["\\wedge"],parse:"And",precedence:317},{kind:"infix",latexTrigger:"\\&",parse:"And",precedence:317},{kind:"infix",latexTrigger:"\\operatorname{and}",parse:"And",precedence:317},{name:"Or",kind:"infix",latexTrigger:["\\lor"],precedence:310},{kind:"infix",latexTrigger:["\\vee"],parse:"Or",precedence:310},{kind:"infix",latexTrigger:"\\parallel",parse:"Or",precedence:310},{kind:"infix",latexTrigger:"\\operatorname{or}",parse:"Or",precedence:310},{name:"Xor",kind:"infix",latexTrigger:["\\veebar"],precedence:315},{name:"Not",kind:"prefix",latexTrigger:["\\lnot"],precedence:880},{kind:"prefix",latexTrigger:["\\neg"],parse:"Not",precedence:880},{name:"Nand",kind:"infix",latexTrigger:["\\barwedge"],precedence:315},{name:"Nor",kind:"infix",latexTrigger:["\u22BD"],precedence:315},{kind:"function",identifierTrigger:"and",parse:"And"},{kind:"function",identifierTrigger:"or",parse:"Or"},{kind:"function",identifierTrigger:"not",parse:"Not"},{name:"Implies",kind:"infix",precedence:220,associativity:"right",latexTrigger:["\\implies"],serialize:"\\implies"},{latexTrigger:["\\Rightarrow"],kind:"infix",precedence:220,associativity:"right",parse:"Implies"},{name:"Equivalent",latexTrigger:["\\iff"],kind:"infix",associativity:"right",precedence:219},{latexTrigger:["\\Leftrightarrow"],kind:"infix",associativity:"right",precedence:219,parse:"Equivalent"},{latexTrigger:["\\equiv"],kind:"infix",associativity:"right",precedence:219,parse:(n,e,i)=>{let t=n.parseExpression({...i,minPrec:219}),r=n.index,o=n.parseExpression({...i,minPrec:219});return o&&b(o)==="Mod"?["Congruent",e,t,H(p(o,1))]:(n.index=r,["Equivalent",e,H(t)])}},{name:"Proves",kind:"infix",latexTrigger:["\\vdash"],precedence:220,associativity:"right",serialize:"\\vdash"},{name:"Entails",kind:"infix",latexTrigger:["\\vDash"],precedence:220,associativity:"right",serialize:"\\vDash"},{name:"Satisfies",kind:"infix",latexTrigger:["\\models"],precedence:220,associativity:"right",serialize:"\\models"}];function Ae(n){return e=>{let i=e.parseGroup();return i===null?[n]:[n,i]}}var ia=[{name:"Overscript",latexTrigger:["\\overset"],kind:"infix",precedence:700},{name:"Underscript",latexTrigger:["\\underset"],kind:"infix",precedence:700},{name:"Increment",latexTrigger:["+","+"],kind:"postfix",precedence:880},{name:"Decrement",latexTrigger:["-","-"],kind:"postfix",precedence:880},{name:"PreIncrement",latexTrigger:["+","+"],kind:"prefix",precedence:880},{name:"PreDecrement",latexTrigger:["-","-"],kind:"prefix",precedence:880},{name:"Ring",latexTrigger:["\\circ"],kind:"infix",precedence:265},{name:"StringJoin",latexTrigger:["\\lt","\\gt"],kind:"infix",precedence:780},{name:"Starstar",latexTrigger:["\\star","\\star"],kind:"infix",precedence:780},{name:"PartialDerivative",latexTrigger:["\\partial"],kind:"prefix",parse:n=>{let e=!1,i="Nothing",t="Nothing";for(;!e;)n.skipSpace(),n.match("_")?t=n.parseGroup()??n.parseToken():n.match("^")?i=n.parseGroup()??n.parseToken():e=!0;let r=Ut(t);if(r&&(t=["List",...r]),t===null||i===null)return null;let o=n.parseGroup()??"Nothing";if(o!=="Nothing"&&!oe(o)){let s=n.parseArguments()??["Nothing"];o=[o,...s]}return["PartialDerivative",o,t,i]},serialize:(n,e)=>{let i="\\partial",t=p(e,1),r=p(e,2),o=p(e,3);return r!==null&&r!=="Nothing"&&(b(r)==="List"?i+="_{"+n.serialize(["Sequence",...B(r)??[]])+"}":i+="_{"+n.serialize(r)+"}"),o!==null&&o!=="Nothing"&&(i+="^{"+n.serialize(o)+"}"),t!==null&&t!=="Nothing"&&(i+=n.serialize(t)),i},precedence:740},{name:"OverBar",latexTrigger:["\\overline"],parse:Ae("OverBar")},{name:"UnderBar",latexTrigger:["\\underline"],parse:Ae("UnderBar")},{name:"OverVector",latexTrigger:["\\vec"],parse:Ae("OverVector")},{name:"OverTilde",latexTrigger:["\\tilde"],parse:Ae("OverTilde")},{name:"OverHat",latexTrigger:["\\hat"],parse:Ae("OverHat")},{name:"OverRightArrow",latexTrigger:["\\overrightarrow"],parse:Ae("OverRightArrow")},{name:"OverLeftArrow",latexTrigger:["\\overleftarrow"],parse:Ae("OverLeftArrow")},{name:"OverRightDoubleArrow",latexTrigger:["\\Overrightarrow"],parse:Ae("OverRightDoubleArrow")},{name:"OverLeftHarpoon",latexTrigger:["\\overleftharpoon"],parse:Ae("OverLeftHarpoon")},{name:"OverRightHarpoon",latexTrigger:["\\overrightharpoon"],parse:Ae("OverRightHarpoon")},{name:"OverLeftRightArrow",latexTrigger:["\\overleftrightarrow"],parse:Ae("OverLeftRightArrow")},{name:"OverBrace",latexTrigger:["\\overbrace"],parse:Ae("OverBrace")},{name:"OverLineSegment",latexTrigger:["\\overlinesegment"],parse:Ae("OverLineSegment")},{name:"OverGroup",latexTrigger:["\\overgroup"],parse:Ae("OverGroup")},{latexTrigger:["\\displaystyle"],parse:()=>["Sequence"]},{latexTrigger:["\\textstyle"],parse:()=>["Sequence"]},{latexTrigger:["\\scriptstyle"],parse:()=>["Sequence"]},{latexTrigger:["\\scriptscriptstyle"],parse:()=>["Sequence"]},{latexTrigger:["\\tiny"],parse:()=>["Sequence"]},{latexTrigger:["\\scriptsize"],parse:()=>["Sequence"]},{latexTrigger:["\\footnotesize"],parse:()=>["Sequence"]},{latexTrigger:["\\small"],parse:()=>["Sequence"]},{latexTrigger:["\\normalsize"],parse:()=>["Sequence"]},{latexTrigger:["\\large"],parse:()=>["Sequence"]},{latexTrigger:["\\Large"],parse:()=>["Sequence"]},{latexTrigger:["\\LARGE"],parse:()=>["Sequence"]},{latexTrigger:["\\huge"],parse:()=>["Sequence"]},{latexTrigger:["\\Huge"],parse:()=>["Sequence"]},{name:"Style",serialize:(n,e)=>{let i=n.serialize(p(e,1)),t=Xn(p(e,2));if(t===null)return i;z(t.display)==="block"?i=N(["{\\displaystyle",i,"}"]):z(t.display)==="inline"?i=N(["{\\textstyle",i,"}"]):z(t.display)==="script"?i=N(["{\\scriptstyle",i,"}"]):z(t.display)==="scriptscript"&&(i=N(["{\\scriptscriptstyle",i,"}"]));let r=M(t.size);return r!==null&&r>=1&&r<=10&&(i=N(["{",{1:"\\tiny",2:"\\scriptsize",3:"\\footnotesize",4:"\\small",5:"\\normalsize",6:"\\large",7:"\\Large",8:"\\LARGE",9:"\\huge",10:"\\Huge"}[r],i,"}"])),i}},{latexTrigger:["\\!"],parse:()=>["HorizontalSpacing",-3]},{latexTrigger:["\\ "],parse:()=>["HorizontalSpacing",6]},{latexTrigger:["\\:"],parse:()=>["HorizontalSpacing",4]},{latexTrigger:["\\enskip"],parse:()=>["HorizontalSpacing",9]},{latexTrigger:["\\quad"],parse:()=>["HorizontalSpacing",18]},{latexTrigger:["\\qquad"],parse:()=>["HorizontalSpacing",36]},{latexTrigger:["\\,"],parse:()=>["HorizontalSpacing",3]},{latexTrigger:["\\;"],parse:()=>["HorizontalSpacing",5]},{latexTrigger:["\\enspace"],parse:()=>["HorizontalSpacing",9]},{name:"HorizontalSpacing",serialize:(n,e)=>{if(p(e,2))return n.serialize(p(e,1));let i=M(p(e,1));return i===null?"":{"-3":"\\!",6:"\\ ",3:"\\,",4:"\\:",5:"\\;",9:"\\enspace",18:"\\quad",36:"\\qquad"}[i]??""}}];function Y(n){return(e,i)=>{let t={"\\arcsin":"Arcsin","\\arccos":"Arccos","\\arctan":"Arctan","\\arctg":"Arctan","\\arcctg":"Arctan","\\arcsec":"Arcsec","\\arccsc":" Arccsc","\\arsinh":"Arsinh","\\arcosh":"Arcosh","\\artanh":"Artanh","\\arcsech":"Arcsech","\\arccsch":"Arcsch","\\ch":"Cosh","\\cos":"Cos","\\cosec":"Csc","\\cosh":"Csch","\\cot":"Cot","\\cotg":"Cot","\\coth":"Coth","\\csc":"Csc","\\ctg":"Cot","\\cth":"Coth","\\sec":"Sec","\\sin":"Sin","\\sinh":"Sinh","\\sh":"Sinh","\\tan":"Tan","\\tanh":"Tanh","\\tg":"Tan","\\th":"Tanh"}[n??""]??n??"";if(e.atTerminator(i))return t;let r=t;do{let u=e.parsePostfixOperator(r,i);if(u===null)break;r=u}while(!0);let o=null;e.match("^")&&(o=e.parseGroup()??e.parseToken());let s=e.parseArguments("implicit",i),a=s===null?r:typeof r=="string"?[r,...s]:["Apply",r,...s];return o===null?a:["Power",a,o]}}var ta=[{name:"Arcsin",latexTrigger:["\\arcsin"],parse:Y("Arcsin")},{name:"Arccos",latexTrigger:["\\arccos"],parse:Y("Arccos")},{name:"Arctan",latexTrigger:["\\arctan"],parse:Y("Arctan")},{latexTrigger:["\\arctg"],parse:Y("Arctan")},{name:"Arccot",latexTrigger:["\\arcctg"],parse:Y("Arccot")},{name:"Arcsec",latexTrigger:"arcsec",parse:Y("Arcsec")},{name:"Arccsc",latexTrigger:["\\arccsc"],parse:Y("Arccsc")},{name:"Arsinh",latexTrigger:["\\arsinh"],parse:Y("Arsinh")},{name:"Arcosh",latexTrigger:["\\arcosh"],parse:Y("Arcosh")},{name:"Artanh",latexTrigger:["\\artanh"],parse:Y("Artanh")},{name:"Arsech",latexTrigger:["\\arsech"],parse:Y("Arsech")},{name:"Arcsch",latexTrigger:["\\arcsch"],parse:Y("Arcsch")},{latexTrigger:["\\ch"],parse:Y("Cosh")},{name:"Cosec",latexTrigger:["\\cosec"],parse:Y("Cosec")},{name:"Cosh",latexTrigger:["\\cosh"],parse:Y("Cosh")},{name:"Cot",latexTrigger:["\\cot"],parse:Y("Cot")},{latexTrigger:["\\cotg"],parse:Y("Cot")},{name:"Coth",latexTrigger:["\\coth"],parse:Y("Coth")},{name:"Csc",latexTrigger:["\\csc"],parse:Y("Csc")},{latexTrigger:["\\ctg"],parse:Y("Cot")},{latexTrigger:["\\cth"],parse:Y("Cotanh")},{name:"Sec",latexTrigger:["\\sec"],parse:Y("Sec")},{name:"Sinh",latexTrigger:["\\sinh"],parse:Y("Sinh")},{latexTrigger:["\\sh"],parse:Y("Sinh")},{name:"Tan",latexTrigger:["\\tan"],parse:Y("Tan")},{latexTrigger:["\\tg"],parse:Y("Tan")},{name:"Tanh",latexTrigger:["\\tanh"],parse:Y("Tanh")},{latexTrigger:["\\th"],parse:Y("Tanh")},{name:"Cos",latexTrigger:["\\cos"],parse:Y("Cos")},{name:"Sin",latexTrigger:["\\sin"],parse:Y("Sin")}];var oa=[{name:"AlgebraicNumbers",latexTrigger:"\\bar\\Q"},{name:"ComplexNumbers",latexTrigger:["\\C"]},{latexTrigger:"\\mathbb{C}",parse:"ComplexNumbers"},{name:"ImaginaryNumbers",latexTrigger:["\\imaginaryI","\\R"]},{name:"ExtendedComplexNumbers",latexTrigger:["\\bar","\\C"]},{name:"EmptySet",latexTrigger:["\\emptyset"]},{latexTrigger:["\\varnothing"],parse:"EmptySet"},{name:"Integers",latexTrigger:["\\Z"]},{latexTrigger:"\\mathbb{Z}",parse:"Integers"},{name:"RationalNumbers",latexTrigger:["\\Q"]},{name:"RealNumbers",latexTrigger:["\\R"]},{latexTrigger:"\\mathbb{R}",parse:"RealNumbers"},{name:"ExtendedRealNumbers",latexTrigger:["\\bar","\\R"]},{name:"TranscendentalNumberss",latexTrigger:"\\R-\\bar\\Q"},{latexTrigger:"\\R\\backslash\\bar\\Q",parse:"TranscendentalNumbers"},{name:"NegativeNumbers",latexTrigger:"\\R^-"},{latexTrigger:"\\R^{-}",parse:"NegativeNumbers"},{latexTrigger:"\\R_-",parse:"NegativeNumbers"},{latexTrigger:"\\R_{-}",parse:"NegativeNumbers"},{latexTrigger:"\\R^{\\lt}",parse:"NegativeNumbers"},{name:"PositiveNumbers",latexTrigger:"\\R^+"},{latexTrigger:"\\R^{+}",parse:"PositiveNumbers"},{latexTrigger:"\\R_+",parse:"PositiveNumbers"},{latexTrigger:"\\R_{+}",parse:"PositiveNumbers"},{latexTrigger:"\\R^{\\gt}",parse:"PositiveNumbers"},{name:"NonPositiveNumbers",latexTrigger:"\\R^{0-}"},{latexTrigger:"\\R^{-0}",parse:"NonPositiveNumbers"},{latexTrigger:"\\R^{\\leq}",parse:"NonPositiveNumbers"},{name:"NegativeIntegers",latexTrigger:"\\Z^-"},{latexTrigger:"\\Z^-",parse:"NegativeIntegers"},{latexTrigger:"\\Z^{-}",parse:"NegativeIntegers"},{latexTrigger:"\\Z_-",parse:"NegativeIntegers"},{latexTrigger:"\\Z_{-}",parse:"NegativeIntegers"},{latexTrigger:"\\Z^{\\lt}",parse:"NegativeIntegers"},{name:"PositiveIntegers",latexTrigger:"\\Z^+"},{latexTrigger:"\\Z^{+}",parse:"PositiveIntegers"},{latexTrigger:"\\Z_+",parse:"PositiveIntegers"},{latexTrigger:"\\Z_{+}",parse:"PositiveIntegers"},{latexTrigger:"\\Z^{\\gt}",parse:"PositiveIntegers"},{latexTrigger:"\\Z^{\\gt0}",parse:"PositiveIntegers"},{latexTrigger:"\\N^+",parse:"PositiveIntegers"},{latexTrigger:"\\N^{+}",parse:"PositiveIntegers"},{latexTrigger:"\\N^*",parse:"PositiveIntegers"},{latexTrigger:"\\N^{*}",parse:"PositiveIntegers"},{latexTrigger:"\\N^\\star",parse:"PositiveIntegers"},{latexTrigger:"\\N^{\\star}",parse:"PositiveIntegers"},{latexTrigger:"\\N_1",parse:"PositiveIntegers"},{latexTrigger:"\\N_{1}",parse:"PositiveIntegers"},{name:"NonNegativeIntegers",latexTrigger:["\\N"]},{latexTrigger:"\\Z^{+0}",parse:"NonNegativeIntegers"},{latexTrigger:"\\Z^{\\geq}",parse:"NonNegativeIntegers"},{latexTrigger:"\\Z^{\\geq0}",parse:"NonNegativeIntegers"},{latexTrigger:"\\Z^{0+}",parse:"NonNegativeIntegers"},{latexTrigger:"\\mathbb{N}",parse:"NonNegativeIntegers"},{latexTrigger:"\\N_0",parse:"NonNegativeIntegers"},{latexTrigger:"\\N_{0}",parse:"NonNegativeIntegers"},{name:"CartesianProduct",latexTrigger:["\\times"],kind:"infix",associativity:"right",precedence:390,parse:(n,e,i)=>{if(390<i.minPrec)return null;let t=n.computeEngine;if(!t||!t.box(e).domain.isCompatible("Sets"))return null;let r=n.index,o=n.parseExpression({...i,minPrec:390});return o===null||t.box(e).domain.isCompatible("Sets")!==!0?(n.index=r,null):["CartesianProduct",e,o]}},{latexTrigger:["^","\\complement"],kind:"postfix",parse:(n,e)=>["Complement",e]},{name:"Complement",latexTrigger:["^","<{>","\\complement","<}>"],kind:"postfix"},{name:"Intersection",latexTrigger:["\\cap"],kind:"infix",precedence:350},{name:"Interval",serialize:ra},{name:"Multiple",serialize:ra},{name:"Union",latexTrigger:["\\cup"],kind:"infix",precedence:350},{name:"Set",kind:"matchfix",openTrigger:"{",closeTrigger:"}",precedence:20,parse:(n,e)=>e===null||oe(e)?"EmptySet":(b(e)=="Delimiter"&&z(p(e,2))===","&&(e=p(e,1)),b(e)!=="Sequence"?["Set",e]:["Set",...B(e)??[]]),serialize:(n,e)=>N(["\\lbrace",(B(e)??[]).map(i=>n.serialize(i)).join(", "),"\\rbrace"])},{name:"SetMinus",latexTrigger:["\\setminus"],kind:"infix",precedence:650},{name:"SymmetricDifference",latexTrigger:["\\triangle"],kind:"infix",precedence:A},{latexTrigger:["\\ni"],kind:"infix",associativity:"right",precedence:160,parse:(n,e,i)=>{let t=n.parseExpression(i);return t===null?null:["Element",t,e]}},{name:"Element",latexTrigger:["\\in"],kind:"infix",precedence:240},{name:"NotElement",latexTrigger:["\\notin"],kind:"infix",precedence:240},{name:"NotSubset",latexTrigger:["\\nsubset"],kind:"infix",associativity:"right",precedence:240},{name:"NotSuperset",latexTrigger:["\\nsupset"],kind:"infix",associativity:"right",precedence:240},{name:"NotSubsetNotEqual",latexTrigger:["\\nsubseteq"],kind:"infix",associativity:"right",precedence:240},{name:"NotSupersetNotEqual",latexTrigger:["\\nsupseteq"],kind:"infix",associativity:"right",precedence:240},{name:"SquareSubset",latexTrigger:["\\sqsubset"],kind:"infix",associativity:"right",precedence:265},{name:"SquareSubsetEqual",latexTrigger:["\\sqsubseteq"],kind:"infix",associativity:"right",precedence:265},{name:"SquareSuperset",latexTrigger:["\\sqsupset"],kind:"infix",associativity:"right",precedence:265},{name:"SquareSupersetEqual",latexTrigger:["\\sqsupseteq"],kind:"infix",associativity:"right",precedence:265},{name:"Subset",latexTrigger:["\\subset"],kind:"infix",associativity:"right",precedence:240},{latexTrigger:["\\subsetneq"],kind:"infix",associativity:"right",precedence:240,parse:"Subset"},{latexTrigger:["\\varsubsetneqq"],kind:"infix",associativity:"right",precedence:240,parse:"Subset"},{name:"SubsetEqual",latexTrigger:["\\subseteq"],kind:"infix",precedence:240},{name:"Superset",latexTrigger:["\\supset"],kind:"infix",associativity:"right",precedence:240},{latexTrigger:["\\supsetneq"],kind:"infix",associativity:"right",precedence:240,parse:"Superset"},{latexTrigger:["\\varsupsetneq"],kind:"infix",associativity:"right",precedence:240,parse:"Superset"},{name:"SupersetEqual",latexTrigger:["\\supseteq"],kind:"infix",associativity:"right",precedence:240}];function ra(n,e){if(e===null)return"";let i=b(e);if(i===null)return"";if(i==="Set")return G(e)===0?"\\emptyset":G(e)===2&&b(p(e,2))==="Condition"?N(["\\left\\lbrace",n.serialize(p(e,1)),"\\middle\\mid",n.serialize(p(e,2)),"\\right\\rbrace"]):N(["\\left\\lbrace",...(B(e)??[]).map(r=>n.serialize(r)+" ,"),"\\right\\rbrace"]);if(i==="Range")return N(["\\mathopen\\lbrack",n.serialize(p(e,1)),", ",n.serialize(p(e,2)),"\\mathclose\\rbrack"]);if(i==="Interval"){let r=p(e,1),o=p(e,2),s=!1,a=!1;return b(r)==="Open"&&(r=p(r,1),s=!0),b(o)==="Open"&&(o=p(o,1),a=!0),N([`\\mathopen${s?"\\rbrack":"\\lbrack"}`,n.serialize(r),", ",n.serialize(o),`\\mathclose${a?"\\lbrack":"\\rbrack"}`])}let t=n.numericSetStyle(e,n.level);return""}function Ei(n,e=1){return i=>{i.skipSpace();let t=null,r=null;for(;!(r!==null&&t!==null)&&(i.peek==="_"||i.peek==="^");)i.match("_")?r=i.parseGroup()??i.parseToken():i.match("^")&&(t=i.parseGroup()??i.parseToken()),i.skipSpace();(r==="Nothing"||oe(r))&&(r=null),(t==="Nothing"||oe(t))&&(t=null);let[o,s]=Cf(i,e);if(o&&!s){if(b(o)==="Add"||b(o)==="Subtract"){let a=[],u=[];for(let l of B(o)??[])if(s)u.push(l);else{let f;[f,s]=fn(l),a.push(f??l)}if(s!==null&&u.length>0)return["Add",sa(i,n,["Add",...a],[{index:s,sub:r,sup:t}]),...u]}else if(b(o)==="Divide"){let a;[a,s]=fn(p(o,1)),a!==null&&s!==null&&(o=["Divide",a,p(o,2)])}}return sa(i,n,o,[{index:s,sub:r,sup:t}])}}function sa(n,e,i,t){if(i&&t.length===0)return[e,i];if(i??(i="Nothing"),n.computeEngine){let r=n.computeEngine,o=!1,s={};for(let a of t)a.index&&(o=!0,s[a.index]={domain:"ExtendedRealNumbers"});o&&r.pushScope().declare(s),i=r.box(i).json,o&&r.popScope()}return[e,i,...t.map(r=>wf(r))]}function wf(n){let e=n.index?["Hold",n.index]:"Nothing";return n.sup!==null?["Tuple",e,n.sub??"Nothing",n.sup]:n.sub!==null?["Tuple",e,n.sub]:e}function Cf(n,e=1){let i=n.index,t=!1,r=n.parseExpression({minPrec:266,condition:()=>((n.matchAll(["\\mathrm","<{>","d","<}>"])||n.matchAll(["\\operatorname","<{>","d","<}>"]))&&(t=!0),t)});if(t||(n.index=i,r=n.parseExpression({minPrec:266,condition:()=>(n.match("d")&&(t=!0),t)})),r&&!t)return fn(r);let o=Mf(n,e);return[r,o[0]??null]}function Mf(n,e=1){n.skipSpace();let i=[],t=V(n.parseSymbol());return t===null?[]:(i.push(t),i)}function fn(n){let e=b(n),i=p(n,1);if(!i)return[n,null];if(e==="Sequence"&&G(n)===1)return fn(i);if(e==="Multiply"||e==="InvisibleOperator"){let t=B(n);if(t&&t.length>1){let r=V(t[t.length-2]);if(r==="d"||r==="d_upright")return t.length===2?[null,V(t[1])]:t.length===3?[t[0],V(t[2])]:[["Multiply",...t.slice(0,-2)],V(t[t.length-1])];let[o,s]=fn(t[t.length-1]);if(o)return[["Multiply",...t.slice(0,-1),o],s]}}else if(e==="Delimiter"){let[t,r]=fn(i);if(r)return t?[["Delimiter",["Sequence",t],...B(n).slice(1)],r]:[null,r]}else if(e==="Add"){let t=B(n);if(t&&t.length>0){let[r,o]=fn(t[t.length-1]);if(o){if(r)return[["Add",...t.slice(0,-1),r],o];if(t.length>2)return[["Add",...t.slice(0,-1)],o];if(t.length>2)return[t[0],o]}}}else if(e==="Negate"){let[t,r]=fn(i);if(r)return[t?["Negate",t]:null,r]}else if(e==="Divide"){let[t,r]=fn(i);if(r)return[["Divide",t??1,p(n,2)],r]}else{let t=B(n);if(t?.length===1){let[r,o]=fn(t[0]);if(o)return[[b(n),r],o]}}return[n,null]}function aa(n){return(e,i)=>{if(!p(i,1))return n;let t=p(i,2),r=b(t),o=null;r==="Tuple"||r==="Triple"||r==="Pair"||r==="Single"?o=p(t,1):r==="Hold"?o=p(t,1):(o=p(t,1)??"x",t=null),b(o)==="Hold"&&(o=p(o,1));let s=o!==null?V(o):null,a=p(i,1);if(b(a)==="Lambda"&&p(a,1)&&(a=Ji(p(a,1),{_:s??"x",_1:s??"x"})),!t)return!s||s==="Nothing"?N([n,"\\!",e.serialize(a)]):N([n,"\\!",e.serialize(a),"\\,\\operatorname{d}",e.serialize(s)]);let u=p(t,2)?V(p(t,2)):null,l=t&&u!=="Nothing"?e.serialize(p(t,2)):"";l.length>0&&(l=`_{${l}}`);let f="",d=p(t,3)?V(p(t,3)):null;return p(t,3)&&d!=="Nothing"&&(f=`^{${e.serialize(p(t,3))}}`),N([n,f,l,"\\!",e.serialize(a),...s&&V(s)!=="Nothing"?["\\,\\operatorname{d}",e.serialize(s)]:[]])}}var ua=[{kind:"expression",name:"Integrate",latexTrigger:["\\int"],parse:Ei("Integrate"),serialize:aa("\\int")},{kind:"expression",latexTrigger:["\\iint"],parse:Ei("Integrate",2)},{kind:"expression",latexTrigger:["\\iiint"],parse:Ei("Integrate",3)},{kind:"expression",name:"CircularIntegrate",latexTrigger:["\\oint"],parse:Ei("CircularIntegrate"),serialize:aa("\\oint")},{kind:"expression",latexTrigger:["\\oiint"],parse:Ei("CircularIntegrate",2)},{kind:"expression",latexTrigger:["\\oiiint"],parse:Ei("CircularIntegrate",3)}];var nn=[["alpha","\\alpha",945],["beta","\\beta",946],["gamma","\\gamma",947],["delta","\\delta",948],["epsilon","\\epsilon",949],["epsilonSymbol","\\varepsilon",1013],["zeta","\\zeta",950],["eta","\\eta",951],["theta","\\theta",952],["thetaSymbol","\\vartheta",977],["iota","\\iota",953],["kappa","\\kappa",954],["kappaSymbol","\\varkappa",1008],["lambda","\\lambda",955],["mu","\\mu",956],["nu","\\nu",957],["xi","\\xi",958],["omicron","\\omicron",959],["pi","\\pi",960],["piSymbol","\\varpi",982],["rho","\\rho",961],["rhoSymbol","\\varrho",1009],["sigma","\\sigma",963],["finalSigma","\\varsigma",962],["tau","\\tau",964],["phi","\\phi",981],["phiLetter","\\varphi",966],["upsilon","\\upsilon",965],["chi","\\chi",967],["psi","\\psi",968],["omega","\\omega",969],["Alpha","\\Alpha",913],["Beta","\\Beta",914],["Gamma","\\Gamma",915],["Delta","\\Delta",916],["Epsilon","\\Epsilon",917],["Zeta","\\Zeta",918],["Eta","\\Eta",919],["Theta","\\Theta",920],["Iota","\\Iota",921],["Kappa","\\Kappa",922],["Lambda","\\Lambda",923],["Mu","\\Mu",924],["Nu","\\Nu",925],["Xi","\\Xi",926],["Omicron","\\Omicron",927],["Rho","\\Rho",929],["Sigma","\\Sigma",931],["Tau","\\Tau",932],["Phi","\\Phi",934],["Upsilon","\\Upsilon",933],["Chi","\\Chi",935],["Psi","\\Psi",936],["Omega","\\Omega",937],["digamma","\\digamma",989],["aleph","\\aleph",8501],["bet","\\beth",8502],["gimel","\\gimel",8503],["dalet","\\daleth",8504],["ell","\\ell",8499],["turnedCapitalF","\\Finv",8498],["turnedCapitalG","\\Game",8513],["weierstrass","\\wp",8472],["eth","\\eth",240],["invertedOhm","\\mho",8487],["hBar","\\hbar",295],["hSlash","\\hslash",8463],["blackClubSuit","\\clubsuit",9827],["whiteHeartSuit","\\heartsuit",9825],["blackSpadeSuit","\\spadesuit",9824],["whiteDiamondSuit","\\diamondsuit",9826],["sharp","\\sharp",9839],["flat","\\flat",9837],["natural","\\natural",9838]],la=[...nn.map(([n,e,i])=>({kind:"symbol",name:n,latexTrigger:[e],parse:n})),...nn.map(([n,e,i])=>({kind:"symbol",latexTrigger:[String.fromCodePoint(i)],parse:n}))];var fa=[{name:"Real",kind:"function",latexTrigger:["\\Re"]},{name:"Imaginary",kind:"function",latexTrigger:["\\Im"]},{name:"Argument",kind:"function",latexTrigger:["\\arg"]},{name:"Conjugate",latexTrigger:["^","\\star"],kind:"postfix"}];var da=[{name:"Mean",kind:"function",identifierTrigger:"mean"},{name:"Median",kind:"function",identifierTrigger:"median"},{name:"StandarDeviation",kind:"function",identifierTrigger:"stddev"},{latexTrigger:["\\bar"],kind:"expression",parse:(n,e)=>{let i=n.parseGroup()??n.parseToken();return!i||!V(i)?null:["Mean",i]}}];var ca={"(":"(",")":")","[":"\\lbrack","]":"\\rbrack","{":"\\lbrace","}":"\\rbrace","<":"\\langle",">":"\\rangle","|":"\\vert","||":"\\Vert","\\lceil":"\\lceil","\\lfloor":"\\lfloor","\\rceil":"\\rceil","\\rfloor":"\\rfloor"};function ma(n,e,i){let t=Af(e,i);if(t===null)return;let r="kind"in e?e.kind:"expression",o=t.latexTrigger;typeof o=="string"&&(n.lookahead=Math.max(n.lookahead,zt(o)));let s=$(o??"",[]);if(s.length===2&&/[_^]/.test(s[0])&&s[1]!=="<{>"&&r!=="function"&&r!=="environment"&&r!=="matchfix"){let a=e.parse;!a&&e.name&&(r==="postfix"||r==="prefix"?a=(u,l)=>[e.name,l]:a=e.name),ma(n,{...e,kind:r,name:void 0,serialize:void 0,parse:a,latexTrigger:[s[0],"<{>",s[1],"<}>"]},i)}n.defs.push(t),t.name!==void 0&&(n.ids.has(t.name)&&i({severity:"warning",message:["invalid-dictionary-entry",t.name,"Duplicate definition. The name (MathJSON identifier) must be unique, but triggers can be shared by multiple definitions."]}),n.ids.set(t.name,t))}function co(n,e){let i={lookahead:1,ids:new Map,defs:[]};for(let t of n)ma(i,t,e);return i}function Af(n,e){if(!Ff(n,e))return null;let i={kind:"kind"in n?n.kind:"expression"},t=null;"latexTrigger"in n&&(typeof n.latexTrigger=="string"?t=$(n.latexTrigger,[]):t=n.latexTrigger);let r=null;"identifierTrigger"in n&&(r=n.identifierTrigger),t!==null&&(i.latexTrigger=ln(t)),r!==null&&(i.identifierTrigger=r),n.name&&(i.name=n.name,i.serialize=Of(n,t,r)),i.kind==="matchfix"&&ci(n)&&(i.openTrigger=n.openTrigger,i.closeTrigger=n.closeTrigger),i.kind==="symbol"&&jr(n)&&(i.precedence=n.precedence??1e4),i.kind==="expression"&&Gr(n)&&(i.precedence=n.precedence??1e4),(i.kind==="prefix"||i.kind==="postfix")&&(Zi(n)||At(n))&&(t&&(t[0]==="^"||t[0]==="_")?(i.precedence=720,n.precedence):i.precedence=n.precedence??1e4),i.kind==="infix"&&Mt(n)&&(!t||t[0]!=="^"&&t[0]!=="_"||!n.associativity||n.associativity,i.associativity=n.associativity??"non",i.precedence=n.precedence??1e4);let o=Pf(n,t,r);return o&&(i.parse=o),i}function Of(n,e,i){if(typeof n.serialize=="function")return n.serialize;let t=n.kind??"expression";if(t==="environment"){let s=n.identifierTrigger??n.name??"unknown";return(a,u)=>N([`\\begin{${s}}`,a.serialize(p(u,1)),`\\end{${s}}`])}if(ci(n)){let s=typeof n.openTrigger=="string"?ca[n.openTrigger]:ln(n.openTrigger),a=typeof n.closeTrigger=="string"?ca[n.closeTrigger]:ln(n.closeTrigger);return(u,l)=>N([s,u.serialize(p(l,1)),a])}let r=n.serialize;if(r===void 0&&e&&(r=ln(e)),r)return t==="postfix"?(s,a)=>N([s.serialize(p(a,1)),r]):t==="prefix"?(s,a)=>N([r,s.serialize(p(a,1))]):t==="infix"?(s,a)=>{let u=G(a);if(u===0)return"";let l=n.precedence??1e4;return N(B(a).flatMap((f,d)=>{let c=s.wrap(f,l+1);return d<u-1?[c,r]:[c]}))}:(s,a)=>b(a)?N([r,s.wrapArguments(a)]):r;let o=i??n.name??"unknown";return t==="postfix"?(s,a)=>N([s.serialize(p(a,1)),s.serializeSymbol(o)]):t==="prefix"?(s,a)=>N([s.serializeSymbol(o),s.serialize(p(a,1))]):t==="infix"?(s,a)=>N([s.serialize(p(a,1)),s.serializeSymbol(o),s.serialize(p(a,2))]):(s,a)=>b(a)?N([s.serializeSymbol(o),s.wrapArguments(a)]):s.serializeSymbol(o)}function Pf(n,e,i){if("parse"in n&&typeof n.parse=="function")return n.parse;let t="kind"in n?n.kind:"expression";if(t==="environment"){let r=n.parse??n.name??i;if(r)return(o,s)=>{let a=o.parseTabular();return a===null?null:[r,["List",a.map(u=>["List",...u])]]}}if(t==="function"){let r=n.parse??n.name??i;if(r)return(o,s)=>{let a=o.parseArguments("enclosure",s);return a===null?r:[r,...a]}}if(t==="symbol"){let r=n.parse??n.name??i;if(r)return(o,s)=>r}if(t==="prefix"){let r=n.parse??n.name??i;if(r){let o=n.precedence??1e4;return(s,a)=>{let u=s.parseExpression({...a??[],minPrec:o});return u===null?null:[r,u]}}}if(t==="postfix"){let r=n.parse??n.name;if(r)return(o,s)=>s===null?null:[r,s]}if(t==="infix"){if(/[_^]/.test(e?.[0]??"")){let a=n.name??n.parse;return(u,l)=>[a,H(p(l,1)),H(p(l,2))]}let r=n.parse??n.name??i,o=n.precedence??1e4,s=n.associativity??"non";if(r)return(a,u,l)=>{if(u===null||o<l.minPrec)return null;let f=H(a.parseExpression({...l,minPrec:o}));return typeof r=="string"?bi(r,u,f,s):[r,u,f]}}if(t==="matchfix"){let r=n.parse??n.name;if(r)return(o,s)=>s===null||oe(s)?null:[r,s]}if(t==="expression"){let r=n.parse??n.name??i;if(r)return()=>r}if("parse"in n){let r=n.parse;return()=>r}}function Ff(n,e){let i=n.name??n.latexTrigger??n.identifierTrigger??n.openTrigger;if(!i)try{i=JSON.stringify(n)}catch{i="???"}if(Array.isArray(i)&&(i=ln(i)),"trigger"in n&&e({severity:"warning",message:["invalid-dictionary-entry",i,"The 'trigger' property is deprecated. Use 'latexTrigger' or 'identifierTrigger' instead"]}),"kind"in n&&!["expression","symbol","function","infix","postfix","prefix","matchfix","environment"].includes(n.kind)&&e({severity:"warning",message:["invalid-dictionary-entry",i,"The 'kind' property must be one of 'expression', 'symbol', 'function', 'infix', 'postfix', 'prefix', 'matchfix', 'environment'"]}),n.serialize!==void 0&&!n.name)return e({severity:"warning",message:["invalid-dictionary-entry",i,"A 'name' property must be provided if a 'serialize' handler is provided"]}),!1;if("identifierTrigger"in n&&(!("kind"in n)||n.kind!=="environment")&&(typeof n.identifierTrigger!="string"||!Ee(n.identifierTrigger))&&e({severity:"warning",message:["invalid-dictionary-entry",i,"The 'identifierTrigger' property must be a valid identifier"]}),"name"in n&&(typeof n.name!="string"?n.name!==void 0&&e({severity:"warning",message:["invalid-dictionary-entry",i,"The 'name' property must be a string"]}):Ee(n.name)||e({severity:"warning",message:["invalid-dictionary-entry",n.name,"The 'name' property must be a valid identifier"]})),ci(n)){if("latexTrigger"in n||"identifierTrigger"in Zi)return e({severity:"warning",message:["invalid-dictionary-entry",i,"'matchfix' operators use a 'openTrigger' and 'closeTrigger' instead of a 'latexTrigger' or 'identifierTrigger'. "]}),!1;if(!n.openTrigger||!n.closeTrigger)return e({severity:"warning",message:["invalid-dictionary-entry",i,"Expected `openTrigger` and a `closeTrigger` for matchfix operator"]}),!1;if(typeof n.openTrigger!=typeof n.closeTrigger)return e({severity:"warning",message:["invalid-dictionary-entry",i,"Expected `openTrigger` and `closeTrigger` to both be strings or array of LatexToken"]}),!1}if(Mt(n)||At(n)||Zi(n)){if(Array.isArray(n.latexTrigger)&&(n.latexTrigger[0]==="_"||n.latexTrigger[0]==="^")||typeof n.latexTrigger=="string"&&(n.latexTrigger.startsWith("^")||n.latexTrigger.startsWith("_"))){if(n.precedence!==void 0||n.associativity!==void 0)return e({severity:"warning",message:["invalid-dictionary-entry",i,'Unexpected "precedence" or "associativity" for superscript/subscript operator']}),!1}else if(n.precedence===void 0)return e({severity:"warning",message:["invalid-dictionary-entry",i,`Expected a "precedence" for ${n.kind} operator`]}),!1}else if(n.associativity!==void 0)return e({severity:"warning",message:["invalid-dictionary-entry",i,'Unexpected "associativity" operator']}),!1;return!ci(n)&&!Zr(n)&&!n.latexTrigger&&!n.identifierTrigger&&!n.name?(e({severity:"warning",message:["invalid-dictionary-entry",i,"Expected a 'name', a 'latexTrigger' or a 'identifierTrigger'"]}),!1):n.parse===void 0&&n.name===void 0?(e({severity:"warning",message:["invalid-dictionary-entry",i,"Expected a 'parse' or 'name'"]}),!1):!0}var vi={algebra:Ls,arithmetic:Ys,calculus:ua,complex:fa,core:Qs,"linear-algebra":ea,logic:na,relop:fo,other:ia,physics:[{name:"mu0",kind:"symbol",latexTrigger:"\\mu_0"}],sets:oa,statistics:da,symbols:la,trigonometry:ta};var Rf={"\\mathord":"","\\mathop":"","\\mathbin":"","\\mathrel":"","\\mathopen":"","\\mathclose":"","\\mathpunct":"","\\mathinner":"","\\operatorname":"","\\mathrm":"_upright","\\mathit":"_italic","\\mathbf":"_bold","\\mathscr":"_script","\\mathcal":"_calligraphic","\\mathfrak":"_fraktur","\\mathsf":"_sansserif","\\mathtt":"_monospace","\\mathbb":"_doublestruck"},Lf={"\\mathring":"_ring","\\hat":"_hat","\\tilde":"_tilde","\\vec":"_vec","\\overline":"_bar","\\underline":"_underbar","\\dot":"_dot","\\ddot":"_ddot","\\dddot":"_dddot","\\ddddot":"_ddddot","\\acute":"_acute","\\grave":"_grave","\\breve":"_breve","\\check":"_check"};function pa(n,e){if(n.atEnd)return null;let i=n.peek,t={"\\_":"_","\\#":"hash"}[i];if(!t&&!e.toplevel&&(t={"+":"plus","-":"minus","\\plusmn":"pm","\\pm":"pm","\\ast":"ast","\\dag":"dag","\\ddag":"ddag","\\bot":"bottom","\\top":"top","\\bullet":"bullet","\\cir":"circle","\\diamond":"diamond","\\times":"times","\\square":"square","\\star":"star"}[i]),t)return n.nextToken(),t;let r=nn.findIndex(o=>o[1]===i);return r>=0?(n.nextToken(),nn[r][0]):n.matchChar()??n.nextToken()}function Zt(n){let e=mo(n),i=n.index,t=Lf[n.peek]??null;if(t){if(n.nextToken(),!n.match("<{>"))return n.index=i,null;let s=Zt(n);if(s===null||!n.match("<}>"))return n.index=i,null;e=`${s}${t}`}if(e===null){for(e="";!n.atEnd;){let s=n.peek;if(s==="<}>"||s==="_"||s==="^")break;let a=pa(n,{toplevel:!1});if(a===null)return n.index=i,null;e+=a}for(;!n.atEnd&&/\d/.test(n.peek);)e+=n.nextToken()}for(;!n.atEnd;)if(n.match("\\degree"))e+="_deg";else if(n.matchAll(["^","\\prime"]))e+="_prime";else if(n.matchAll(["^","<{>","\\prime","<}>"]))e+="_prime";else if(n.matchAll(["^","<{>","\\doubleprime","<}>"]))e+="_dprime";else if(n.matchAll(["^","<{>","\\prime","\\prime","<}>"]))e+="_dprime";else break;let r=[],o=[];for(;!n.atEnd;)if(n.match("_")){let s=n.match("<{>"),a=Zt(n);if(s&&!n.match("<}>")||a===null)return n.index=i,null;o.push(a)}else if(n.match("^")){let s=n.match("<{>"),a=Zt(n);if(s&&!n.match("<}>")||a===null)return n.index=i,null;r.push(a)}else break;return r.length>0&&(e+="__"+r.join("")),o.length>0&&(e+="_"+o.join("")),e}function mo(n){let e=n.index,i=Rf[n.peek]??null;if(i===null)return null;if(n.nextToken(),n.match("<{>")){let t="",r={0:"zero",1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"seven",8:"eight",9:"nine"}[n.peek]??"";return r&&(t=r,n.nextToken()),t+=Zt(n),t===null||!n.match("<}>")?(n.index=e,null):i==="_upright"&&t.length>1?t:t+i}return n.index=e,null}function po(n){let e=n.index,i=mo(n);return i===null||Ee(i)?(n.index=e,null):n.error(["invalid-identifier",{str:en(i)}],e)}function et(n){if(/^[a-zA-Z]$/.test(n.peek)||/^\p{XIDS}$/u.test(n.peek))return n.nextToken();let e=n.index,i=mo(n);if(!i){for(i="";!n.atEnd&&gi.test(i+n.peek);)i+=n.nextToken();i||(i=null)}return i??(i=pa(n,{toplevel:!0})),i&&(i=i.normalize(),Ee(i))?i:(n.index=e,null)}var ha={"(":["\\lparen","("],")":["\\rparen",")"],"[":["\\lbrack","\\[","["],"]":["\\rbrack","\\]","]"],"<":["<","\\langle"],">":[">","\\rangle"],"{":["\\{","\\lbrace"],"}":["\\}","\\rbrace"],":":[":","\\colon"],"|":["|","\\|","\\lvert","\\rvert"],"||":["||","\\Vert","\\lVert","\\rVert"],"\\lfloor":["\\lfloor"],"\\rfloor":["\\rfloor"],"\\lceil":["\\lceil"],"\\rceil":["\\rceil"],"\\ulcorner":["\\ulcorner"],"\\urcorner":["\\urcorner"],"\\llcorner":["\\llcorner"],"\\lrcorner":["\\lrcorner"],"\\lgroup":["\\lgroup"],"\\rgroup":["\\rgroup"],"\\lmoustache":["\\lmoustache"],"\\rmoustache":["\\rmoustache"]},Ht={"\\left":"\\right","\\bigl":"\\bigr","\\Bigl":"\\Bigr","\\biggl":"\\biggr","\\Biggl":"\\Biggr","\\big":"\\big","\\Big":"\\Big","\\bigg":"\\bigg","\\Bigg":"\\Bigg"},nt={"(":")","[":"]","|":"|","\\{":"\\}","\\[":"\\]","\\lbrace":"\\rbrace","\\lparen":"\\rparen","\\langle":"\\rangle","\\lfloor":"\\rfloor","\\lceil":"\\rceil","\\vert":"\\vert","\\lvert":"\\rvert","\\Vert":"\\Vert","\\lVert":"\\rVert","\\lbrack":"\\rbrack","\\ulcorner":"\\urcorner","\\llcorner":"\\lrcorner","\\lgroup":"\\rgroup","\\lmoustache":"\\rmoustache"},ho={precision:6,positiveInfinity:"\\infty",negativeInfinity:"-\\infty",notANumber:"\\operatorname{NaN}",decimalMarker:".",groupSeparator:"\\,",exponentProduct:"\\cdot",beginExponentMarker:"10^{",endExponentMarker:"}",notation:"auto",truncationMarker:"\\ldots",beginRepeatingDigits:"\\overline{",endRepeatingDigits:"}",imaginaryUnit:"\\imaginaryI",avoidExponentsInRange:[-7,20]},go={skipSpace:!0,parseArgumentsOfUnknownLatexCommands:!0,parseNumbers:"auto",parseUnknownIdentifier:(n,e)=>e.computeEngine?.lookupFunction(n)!==void 0?"function":"symbol",preserveLatex:!1},Jt=class{constructor(e,i,t,r){this.index=0;this._boundaries=[];this._lastPeek="";this._peekCounter=0;this._tokens=e,this.options={...ho,...go,...i},this._dictionary=t,this.computeEngine=r,this._positiveInfinityTokens=$(this.options.positiveInfinity,[]),this._negativeInfinityTokens=$(this.options.negativeInfinity,[]),this._notANumberTokens=$(this.options.notANumber,[]),this._decimalMarkerTokens=$(this.options.decimalMarker,[]),this._groupSeparatorTokens=$(this.options.groupSeparator,[]),this._exponentProductTokens=$(this.options.exponentProduct,[]),this._beginExponentMarkerTokens=$(this.options.beginExponentMarker,[]),this._endExponentMarkerTokens=$(this.options.endExponentMarker,[]),this._truncationMarkerTokens=$(this.options.truncationMarker,[]),this._beginRepeatingDigitsTokens=$(this.options.beginRepeatingDigits,[]),this._endRepeatingDigitsTokens=$(this.options.endRepeatingDigits,[]),this._imaginaryNumberTokens=$(this.options.imaginaryUnit,[])}updateOptions(e){for(let[i,t]of Object.entries(e))if(i in this.options)this.options[i]=t,typeof t=="string"&&(i==="positiveInfinity"&&(this._positiveInfinityTokens=$(t,[])),i==="negativeInfinity"&&(this._negativeInfinityTokens=$(t,[])),i==="notANumber"&&(this._notANumberTokens=$(t,[])),i==="decimalMarker"&&(this._decimalMarkerTokens=$(t,[])),i==="groupSeparator"&&(this._groupSeparatorTokens=$(t,[])),i==="exponentProduct"&&(this._exponentProductTokens=$(t,[])),i==="beginExponentMarker"&&(this._beginExponentMarkerTokens=$(t,[])),i==="endExponentMarker"&&(this._endExponentMarkerTokens=$(t,[])),i==="truncationMarker"&&(this._truncationMarkerTokens=$(t,[])),i==="beginRepeatingDigits"&&(this._beginRepeatingDigitsTokens=$(t,[])),i==="endRepeatingDigits"&&(this._endRepeatingDigitsTokens=$(t,[])),i==="imaginaryNumber"&&(this._imaginaryNumberTokens=$(t,[])));else throw Error(`Unexpected option "${i}"`)}get atEnd(){return this.index>=this._tokens.length}get peek(){let e=this._tokens[this.index];if(e===this._lastPeek?this._peekCounter+=1:this._peekCounter=0,this._peekCounter>=1024){let i=`Infinite loop detected while parsing "${this.latex(0)}" at "${this._lastPeek}" (index ${this.index})`;throw console.error(i),new Error(i)}return this._lastPeek=e,e}nextToken(){return this._tokens[this.index++]}atTerminator(e){return this.atBoundary||((e?.condition&&e.condition(this))??!1)}get atBoundary(){if(this.atEnd)return!0;let e=this.index;for(let i of this._boundaries)if(this.matchAll(i.tokens))return this.index=e,!0;return!1}addBoundary(e){this._boundaries.push({index:this.index,tokens:e})}removeBoundary(){this._boundaries.pop()}matchBoundary(){let e=this._boundaries[this._boundaries.length-1],i=e&&this.matchAll(e.tokens);return i&&this._boundaries.pop(),i}boundaryError(e){let i=this._boundaries[this._boundaries.length-1];return this._boundaries.pop(),this.error(e,i.index)}latex(e,i){return ln(this._tokens.slice(e,i))}latexAhead(e){return this.latex(this.index,this.index+e)}lookAhead(){let e=Math.min(this._dictionary.lookahead,this._tokens.length-this.index);if(e<=0)return[];let i=[];for(;e>0;)i.push([e,this.latexAhead(e--)]);return i}peekDefinitions(e){if(this.atEnd)return[];let i=[],t=[...this.getDefs(e)];for(let r of t)r.latexTrigger===""&&i.push([r,0]);for(let[r,o]of this.lookAhead())for(let s of t)s.latexTrigger===o&&i.push([s,r]);for(let r of t)if(r.identifierTrigger){let o=qf(this,r.identifierTrigger);o>0&&i.push([r,o])}return i}skipSpaceTokens(){for(;this.match("<space>"););}skipSpace(){if(!this.atEnd&&this.peek==="<{>"){let i=this.index;for(this.nextToken();this.match("<space>"););if(this.nextToken()==="<}>")return this.skipSpace(),!0;this.index=i}if(!this.options.skipSpace)return!1;let e=!1;for(;this.match("<space>");)e=!0;return e&&this.skipSpace(),e}skipVisualSpace(){this.options.skipSpace&&(this.skipSpace(),["\\!","\\,","\\:","\\;","\\enskip","\\enspace","\\space","\\quad","\\qquad"].includes(this.peek)&&(this.nextToken(),this.skipVisualSpace()),this.skipSpace())}match(e){return this._tokens[this.index]===e?(this.index++,!0):!1}matchAll(e){if(Array.isArray(e),e.length===0)return!1;let i=!0,t=0;do i=this._tokens[this.index+t]===e[t++];while(i&&t<e.length);return i&&(this.index+=t),i}matchAny(e){return e.includes(this._tokens[this.index])?this._tokens[this.index++]:""}matchChar(){let e=this.index,i=0;for(;this.match("^");)i+=1;if(i<2&&(this.index=e),i>=2){let t="",r=0;for(;r!=i;){let o=this.matchAny(["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"]);if(!o)break;t+=o,r+=1}if(t.length===i)return String.fromCodePoint(Number.parseInt(t,16))}else if(this.match("\\char")){let t=Math.floor(this.matchLatexNumber()??Number.NaN);return(!Number.isFinite(t)||t<0||t>1114111)&&(t=10067),String.fromCodePoint(t)}else if(this.match("\\unicode"))if(this.skipSpaceTokens(),this.match("<{>")){let t=this.matchLatexNumber();if(this.match("<}>")&&t!==null&&t>=0&&t<=1114111)return String.fromCodePoint(t)}else{let t=this.matchLatexNumber();if(t!==null&&t>=0&&t<=1114111)return String.fromCodePoint(t)}return this.index=e,null}matchDelimiter(e,i){if(this.peek==="[")return!1;if(Array.isArray(e))return Array.isArray(i),this.matchAll(e)?(this.addBoundary(i),!0):!1;Array.isArray(i);let t=this.index,r=Ht[this.peek];return r&&this.nextToken(),e==="||"&&this.matchAll(["|","|"])?(this.addBoundary(["|","|"]),!0):(ha[e]??[e]).includes(this.peek)?(e=this.nextToken(),i=nt[e]??i,this.addBoundary(r?[r,i]:[i]),!0):(this.index=t,!1)}parseGroup(){let e=this.index;if(this.skipSpaceTokens(),this.match("<{>")){this.addBoundary(["<}>"]);let i=this.parseExpression();if(this.skipSpace(),this.matchBoundary())return i??["Sequence"];for(;!this.matchBoundary()&&!this.atEnd;)this.nextToken();if(b(i)==="Error")return i;let t=this.error("expected-closing-delimiter",e);return i?["InvisibleOperator",i,t]:t}return this.index=e,null}parseToken(){if(this.skipSpace(),[...'!"#$%&(),/;:?@[]\\`|~'.split(""),"\\left","\\bigl"].includes(this.peek))return null;if(/^[0-9]$/.test(this.peek))return parseInt(this.nextToken());let i=this.parseGenericExpression()??this.parseSymbol();return i||null}parseOptionalGroup(){let e=this.index;if(this.skipSpaceTokens(),this.match("[")){this.addBoundary(["]"]);let i=this.parseExpression();return this.skipSpace(),this.matchBoundary()?i:this.boundaryError("expected-closing-delimiter")}return this.index=e,null}parseTabular(){let e=[],i=[],t=null;for(;!this.atBoundary;)if(this.skipSpace(),this.match("&"))i.push(t??"Nothing"),t=null;else if(this.match("\\\\")||this.match("\\cr"))this.skipSpace(),this.parseOptionalGroup(),t!==null&&i.push(t),e.push(i),i=[],t=null;else{let r=[],o=this.peek;for(;o!=="&"&&o!=="\\\\"&&o!=="\\cr"&&!this.atBoundary;)t=this.parseExpression({minPrec:0,condition:s=>{let a=s.peek;return a==="&"||a==="\\\\"||a==="\\cr"}}),t?r.push(t):(r.push(["Error",["'unexpected-token'",o]]),this.nextToken()),this.skipSpace(),o=this.peek;r.length>1?t=["Sequence",...r]:t=r[0]??"Nothing"}return t!==null&&i.push(t),i.length>0&&e.push(i),e}parseStringGroup(e){e===void 0&&(e=!1);let i=this.index;for(;this.match("<space>"););if(this.match(e?"[":"<{>")){this.addBoundary([e?"]":"<}>"]);let t=this.parseStringGroupContent();if(this.matchBoundary())return t;this.removeBoundary()}return this.index=i,null}parseEnvironment(e){let i=this.index;if(!this.match("\\begin"))return null;let t=this.parseStringGroup()?.trim();if(!t)return this.error("expected-environment-name",i);this.addBoundary(["\\end","<{>",...t.split(""),"<}>"]);for(let r of this.getDefs("environment"))if(r.identifierTrigger===t){let o=r.parse(this,e);return this.skipSpace(),this.matchBoundary()?o!==null?this.decorate(o,i):(this.index=i,null):this.boundaryError("unbalanced-environment")}return this.parseTabular(),this.skipSpace(),this.matchBoundary()?this.error(["unknown-environment",{str:t}],i):this.boundaryError("unbalanced-environment")}parseOptionalSign(){let e=!!this.matchAny(["-","\u2212"]);for(;this.matchAny(["+","\uFE62"])||this.skipSpace();)this.matchAny(["-","\u2212"])&&(e=!e);return e?"-":"+"}parseDecimalDigits(e){e??(e={}),e.withGrouping??(e.withGrouping=!0);let i=[],t=!1;for(;!t;){for(;/^[0-9]$/.test(this.peek);)i.push(this.nextToken()),this.skipVisualSpace();if(t=!0,e.withGrouping&&this.options.groupSeparator){let r=this.index;this.skipVisualSpace(),this.matchAll(this._groupSeparatorTokens)&&(this.skipVisualSpace(),/^[0-9]$/.test(this.peek)?t=!1:this.index=r)}}return i.join("")}parseSignedInteger(e){e??(e={}),e.withGrouping??(e.withGrouping=!0);let i=this.index,t=this.parseOptionalSign(),r=this.parseDecimalDigits(e);return r?t==="-"?"-"+r:r:(this.index=i,"")}parseExponent(){let e=this.index;if(this.matchAny(["e","E"])){let i=this.parseSignedInteger({withGrouping:!1});if(i)return i}if(this.index=e,this.match("\\times")&&(this.skipSpaceTokens(),this.match("1")&&this.match("0")&&this.match("^"))){if(/^[0-9]$/.test(this.peek))return this.nextToken();if(this.match("<{>")){this.skipSpaceTokens();let i=this.parseSignedInteger();if(this.skipSpaceTokens(),this.match("<}>")&&i)return i}}if(this.index=e,this.skipSpaceTokens(),this.match("\\%"))return"-2";if(this.index=e,this.matchAll(this._exponentProductTokens)&&(this.skipSpaceTokens(),this.matchAll(this._beginExponentMarkerTokens))){this.skipSpaceTokens();let i=this.parseSignedInteger({withGrouping:!1});if(this.skipSpaceTokens(),this.matchAll(this._endExponentMarkerTokens)&&i)return i}return this.index=e,""}parseRepeatingDecimal(){let e=this.index,i="";return this.match("(")?(i=this.parseDecimalDigits(),i&&this.match(")")?"("+i+")":(this.index=e,"")):(this.index=e,this.matchAll(["\\left","("])?(i=this.parseDecimalDigits(),i&&this.matchAll(["\\right",")"])?"("+i+")":(this.index=e,"")):(this.index=e,this.matchAll(["\\overline","<{>"])?(i=this.parseDecimalDigits(),i&&this.match("<}>")?"("+i+")":(this.index=e,"")):(this.index=e,this.matchAll(this._beginRepeatingDigitsTokens)?(i=this.parseDecimalDigits(),i&&this.matchAll(this._endRepeatingDigitsTokens)?"("+i+")":(this.index=e,"")):(this.index=e,""))))}parseNumber(){if(this.options.parseNumbers===!1||this.options.parseNumbers==="never")return null;let e=this.index;this.skipVisualSpace();let i=1;for(;this.peek==="-"||this.peek==="+";)this.match("-")?i*=-1:this.match("+"),this.skipVisualSpace();let t="",r="",o=!1;if(this.match(".")||this.matchAll(this._decimalMarkerTokens)){let f=this.peek;(f==="\\overline"||f===this._beginRepeatingDigitsTokens[0]||/[0-9\(]/.test(f))&&(o=!0,t="0")}else t=this.parseDecimalDigits();if(!t)return this.index=e,null;let s=this.index,a=!1;(o||this.match(".")||this.matchAll(this._decimalMarkerTokens))&&(r=this.parseDecimalDigits(),a=!0);let u=!1;if(a){let f=this.parseRepeatingDecimal();f?(r+=f,u=!0):this.match("\\ldots")||this.matchAll(this._truncationMarkerTokens)}if(a&&!r)return this.index=s,{num:i<0?"-"+t:t};this.skipVisualSpace();let l=this.parseExponent();if(!u&&this.options.parseNumbers==="rational"){let f=parseInt(t,10);if(!r)return l?["Multiply",i*f,["Power",10,l]]:i*f;let d=parseInt(r,10),c=r.length,m=f*Math.pow(10,c)+d,g=Math.pow(10,c);return l?["Multiply",["Rational",i*m,g],["Power",10,l]]:["Rational",i*m,g]}return{num:(i<0?"-":"")+t+(a?"."+r:"")+(l?"e"+l:"")}}matchLatexNumber(e=!0){let i=!1,t=this.peek;for(;t==="<space>"||t==="+"||t==="-";)t==="-"&&(i=!i),this.nextToken(),t=this.peek;let r=10,o=["0","1","2","3","4","5","6","7","8","9"];if(this.match("'"))r=8,o=["0","1","2","3","4","5","6","7"],e=!0;else if(this.match('"')||this.match("x"))r=16,o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],e=!0;else if(this.match("`"))return t=this.nextToken(),t?t.startsWith("\\")&&t.length===2?(i?-1:1)*(t.codePointAt(1)??0):(i?-1:1)*(t.codePointAt(0)??0):null;let s="";for(;o.includes(this.peek);)s+=this.nextToken();if(!e&&this.match("."))for(s+=".";o.includes(this.peek);)s+=this.nextToken();let a=e?Number.parseInt(s,r):Number.parseFloat(s);return Number.isNaN(a)?null:i?-a:a}parsePrefixOperator(e){e||(e={minPrec:0}),e.minPrec||(e={...e,minPrec:0});let i=this.index;for(let[t,r]of this.peekDefinitions("prefix")){this.index=i+r;let o=t.parse(this,{...e,minPrec:t.precedence+1});if(o)return o}return this.index=i,null}parseInfixOperator(e,i){i??(i={minPrec:0}),i.minPrec,i.minPrec===void 0&&(i={...i,minPrec:0});let t=this.index;for(let[r,o]of this.peekDefinitions("infix"))if(r.precedence>=i.minPrec){this.index=t+o;let s=r.parse(this,e,i);if(s)return s}return this.index=t,null}parseArguments(e="enclosure",i){if(this.atTerminator(i))return null;let t=this.index,r=this.parseEnclosure();if(e==="enclosure")return r===null?null:Ut(r)??[];if(e==="implicit"){if(b(r)==="Delimiter"){if(b(Be(r))==="Sequence"){let s=Be(Be(r));return s?[s]:[]}return Be(r)?[Be(r)]:[]}if(r!==null)return[r];let o=this.parseExpression({...i,minPrec:390});return o===null?null:[o]}return this.index=t,null}matchOpenDelimiter(e,i){let t=this.index,r=Ht[this.peek];r&&this.nextToken();let o=ha[e]??[e],s=r?[r]:[];return o.includes("||")&&this.matchAll(["|","|"])?(s.push("|"),s.push("|"),s):o.includes(this.peek)?(nt[e]===i?s.push(nt[this.peek]):s.push(i),this.nextToken(),s):(this.index=t,null)}parseEnclosure(){let e=this.getDefs("matchfix"),i=this.index;for(let t of e){if(this.index=i,!this.matchDelimiter(t.openTrigger,t.closeTrigger))continue;let r=this.index;this.skipSpace();let o=this.parseExpression();if(this.skipSpace(),!this.matchBoundary()){let a=this._boundaries[this._boundaries.length-1].tokens;if(this.removeBoundary(),this.index=r,this.skipSpace(),o=this.parseExpression(),this.skipSpace(),!this.matchAll(a)){if(!this.atEnd)continue;return this.index=i,null}}let s=t.parse(this,o??["Sequence"]);if(s!==null)return s}return this.index=i,null}parseGenericExpression(e){if(this.atTerminator(e))return null;let i=this.index,t=null,r=this.peekDefinitions("expression")??[];for(let[o,s]of r)if(this.index=i+s,typeof o.parse=="function"){if(t=o.parse(this,e),t!==null)return t}else return o.name;return this.index=i,null}parseFunction(e){if(this.atTerminator(e))return null;let i=this.index,t=null;for(let[o,s]of this.peekDefinitions("function"))if(this.index=i+s,typeof o.parse=="function"){if(t=o.parse(this,e),t!==null)return t}else{t=o.name;break}if(t===null&&(this.index=i,t=et(this),!this.isFunctionHead(t)))return this.index=i,null;do{let o=this.parsePostfixOperator(t,e);if(o===null)break;t=o}while(!0);let r=this.parseArguments("enclosure",e);return r===null?t:typeof t=="string"?[t,...r]:["Apply",t,...r]}parseSymbol(e){if(this.atTerminator(e))return null;let i=this.index;for(let[r,o]of this.peekDefinitions("symbol"))if(this.index=i+o,typeof r.parse=="function"){let s=r.parse(this,e);if(s)return s}else return r.name;this.index=i;let t=et(this);return t===null?null:this.options.parseUnknownIdentifier?.(t,this)==="symbol"?t:(this.index=i,null)}parseSupsub(e){if(this.atEnd)return e;let i=this.index;this.skipSpace();let t=[],r=[],o=i;for(;this.peek==="_"||this.peek==="^";){if(this.match("_"))if(o=this.index,this.match("_")||this.match("^"))r.push(this.error("syntax-error",o));else{let a=this.parseGroup()??this.parseToken()??this.parseStringGroup();if(a===null)return this.error("missing",i);r.push(a)}else if(this.match("^"))if(o=this.index,this.match("_")||this.match("^"))t.push(this.error("syntax-error",o));else{let a=this.parseGroup()??this.parseToken();if(a===null)return this.error("missing",i);t.push(a)}o=this.index,this.skipSpace()}if(t.length===0&&r.length===0)return this.index=i,e;let s=e;if(r.length>0){let a=[...this.getDefs("infix")].filter(u=>u.latexTrigger==="_");if(a){let u=["Subscript",s,r.length===1?r[0]:["List",...r]];for(let l of a)if(typeof l.parse=="function"?s=l.parse(this,u,{minPrec:0}):s=u,s)break}}if(t.length>0){let a=[...this.getDefs("infix")].filter(u=>u.latexTrigger==="^");if(a){let u=t.filter(l=>!(b(l)==="Sequence"&&G(l)===0));if(u.length!==0){let l=u.length===1?u[0]:["List",...u],f=["Superscript",s,l];for(let d of a)if(typeof d.parse=="function"?s=d.parse(this,f,{minPrec:0}):s=f,s)break}}}return s===null&&(this.index=i),s}parsePostfixOperator(e,i){if(e===null||this.atEnd)return null;let t=this.index;for(let[r,o]of this.peekDefinitions("postfix")){this.index=t+o;let s=r.parse(this,e,i);if(s!==null)return s}return this.index=t,null}parseStringGroupContent(){let e=this.index,i="",t=0;for(;!this.atBoundary||t>0;){let r=this.nextToken();if(r==="<$>"||r==="<$$>")return this.index=e,"";r==="<{>"?(t+=1,i+="\\{"):r==="<}>"?(t-=1,i+="\\}"):r==="<space>"?i+=" ":(r[0],i+=r)}return i}parseSyntaxError(){let e=this.index;if(this.peek==="^")return this.index+=1,["Superscript",this.error("missing",e),H(this.parseGroup())];let i=this.peekDefinitions("operator");if(i.length>0){if(i=this.peekDefinitions("postfix"),i.length>0){let[a,u]=i[0];if(this.index+=u,typeof a.parse=="function"){let l=a.parse(this,this.error("missing",e));if(l)return l}return a.name?[a.name,this.error("missing",e)]:this.error("unexpected-operator",e)}if(i=this.peekDefinitions("prefix"),i.length>0){let[a,u]=i[0];if(this.index+=u,typeof a.parse=="function"){let l=a.parse(this,{minPrec:0});if(l)return l}return a.name?[a.name,this.parseExpression()??this.error("missing",e)]:this.error("unexpected-operator",e)}if(i=this.peekDefinitions("infix"),i.length>0){let[a,u]=i[0];this.index+=u;let l=a.parse(this,this.error("missing",e),{minPrec:0});return l||this.error("unexpected-operator",e)}}let t=this.index,r=po(this);if(r)return r;if(r=et(this),r)return this.error(["unexpected-identifier",r],t);let o=this.peek;if(!o)return this.error("syntax-error",e);if(o[0]!=="\\")return this.error(["unexpected-token",{str:ln(o)}],e);if(Vf(this))return this.error("unexpected-delimiter",e);let s=this.nextToken();if(this.skipSpaceTokens(),s==="\\end"){let a=this.parseStringGroup();return a===null?this.error("expected-environment-name",e):this.error(["unbalanced-environment",{str:a}],e)}for(;this.match("[");){let a=0;for(;!this.atEnd&&a===0&&this.peek!=="]";)this.peek==="["&&(a+=1),this.peek==="]"&&(a-=1),this.nextToken();this.match("]")}for(;this.match("<{>");){let a=0;for(;!this.atEnd&&a===0&&this.peek!=="<}>";)this.peek==="<{>"&&(a+=1),this.peek==="<}>"&&(a-=1),this.nextToken();this.match("<}>")}return this.error(["unexpected-command",{str:ln(s)}],e)}parsePrimary(e){if(this.atBoundary||this.atTerminator(e))return null;let i=null,t=this.index;if(this.match("<}>"))return this.error("unexpected-closing-delimiter",t);if(i??(i=this.parseGroup()),i??(i=this.parseNumber()),i??(i=this.parseEnclosure()),i??(i=this.parseEnvironment(e)),i===null&&this.matchAll(this._positiveInfinityTokens)&&(i={num:"+Infinity"}),i===null&&this.matchAll(this._negativeInfinityTokens)&&(i={num:"-Infinity"}),i===null&&this.matchAll(this._notANumberTokens)&&(i={num:"NaN"}),i??(i=this.parseGenericExpression(e)??this.parseFunction(e)??this.parseSymbol(e)??po(this)),i!==null){i=this.decorate(i,t);let r=null,o=this.index;do{if(r=this.parsePostfixOperator(i,e),i=r??i,this.index===o&&r!==null){this.index;break}o=this.index}while(r!==null)}return i!==null&&(i=this.parseSupsub(i)),this.decorate(i,t)}parseExpression(e){this.skipSpace();let i=this.index;if(this.atBoundary)return this.index=i,null;e??(e={minPrec:0}),e.minPrec,e.minPrec===void 0&&(e={...e,minPrec:0});let t=this.parsePrefixOperator({...e,minPrec:0});if(t===null&&(t=this.parsePrimary(e),b(t)==="Sequence"&&G(t)===0&&(t=null)),t){let r=!1;for(;!r&&!this.atTerminator(e);){this.skipSpace();let o=this.parseInfixOperator(t,e);if(o===null&&this.peekDefinitions("operator").length===0){let s=this.parseExpression({...e,minPrec:ze});s!==null&&(b(t)==="InvisibleOperator"?b(s)==="InvisibleOperator"?o=["InvisibleOperator",...B(t),...B(s)]:o=["InvisibleOperator",...B(t),s]:b(s)==="InvisibleOperator"?o=["InvisibleOperator",t,...B(s)]:o=["InvisibleOperator",t,s])}o!==null?t=o:r=!0}}return this.decorate(t,i)}decorate(e,i){if(e===null)return null;if(!this.options.preserveLatex)return e;let t=this.latex(i,this.index);return Array.isArray(e)?e={latex:t,fn:e}:typeof e=="number"?e={latex:t,num:Number(e).toString()}:typeof e=="string"?e={latex:t,sym:e}:typeof e=="object"&&e!==null&&(e.latex=t),e}error(e,i){let t;typeof e=="string"?(e.startsWith("'"),t={str:e}):(e[0].startsWith("'"),t=["ErrorCode",{str:e[0]},...e.slice(1)]);let r=this.latex(i,this.index);return r?["Error",t,["LatexString",{str:r}]]:["Error",t]}isFunctionHead(e){if(e===null)return!1;let i=V(e);return i?this.computeEngine?.lookupFunction(i)!==void 0||this.options.parseUnknownIdentifier?.(i,this)==="function":!1}*getDefs(e){if(e==="operator")for(let i of this._dictionary.defs)/^prefix|infix|postfix/.test(i.kind)&&(yield i);else for(let i of this._dictionary.defs)i.kind===e&&(yield i)}};function qf(n,e){let i=n.index,t=et(n)?.trim();if(t===null)return 0;let r=t!==e?0:n.index-i;return n.index=i,r}function Vf(n){let e=n.peek;return Object.values(nt).includes(e)||nt[e]?(n.nextToken(),!0):Ht[e]||Object.values(Ht).includes(e)?(n.nextToken(),n.nextToken(),!0):!1}function ga(n,e){let i=n.length,t=n;if(e.beginRepeatingDigits&&e.endRepeatingDigits){n=n.slice(0,-1);for(let o=0;o<n.length-16;o++){let s=n.substring(0,o);for(let a=0;a<17;a++){let u=n.substring(o,o+a+1),l=Math.floor((n.length-s.length)/u.length);if(l<=3)break;if((s+u.repeat(l+1)).startsWith(n))return u==="0"?s.replace(/(\d{3})/g,"$1"+e.groupSeparator):s.replace(/(\d{3})/g,"$1"+e.groupSeparator)+e.beginRepeatingDigits+u+e.endRepeatingDigits}}}let r=i>e.precision-1;return n=t,r&&(n=n.substring(0,e.precision-1)),e.groupSeparator&&(n=n.replace(/(\d{3})/g,"$1"+e.groupSeparator),n.endsWith(e.groupSeparator)&&(n=n.slice(0,-e.groupSeparator.length))),r?n+e.truncationMarker:n}function xa(n,e){return n?e.beginExponentMarker?e.beginExponentMarker+n+(e.endExponentMarker??""):"10^{"+n+"}":""}function ba(n,e){if(n===null)return"";let i;if(typeof n=="number"||typeof n=="string")i=n;else if(typeof n=="object"&&"num"in n)i=n.num;else return"";if(typeof i=="number"){if(i===1/0)return e.positiveInfinity;if(i===-1/0)return e.negativeInfinity;if(Number.isNaN(i))return e.notANumber;let o;return e.notation==="engineering"?o=Wt(i.toExponential(),e,3):e.notation==="scientific"&&(o=Wt(i.toExponential(),e)),o??xo(i.toString(),e)}if(i=i.toLowerCase().replace(/[\u0009-\u000d\u0020\u00a0]/g,""),i==="infinity"||i==="+infinity")return e.positiveInfinity;if(i==="-infinity")return e.negativeInfinity;if(i==="nan")return e.notANumber;if(!/^[-+\.]?[0-9]/.test(i))return"";if(i=i.replace(/[nd]$/,""),/\([0-9]+\)/.test(i)){let[o,s,a,u]=i.match(/(.+)\(([0-9]+)\)(.*)$/)??[];i=s+a.repeat(Math.ceil(e.precision/a.length))+u}let t="";for(i[0]==="-"?(t="-",i=i.substring(1)):i[0]==="+"&&(i=i.substring(1));i[0]==="0";)i=i.substring(1);i.length===0?i="0":i[0]==="."&&(i="0"+i);let r;return e.notation==="engineering"?r=Wt(i,e,3):e.notation==="scientific"&&(r=Wt(i,e)),t+(r??xo(i,e))}function Wt(n,e,i=1){let t=n.match(/^(.*)[e|E]([-+]?[0-9]+)$/);if(!t){let f="";if(n[0]==="-"?(f="-",n=n.substring(1)):n[0]==="+"&&(n=n.substring(1)),n.indexOf(".")<0)n.length===1?n=f+n+"e+0":n=f+n[0]+"."+n.slice(1)+"e+"+(n.length-1).toString();else{let[d,c,m]=n.match(/^(.*)\.(.*)$/);for(m||(m="");c.startsWith("0");)c=c.substring(1);c?n=f+c[0]+"."+c.slice(1)+m+"e+"+(c.length-1).toString():n=f+"0."+m+"e+0"}t=n.match(/^(.*)[e|E]([-+]?[0-9]+)$/)}if(!t)return xo(n,e);let r=parseInt(t[2]),o=t[1];if(Math.abs(r)%i!==0){let f=r>0?r%i:-((i+r)%i);r=r>=0?r-f:r+f;let[d,c,m]=o.match(/^(.*)\.(.*)$/)??["",o,""];o=c+(m+"00000000000000000").slice(0,Math.abs(f))+"."+m.slice(Math.abs(f))}let s=e.avoidExponentsInRange;if(s&&r>=s[0]&&r<=s[1])return;let a="",u=o;t=u.match(/^(.*)\.(.*)$/),t&&(u=t[1],a=t[2]);let l=r!==0?xa(Number(r).toString(),e):"";return e.groupSeparator&&(u=u.replace(/\B(?=(\d{3})+(?!\d))/g,e.groupSeparator),a=ga(a,e)),a&&(a=e.decimalMarker+a),l?u==="1"&&!a?l:u+a+e.exponentProduct+l:u+a}function xo(n,e){let i=n.match(/^(.*)[e|E]([-+]?[0-9]+)$/i),t;i?.[1]&&i[2]&&(t=xa(i[2],e));let r=i?.[1]??n,o="";return i=(t?i[1]:n).match(/^(.*)\.(.*)$/),i?.[1]&&i[2]&&(r=i[1],o=i[2]),e.groupSeparator&&(r=r.replace(/\B(?=(\d{3})+(?!\d))/g,e.groupSeparator),o=ga(o,e)),o&&(o=e.decimalMarker+o),t?r==="1"&&!o?t:r+o+e.exponentProduct+t:r+o}var yo={deg:n=>`${n}\\degree`,prime:n=>`${n}^{\\prime}`,dprime:n=>`${n}^{\\doubleprime}`,ring:n=>`\\mathring{${n}}`,hat:n=>`\\hat{${n}}`,tilde:n=>`\\tilde{${n}}`,vec:n=>`\\vec{${n}}`,bar:n=>`\\overline{${n}}`,underbar:n=>`\\underline{${n}}`,dot:n=>`\\dot{${n}}`,ddot:n=>`\\ddot{${n}}`,tdot:n=>`\\dddot{${n}}`,qdot:n=>`\\ddddot{${n}}`,acute:n=>`\\acute{${n}}`,grave:n=>`\\grave{${n}}`,breve:n=>`\\breve{${n}}`,check:n=>`\\check{${n}}`},Eo={upright:n=>`\\mathrm{${n}}`,italic:n=>`\\mathit{${n}}`,bold:n=>`\\mathbf{${n}}`,script:n=>`\\mathscr{${n}}`,fraktur:n=>`\\mathfrak{${n}}`,doublestruck:n=>`\\mathbb{${n}}`,blackboard:n=>`\\mathbb{${n}}`,calligraphic:n=>`\\mathcal{${n}}`,gothic:n=>`\\mathfrak{${n}}`,sansserif:n=>`\\mathsf{${n}}`,monospace:n=>`\\mathtt{${n}}`},Yt=class{constructor(e,i,t){this.level=-1;this.options=e,e.invisibleMultiply&&(!/#1/.test(e.invisibleMultiply)||!/#2/.test(e.invisibleMultiply))&&t([{severity:"warning",message:["expected-argument","invisibleMultiply"]}]),this.onError=t,this.dictionary=i,this.canonical=void 0}updateOptions(e){for(let i of Object.keys(this.options))i in e&&(this.options[i]=e[i])}wrap(e,i){if(e===null)return"";if(i===void 0)return this.wrapString(this.serialize(e),this.options.groupStyle(e,this.level+1));if(typeof e=="number"||Qn(e)){let r=M(e);return r!==null&&r<0&&i>re?this.wrap(e):this.serialize(e)}let t=b(e);if(typeof t=="string"&&t!=="Delimiter"&&t!=="Subscript"){let r=this.dictionary.ids.get(t);if(r&&(r.kind==="symbol"||r.kind==="expression"||r.kind==="prefix"||r.kind==="infix"||r.kind==="postfix")&&r.precedence<i)return this.wrapString(this.serialize(e),this.options.applyFunctionStyle(e,this.level))}return this.serialize(e)}wrapShort(e){if(e===null)return"";let i=this.serialize(e);if(V(e)!==null||b(e)==="Delimiter"&&G(e)===1||Fn(e)&&!/^(-|\.)/.test(i))return i;let r=b(e);return r!=="Add"&&r!=="Negate"&&r!=="Subtract"&&r!=="PlusMinus"&&r!=="Multiply"?i:this.wrapString(i,this.options.groupStyle(e,this.level+1))}wrapString(e,i,t){if(i==="none")return e;t??(t="()");let r=t?.[0]??".",o=t?.[1]??".";return r==='"'?r="``":r==="|"?r="\\lvert":r=yi[r]??r,o==='"'?o="''":o==="|"?o="\\rvert":o=yi[o]??o,r==="."&&o==="."?e:((r==="."||o===".")&&i==="normal"&&(i="scaled"),i==="scaled"?`\\left${r}${e}\\right${o}}`:i==="big"?`${`\\Bigl${r}`}${e}${`\\Bigr${o}`})`:r+e+o)}wrapArguments(e){return this.wrapString((B(e)??[]).map(i=>this.serialize(i)).join(", "),this.options.applyFunctionStyle(e,this.level))}serializeSymbol(e,i){return typeof e=="string"||Wi(e),i?.kind==="function"?bo(V(e)??"")??"":i?.serialize?.(this,e)??bo(V(e))??""}serializeFunction(e,i){if(i?.serialize)return i.serialize(this,e);let t=b(e);if(typeof t=="string")return bo(t,"auto")+this.wrapArguments(e);if(b(t)==="InverseFunction"||b(t)==="Derivative")return this.serializeFunction(t,this.dictionary.ids.get(b(t)))+this.wrapArguments(e);let r=B(e)??[];if(r.length===1)return N([this.serialize(r[0]),"\\rhd",this.wrapString(this.serialize(t),this.options.applyFunctionStyle(e,this.level))]);let o=this.options.applyFunctionStyle(e,this.level);return N(["\\operatorname{apply}",this.wrapString(this.serialize(t)+", "+this.serialize(["List",...r]),o)])}serializeDictionary(e){return`\\left\\lbrack\\begin{array}{lll}${Object.keys(e).map(i=>`\\textbf{${i}} & \\rightarrow & ${this.serialize(e[i])}`).join("\\\\")}\\end{array}\\right\\rbrack`}serialize(e,i){if(e==null)return"";i??(i={}),i={...i},"canonical"in i||(i.canonical=!0);let t=this.canonical;this.canonical===void 0&&(this.canonical=i.canonical),this.level+=1;try{let r=(()=>{let o=ba(e,this.options);if(o)return o;let s=z(e);if(s!==null)return`\\text{${s}}`;let a=Xn(e);if(a!==null)return this.serializeDictionary(a);let u=V(e);if(u!==null)return this.serializeSymbol(e,this.dictionary.ids.get(u));let l=ro(e);if(l)return this.serializeFunction(e,this.dictionary.ids.get(l));if(b(e)!==null)return this.serializeFunction(e);this.onError([{severity:"warning",message:["syntax-error",e?JSON.stringify(e):"undefined"]}])})();return this.level-=1,this.canonical=t,r??""}catch{}return this.level-=1,this.canonical=t,""}applyFunctionStyle(e,i){return this.options.applyFunctionStyle(e,i)}groupStyle(e,i){return this.options.groupStyle(e,i)}rootStyle(e,i){return this.options.rootStyle(e,i)}fractionStyle(e,i){return this.options.fractionStyle(e,i)}logicStyle(e,i){return this.options.logicStyle(e,i)}powerStyle(e,i){return this.options.powerStyle(e,i)}numericSetStyle(e,i){return this.options.numericSetStyle(e,i)}};function $f(n){let e=n.match(/^([^_]+)/)?.[1]??"",i=nn.findIndex(s=>e===s[0]);if(i>=0)return[nn[i][1],n.substring(nn[i][0].length)];let t={zero:"0",one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",ten:"10"};if(i=Object.keys(t).findIndex(s=>n.startsWith(s)),i>=0){let s=Object.keys(t)[i];return[t[s],n.substring(s.length)]}let r=n.codePointAt(0);if(i=nn.findIndex(s=>s[2]===r),i>=0)return[nn[i][1],n.substring(1)];let o={plus:"+",minus:"-",pm:"\\pm",ast:"\\ast",dag:"\\dag",ddag:"\\ddag",hash:"\\#",bottom:"\\bot",top:"\\top",bullet:"\\bullet",circle:"\\circ",diamond:"\\diamond",times:"\\times",square:"\\square",star:"\\star"};if(i=Object.keys(o).findIndex(s=>e===s),i>=0){let s=Object.keys(o)[i];return[o[s],n.substring(s.length)]}return[e,n.substring(e.length)]}function zf(n){let[e,i]=$f(n),t=[];for(;i.length>0;){let o=i.match(/^_([a-zA-Z]+)(.*)/);if(!o||!yo[o[1]])break;t.push(o[1]),i=o[2]}let r=[];for(;i.length>0;){let o=i.match(/^_([a-zA-Z]+)(.*)/);if(!o||!Eo[o[1]])break;r.push(o[1]),i=o[2]}return[e,t,r,i]}function Qt(n,e=!0,i="auto"){let[t,r,o,s]=zf(n);for(let a of r)yo[a]&&(t=yo[a](t));if(e){let a=[],u=[],l=t.match(/^([^\d].*?)(\d+)$/);for(l&&(u.push(l[2]),t=l[1]);s.length>0;)if(s.startsWith("__")){let[f,d]=Qt(s.substring(2),!1,"none");a.push(f),s=d}else if(s.startsWith("_")){let[f,d]=Qt(s.substring(1),!1,"none");u.push(f),s=d}else break;a.length>0&&(t=`${t}^{${a.join(",")}}`),u.length>0&&(t=`${t}_{${u.join(",")}}`)}for(let a of o)Eo[a]&&(t=Eo[a](t));if(o.length===0&&i!=="none")switch(i){case"auto":zt(t)>1&&(t=`\\mathrm{${t}}`);break;case"operator":t=`\\operatorname{${t}}`;break;case"italic":t=`\\mathit{${t}}`;break;case"upright":t=`\\mathrm{${t}}`;break}return[t,s]}function bo(n,e="auto"){if(n===null)return null;if(gi.test(n))return n;let i=n.match(/^(_+)(.*)/);if(i){let[o,s]=Qt(i[2],!0,"none");return`\\operatorname{${"\\_".repeat(i[1].length)+o+s}}`}let[t,r]=Qt(n,!0,e);return r.length>0?`\\operatorname{${n}}`:t}function ya(n,e){return"normal"}function Ea(n,e){return"normal"}function va(n,e){return e>2?"solidus":"radical"}function Na(n,e){if(e>3)return"inline-solidus";if(b(n)==="Divide"){let[i,t]=[Qi(Be(n)),Qi(Ke(n))];if(t<=2&&i>5)return"factor";if(i<=2&&t>5)return"reciprocal"}return"quotient"}function _a(n,e){return"boolean"}function Sa(n,e){return"solidus"}function Ta(n,e){return"compact"}var Uf={invisibleMultiply:"",invisiblePlus:"",multiply:"\\times",missingSymbol:"\\blacksquare",applyFunctionStyle:ya,groupStyle:Ea,rootStyle:va,fractionStyle:Na,logicStyle:_a,powerStyle:Sa,numericSetStyle:Ta},it=class n{constructor(e){let i=r=>{if(typeof window<"u")for(let o of r)console.warn(o.message)};this.onError=e.onError??i,this.computeEngine=e.computeEngine;let t={...e};delete t.dictionary,delete t.onError,this.options={...ho,...go,...Uf,...t},this._dictionaryInput=e.dictionary??n.getDictionary(),this._dictionary=co(this._dictionaryInput,r=>this.onError([r]))}get dictionary(){return this._dictionaryInput}set dictionary(e){this._dictionaryInput=e,this._dictionary=co(e,i=>this.onError([i]))}updateOptions(e){for(let i of Object.keys(this.options))i in e&&(this.options[i]=e[i]);this.serializer.updateOptions(e)}static getDictionary(e="all"){if(e==="all"){let i=[];for(let t of Object.keys(vi))vi[t]&&i.push(...vi[t]);return i}return vi[e]?Object.freeze([...vi[e]]):[]}parse(e){let i=new Jt($(e,[]),this.options,this._dictionary,this.computeEngine),t=i.parseExpression();if(!i.atEnd){let r=i.parseSyntaxError();for(t=t?["Sequence",t,r]:r;!i.atEnd;)i.nextToken()}return t??(t=["Sequence"]),this.options.preserveLatex&&(Array.isArray(t)?t={latex:e,fn:t}:typeof t=="number"?t={latex:e,num:Number(t).toString()}:typeof t=="string"?t={latex:e,sym:t}:typeof t=="object"&&t!==null&&(t.latex=e)),t??["Sequence"]}serialize(e,i){return this.serializer.serialize(e,i)}get serializer(){return this._serializer?this._serializer:(this._serializer=new Yt(this.options,this._dictionary,this.onError),this._serializer)}};var Va=pe(ce(),1);var nr=pe(ce(),1);var Rn=pe(ce(),1);function vo(n,e,i={}){let{contract:t=.125,step:r=1,power:o=2,atol:s=1e-16,rtol:a=s>0?0:Math.sqrt(Number.EPSILON),maxeval:u=1e6,breaktol:l=2}=i;if(!isFinite(e))return vo(x=>n(1/x),1/e,{rtol:a,atol:s,maxeval:u,contract:Math.abs(t)>1?1/t:t,step:1/r,power:o});let f=r,d=Math.pow(1/t,o),c=n(e+f),m=[c],g=1/0,h=1;for(;h<u;){h+=1,f*=t,m.push(n(e+f));let x=d,S=1/0;for(let T=m.length-2;T>=0;T--){let _=m[T];m[T]=m[T+1]+(m[T+1]-m[T])/(x-1);let w=Math.abs(m[T]-_);S=Math.min(S,w),w<g&&(c=m[T],g=w),x*=d}if(S>l*g||!isFinite(S)||g<=Math.max(a*Math.abs(c),s))break}return[c,g]}var Ia=53,ei=Math.log10(Math.pow(2,Ia)),Gf=7,cp=Math.pow(2,-(Ia-Gf)),tt=Math.pow(10,-10),Ni=1e6,Xt=1e6,rt=200;var No=new Set([2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999,5003,5009,5011,5021,5023,5039,5051,5059,5077,5081,5087,5099,5101,5107,5113,5119,5147,5153,5167,5171,5179,5189,5197,5209,5227,5231,5233,5237,5261,5273,5279,5281,5297,5303,5309,5323,5333,5347,5351,5381,5387,5393,5399,5407,5413,5417,5419,5431,5437,5441,5443,5449,5471,5477,5479,5483,5501,5503,5507,5519,5521,5527,5531,5557,5563,5569,5573,5581,5591,5623,5639,5641,5647,5651,5653,5657,5659,5669,5683,5689,5693,5701,5711,5717,5737,5741,5743,5749,5779,5783,5791,5801,5807,5813,5821,5827,5839,5843,5849,5851,5857,5861,5867,5869,5879,5881,5897,5903,5923,5927,5939,5953,5981,5987,6007,6011,6029,6037,6043,6047,6053,6067,6073,6079,6089,6091,6101,6113,6121,6131,6133,6143,6151,6163,6173,6197,6199,6203,6211,6217,6221,6229,6247,6257,6263,6269,6271,6277,6287,6299,6301,6311,6317,6323,6329,6337,6343,6353,6359,6361,6367,6373,6379,6389,6397,6421,6427,6449,6451,6469,6473,6481,6491,6521,6529,6547,6551,6553,6563,6569,6571,6577,6581,6599,6607,6619,6637,6653,6659,6661,6673,6679,6689,6691,6701,6703,6709,6719,6733,6737,6761,6763,6779,6781,6791,6793,6803,6823,6827,6829,6833,6841,6857,6863,6869,6871,6883,6899,6907,6911,6917,6947,6949,6959,6961,6967,6971,6977,6983,6991,6997,7001,7013,7019,7027,7039,7043,7057,7069,7079,7103,7109,7121,7127,7129,7151,7159,7177,7187,7193,7207,7211,7213,7219,7229,7237,7243,7247,7253,7283,7297,7307,7309,7321,7331,7333,7349,7351,7369,7393,7411,7417,7433,7451,7457,7459,7477,7481,7487,7489,7499,7507,7517,7523,7529,7537,7541,7547,7549,7559,7561,7573,7577,7583,7589,7591,7603,7607,7621,7639,7643,7649,7669,7673,7681,7687,7691,7699,7703,7717,7723,7727,7741,7753,7757,7759,7789,7793,7817,7823,7829,7841,7853,7867,7873,7877,7879,7883,7901,7907,7919]),ka=7919;function _o(n){if(Number.isInteger(n)&&n>=0&&n<Number.MAX_SAFE_INTEGER,n<=3)return{[n]:1};let e={},i=0;for(;n%2===0;)i+=1,n/=2;for(i>0&&(e[2]=i),i=0;n%3===0;)i+=1,n/=3;i>0&&(e[3]=i);let t=!1;for(;!t;){if(n===1)return e;let r=Math.sqrt(n);t=!0;for(let o=6;o<=r+6;o+=6){if(n%(o-1)===0){e[o-1]=(e[o-1]??0)+1,n/=o-1,t=!1;break}if(n%(o+1)===0){e[o+1]=(e[o+1]??0)+1,n/=o+1,t=!1;break}}}return e[n]!==void 0?e[n]+=1:e[n]=1,e}function Ln(n,e){if(n>=Number.MAX_SAFE_INTEGER)return[1,n];if(n===0)return[0,0];Number.isInteger(n)&&n>0&&n<Number.MAX_SAFE_INTEGER;let i=_o(n),t=1,r=1;for(let o of Object.keys(i)){let s=parseInt(o);t=t*Math.pow(s,Math.floor(i[o]/e)),r=r*Math.pow(s,i[o]%e)}return[t,r]}function Sn(n,e){if(n===0)return e;if(e===0||n===e)return n;if(!Number.isInteger(n)||!Number.isInteger(e))return NaN;for(;e!==0;)[n,e]=[e,n%e];return n<0?-n:n}function Kt(n,e){return n*e/Sn(n,e)}function er(n){if(!Number.isInteger(n)||n<0)return NaN;let e=1;for(let i=2;i<=n;i++)e=e*i;return e}function wa(n){if(!Number.isInteger(n)||n<0)return NaN;if(n<0)return NaN;if(n<=1)return 1;let e=n;for(;n>2;)n-=2,e*=n;return e}var Ba=7,Da=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];function ot(n){if(n<0)return NaN;let e=Math.PI,i=n*n*n;return n*Math.log(n)-n-.5*Math.log(n)+.5*Math.log(2*e)+1/(12*n)-1/(360*i)+1/(1260*i*n*n)}function Ti(n){if(n<.5)return Math.PI/(Math.sin(Math.PI*n)*Ti(1-n));if(n>100)return Math.exp(ot(n));n-=1;let e=Da[0];for(let t=1;t<Ba+2;t++)e+=Da[t]/(n+t);let i=n+Ba+.5;return Math.sqrt(2*Math.PI)*Math.pow(i,n+.5)*Math.exp(-i)*e}function E(n){if(n==null)return null;let e=n.numericValue;if(e===null)return null;if(typeof e=="number")return e;if(e instanceof v)return e.toNumber();if(Array.isArray(e)){let[i,t]=e;return typeof i=="number"&&typeof t=="number"?i/t:Number(i)/Number(t)}return!(e instanceof Rn.Complex)||e.im,null}function Ge(n){if(n==null)return null;let e=n.numericValue;if(e===null)return null;if(e instanceof v)return e;if(typeof e=="number")return n.engine.bignum(e);if(Array.isArray(e)){let[i,t]=e;return typeof i=="number"&&typeof t=="number"?n.engine.bignum(i/t):n.engine.bignum(i).div(t.toString())}return!(e instanceof Rn.Complex)||e.im,null}function q(n){if(n==null)return null;let e=n.numericValue;if(e===null)return null;if(typeof e=="number")return Number.isInteger(e)&&e>=-Ni&&e<=Ni?e:null;if(e instanceof v){if(e.isInteger()){let t=e.toNumber();if(t>=-Ni&&t<=Ni)return t}return null}if(n.isCanonical)return null;let i=e;if(Array.isArray(i)){let[t,r]=i,o;return typeof t=="number"&&typeof r=="number"?o=t/r:o=Number(t)/Number(r),Number.isInteger(o)&&o>=-Ni&&o<=Ni?o:null}return null}function _i(n,e){return typeof n=="number"&&Math.abs(n)<=e||n instanceof v&&n.abs().lte(e)||n instanceof Rn.Complex&&Math.abs(n.re)<=e&&Math.abs(n.im)<=e?0:n}function So(n){let e=.254829592,i=-.284496736,t=1.421413741,r=-1.453152027,o=1.061405429,s=.3275911,a=n<0?-1:1;n=Math.abs(n);let u=1/(1+s*n),l=((((o*u+r)*u+t)*u+i)*u+e)*u;return a*(1-l*Math.exp(-n*n))}function Ca(n){let e=Math.PI,i=e*e,t=i*e,r=n*n,o=n*r,s=o*r,a=s*r;return Math.sqrt(e)/2*(n+e/12*o+7*i/480*s+127*t/40320*a+4369*i*i/5806080*a*r+34807*t*i/182476800*a*r*r)}function Ma(n,e,i=.1){return(n(e-4*i)/280-4*n(e-3*i)/105+n(e-2*i)/5-4*n(e-i)/5+4*n(e+i)/5-n(e+2*i)/5+4*n(e+3*i)/105-n(e+4*i)/280)/i}function Aa(n,e,i,t=1e5){let r=0;if(e===-1/0&&i===1/0)for(let o=0;o<t;o++){let s=Math.random(),a=Math.tan(Math.PI*(s-.5)),u=Math.PI*(1+a*a);r+=n(a)/u}else if(e===-1/0)for(let o=0;o<t;o++){let s=Math.random(),a=i-Math.log(1-s),u=1/(1-s);r+=n(a)/u}else if(i===1/0)for(let o=0;o<t;o++){let s=Math.random(),a=e+Math.log(s),u=1/s;r+=n(a)/u}else for(let o=0;o<t;o++)r+=n(e+Math.random()*(i-e));return r/t*(i-e)}function Kn(n,e,i=1){if(i===0){let o=Kn(n,e,-1),s=Kn(n,e,1);return o===void 0||s===void 0?NaN:Math.abs(o-s)>1e-5?NaN:(o+s)/2}let[t,r]=vo(n,e,{step:i>0?1:-1});return t}function jf(n){if(n==="N")return[0,""];let e={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3},i=0,t=0;n=n.toUpperCase();for(let r=n.length-1;r>=0;r--){let o=e[n[r]];if(o===void 0)return[i,n.slice(r)];o<t?i-=o:i+=o,t=o}return[i,""]}function Si(n,e){if(n=n.trim(),n.length===0)return[NaN,""];if(n.startsWith("+"))return Si(n.slice(1),e);if(n.startsWith("-")){let[r,o]=Si(n.slice(1),e);return[-r,o]}let i=10;if(typeof e=="string"&&(e=e.toLowerCase()),n.startsWith("0x"))i=16,n=n.slice(2);else if(n.startsWith("0b"))i=2,n=n.slice(2);else{if(e==="roman")return jf(n);if(e==="base64"||e==="base-64")try{return[parseInt(btoa(n)),""]}catch{return[NaN,""]}else typeof e=="number"?i=e:typeof e=="string"&&(i=parseInt(e))}let t=0;for(let r=0;r<n.length;r++){let o={" ":-1,"\xA0":-1,"\u2000":-1,"\u2001":-1,"\u2002":-1,"\u2003":-1,"\u2004":-1,"\u2005":-1,"\u2006":-1,"\u2007":-1,"\u2008":-1,"\u2009":-1,"\u200A":-1,"\u200B":-1,"\u202F":-1,"\u205F":-1,_:-1,",":-1,0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,g:16,h:17,i:18,j:19,k:20,l:21,m:22,n:23,o:24,p:25,q:26,r:27,s:28,t:29,u:30,v:31,w:32,x:33,y:34,z:35}[n[r]];if(o!==-1){if(o===void 0)return[t,n.substring(r)];if(o>=i)return[t,n.substring(r)];t=t*i+o}}return[t,""]}function ni(n,e,i){if(n===e)return 0;let t=n.N(),r=e.N(),o=t.numericValue,s=r.numericValue;if(o===null||s===null){let l=t.sgn,f=r.sgn;return typeof l!="number"||typeof f!="number"?void 0:l===0&&f===0?0:l<0&&f>0?-1:l>0&&f<0?1:void 0}if(i??(i=n.engine.tolerance),o instanceof Rn.Complex&&s instanceof Rn.Complex)return _i(o.re-s.re,i)===0&&_i(o.im-s.im,i)===0?0:void 0;if(o instanceof Rn.Complex||s instanceof Rn.Complex)return;if(!U(o)&&U(s),typeof o=="number"&&typeof s=="number")return _i(s-o,i)===0?0:o<s?-1:1;let a=n.engine,u=a.bignum(s).sub(a.bignum(o));return _i(u,i)===0?0:u.isPos()?1:-1}function To(n){if(typeof n=="number")return Number.isInteger(n)?BigInt(n):null;if(n==null||!Fn(n))return null;let e=Qn(n)?n.num:n;if(typeof e=="number")return Number.isInteger(e)?BigInt(e):null;if(typeof e!="string")return null;let i=e.toLowerCase().replace(/[nd]$/,"").replace(/[\u0009-\u000d\u0020\u00a0]/g,"");return i==="nan"||i==="infinity"||i==="+infinity"||i==="-infinity"||i.includes(".")?null:P(i)}function P(n){if(typeof n=="bigint")return n;if(n instanceof Ue)return P(n.toString());let e=n.toString(),i=e.match(/([^\.]+)(?:\.([0-9]+))?e(.+)$/);return i&&(e=i[1]+(i[2]??"")+"0".repeat(parseInt(i[3])-(i[2]?i[2].length:0))),BigInt(e)}function Oa(n,e){for(;e!==BigInt(0);)[n,e]=[e,n%e];return n<0?-n:n}var Zf=[BigInt(4),BigInt(2),BigInt(4),BigInt(2),BigInt(4),BigInt(6),BigInt(2),BigInt(6)];function Hf(n){if(n<Number.MAX_SAFE_INTEGER){let f=_o(Number(n)),d=new Map;for(let c of Object.keys(f))d.set(P(c),f[c]);return d}let e=n,i=new Map,t=0,r=0,o=0,s=BigInt(10);for(;e%s===BigInt(0);)t+=1,o+=1,e=e/s;for(s=BigInt(5);e%s===BigInt(0);)o+=1,e=e/s;for(s=BigInt(3);e%s===BigInt(0);)r+=1,e=e/s;for(s=BigInt(2);e%s===BigInt(0);)t+=1,e=e/s;t>0&&i.set("2",t),r>0&&i.set("3",r),o>0&&i.set("5",o),s=BigInt(7);let a="",u=0;for(;s*s<e;)e%s===BigInt(0)?(a||(a=s.toString()),i.set(a,(i.get(a)??0)+1),e=e/s):(s=s+Zf[u],a="",u=u<7?u+1:0);e!==BigInt(1)&&i.set(e.toString(),(i.get(e.toString())??0)+1);let l=new Map;for(let[f,d]of i)l.set(P(f),d);return l}function ii(n,e){let i=Hf(n),t=BigInt(1),r=BigInt(1),o=P(e);for(let[s,a]of i){let u=P(a);t=t*s**(u/o),r=r*s**(u%o)}return[t,r]}function U(n){return n!==null&&Array.isArray(n)}function J(n){return n!==null&&Array.isArray(n)&&typeof n[0]=="number"}function K(n){return n!==null&&Array.isArray(n)&&typeof n[0]=="bigint"}function Ze(n){return n[0]==0}function ie(n){return n[0]===n[1]}function Pa(n){return n[1]===1||n[1]===BigInt(1)}function Bi(n){return n[0]===-n[1]}function Oe(n){return Number(n[0])}function dn(n){return Number(n[1])}function Bo(n){return n[0]<0}function _e(n){return[-n[0],n[1]]}function Tn(n){return n[0]<0?[-n[1],-n[0]]:[n[1],n[0]]}function W(n){let e=n.numericValue;if(Array.isArray(e))return e;if(e!==null){if(typeof e=="number"&&Number.isInteger(e))return e>1e9||e<-1e9?[P(e),BigInt(1)]:[e,1];if(e instanceof v&&e.isInteger())return[P(e),BigInt(1)]}}function st(n,e){if(Array.isArray(e)||e.numericValue!==null&&e.numericValue instanceof nr.Complex,typeof n[0]=="number"&&!Number.isFinite(n[0]))return n;let i=Array.isArray(e)?e:e.numericValue;if(i===null)return n;if(Array.isArray(i)){if(K(i))return n=[BigInt(n[0]),BigInt(n[1])],[i[1]*n[0]+i[0]*n[1],i[1]*n[1]];if(!Number.isFinite(i[0]))return i;if(K(n)){let t=[BigInt(i[0]),BigInt(i[1])];return[t[1]*n[0]+t[0]*n[1],t[1]*n[1]]}return[i[1]*n[0]+i[0]*n[1],i[1]*n[1]]}return i instanceof v?i.isNaN()?[Number.NaN,1]:i.isFinite()?(i.isInteger(),J(n)&&(n=[BigInt(n[0]),BigInt(n[1])]),[n[0]+n[1]*P(i.toString()),n[1]]):[i.isNegative()?-1/0:1/0,1]:i instanceof nr.Complex?[Number.NaN,1]:(!Number.isFinite(i)||Number.isInteger(i),Number.isFinite(i)?J(n)?[n[0]+n[1]*i,n[1]]:[n[0]+n[1]*P(i),n[1]]:[i,1])}function Q(n,e){if(Array.isArray(e)||e.numericValue!==null&&e instanceof nr.Complex,Array.isArray(e))return J(n)&&J(e)?[n[0]*e[0],n[1]*e[1]]:(J(n)&&(n=[P(n[0]),P(n[1])]),J(e)&&(e=[P(e[0]),P(e[1])]),[n[0]*e[0],n[1]*e[1]]);let i=e.numericValue;return i!==null&&typeof i=="number"?(Number.isInteger(i),J(n)?[n[0]*i,n[1]]:[n[0]*P(i),n[1]]):i instanceof v?(i.isInteger(),J(n)?[P(i.toString())*P(n[0]),P(n[1])]:[P(i.toString())*n[0],n[1]]):Array.isArray(i)?K(i)?[i[0]*P(n[0]),i[1]*P(n[1])]:J(n)?[n[0]*i[0],n[1]*i[1]]:[n[0]*P(i[0]),n[1]*P(i[1])]:n}function Fa(n,e){return Q(n,Tn(e))}function ir(n,e){if(Number.isInteger(e),e===0)return[1,1];if(e<0&&(n=Tn(n),e=-e),e===1)return n;if(J(n))return[Math.pow(n[0],e),Math.pow(n[1],e)];let i=P(e);return[n[0]**i,n[1]**i]}function Ra(n){let e=Math.sqrt(Number(n[0])),i=Math.sqrt(Number(n[1]));if(Number.isInteger(e)&&Number.isInteger(i))return[e,i]}function je(n){if(J(n)){if(n[0]===1||n[1]===1)return n;if(n[1]<0&&(n=[-n[0],-n[1]]),!Number.isFinite(n[1]))return[0,1];let i=Sn(n[0],n[1]);return i<=1?n:[n[0]/i,n[1]/i]}if(n[0]===BigInt(1)||n[1]===BigInt(1))return n;n[1]<0&&(n=[-n[0],-n[1]]);let e=Oa(n[0],n[1]);return e<=1?n:[n[0]/e,n[1]/e]}function La(n){if(!Number.isFinite(n)||n%1===0)return n;let i=1e-15,t=Math.floor(n),r=1,o=0,s=t,a=1;for(;n-t>i*a*a;){n=1/(n-t),t=Math.floor(n);let u=r;r=s;let l=o;o=a,s=u+t*r,a=l+t*o}return[s,a]}function qa(n){if(K(n)){let[a,u]=n,[l,f]=ii(a,2),[d,c]=ii(u,2);return[je([l,d]),je([f,c])]}let[e,i]=n,[t,r]=Ln(e,2),[o,s]=Ln(i,2);return[je([t,o]),je([r,s])]}function $a(n){if(typeof n=="number"&&!isNaN(n))return isFinite(n)?Number.isInteger(n)?n>0?"PositiveIntegers":n<0?"NegativeIntegers":"Integers":n>0?"PositiveNumbers":n<0?"NegativeNumbers":"RealNumbers":"ExtendedRealNumbers";if(n instanceof v)return n.isNaN()?"Numbers":n.isFinite()?n.isInteger()?n.isPositive()?"PositiveIntegers":n.isNegative()?"NegativeIntegers":"Integers":n.isPositive()?"PositiveNumbers":n.isNegative()?"NegativeNumbers":"RealNumbers":"ExtendedRealNumbers";if(n instanceof Va.Complex){let e=n;return e.im,e.re===0?"ImaginaryNumbers":"ComplexNumbers"}if(U(n)){let[e,i]=n;return typeof e!="number"||!Number.isNaN(e)&&Number.isNaN(i),"RationalNumbers"}return"Numbers"}function at(n){n.ctor;let e=n.engine,i=n.params,t=[],r=[],o,s=e.domain(i[i.length-1]);for(let a of i.slice(0,-1))if(b(a)==="OptArg"){if(r.length>0)throw Error(`Unexpected multiple OptArg in domain ${n}`);if(o)throw Error(`Unexpected OptArg after VarArg in domain ${n}`);if(G(a)===0)throw Error(`Unexpected empty OptArg in domain ${n}`);for(let u of B(a)){if(b(u)==="OptArg")throw Error(`Unexpected OptArg of OptArg in domain ${n}`);if(b(u)==="VarArg")throw Error(`Unexpected superfluous OptArg of VarArg in domain ${n}`);r.push(e.domain(u))}}else if(b(a)==="VarArg"){let u=B(a);if(u.length!==1)throw Error(`Invalid VarArg in domain ${n}`);if(b(u[0])==="OptArg")throw Error(`Unexpectedf VarArg of OptArg in domain ${n}`);if(b(u[0])==="VarArg")throw Error(`Unexpected VarArg of VarArg in domain ${n}`);o=e.domain(u[0])}else{if(r.length>0)throw Error(`Unexpected required parameter after OptArg in domain ${n}`);if(o)throw Error(`Unexpected required parameter after VarArg in domain ${n}`);t.push(e.domain(a))}return[t,r,o,s]}function ut(n){let[e,i,t,r]=at(n);return{params:e.map(o=>o.json),optParams:i.map(o=>o.json),restParam:t?.json,result:r.json}}function tr(n,e){let i=[...e.params];return e.optParams.length>0&&i.push(["OptArg",...e.optParams]),e.restParam&&i.push(["VarArg",e.restParam]),typeof e.result=="function"?i.push(e.result(n,[])??n.symbol("Undefined")):i.push(e.result),n.domain(["FunctionOf",...i])}function F(n){return n.numericMode==="bignum"||n.numericMode==="auto"}function ae(n){return n.numericMode==="auto"||n.numericMode==="complex"}function Di(n){return typeof n=="string"?n.startsWith("$")&&n.endsWith("$"):!1}function Ii(n){return typeof n!="string"?null:n.startsWith("$$")&&n.endsWith("$$")?n.slice(2,-2):n.startsWith("$")&&n.endsWith("$")?n.slice(1,-1):null}function xe(n){let e=0;for(let i=0;i<n.length;i++)e=Math.imul(31,e)+n.charCodeAt(i)|0;return Math.abs(e)}function lt(n){let e=n.numericValue;return typeof e=="number"&&Number.isInteger(e)?P(e):e instanceof v&&e.isInteger()?P(e):null}function ft(n,e,i){let t=[];for(let r of e){let o=za(r,n,i);o!==null&&(t.some(s=>s.isEqual(o))||t.push(o))}return t}function ti(n,e){let i=new Set;for(let{match:t,replace:r,condition:o,priority:s,id:a}of e){let u;if(typeof o=="string"){let l=Ii(o);if(l){let f=n.pattern(l);u=(d,c)=>f.subs(d).evaluate()?.symbol==="True"}}else u=o;i.add({match:n.pattern(t),replace:typeof r=="function"?r:n.pattern(r),priority:s??0,condition:u,id:a??n.box(t,{canonical:!1}).toString()+(typeof r=="function"?"  ->  function":"  ->  "+n.box(r,{canonical:!1}).toString())})}return i}function za({match:n,replace:e,condition:i,id:t},r,o,s){let a=n.match(r,{substitution:o,...s});return a===null||typeof i=="function"&&!i(a,r.engine)?null:typeof e=="function"?e(r,a):e.subs(a,{canonical:!0})}function rr(n,e,i){let t=i?.iterationLimit??1,r=0,o=i?.once??!1,s=!1,a=!1;try{for(;!s&&r<t;){s=!0;for(let u of e){let l=za(u,n,{},i);if(l!==null&&l!==n){if(o)return l;s=!1,a=!0,n=l}}r+=1}}catch(u){console.error(u)}return a?n:null}var eu=pe(ce(),1);var ki=["InvalidDomain","DictionaryOf","FunctionOf","ListOf","TupleOf","Intersection","Union","OptArg","VarArg"],or={Functions:["FunctionOf",["VarArg","Anything"],"Anything"],NumericFunctions:["FunctionOf","Numbers",["VarArg","Numbers"],"Numbers"],RealFunctions:["FunctionOf","ExtendedRealNumbers",["VarArg","ExtendedRealNumbers"],"ExtendedRealNumbers"],LogicOperators:["FunctionOf","Booleans",["VarArg","Booleans"],"Booleans"],Predicates:["FunctionOf","Anything",["VarArg","Anything"],"Booleans"],RelationalOperators:["FunctionOf","Anything","Anything","Booleans"]},qn={Anything:[],Values:"Anything",Domains:"Anything",Void:"NothingDomain",NothingDomain:["Booleans","Strings","Symbols","Tuples","Lists","Dictionaries","ImaginaryNumbers","TranscendentalNumbers","PositiveIntegers","NegativeIntegers","NonPositiveIntegers","NonNegativeIntegers","PositiveNumbers","NegativeNumbers","NonPositiveNumbers","NonNegativeNumbers","LogicOperators","RelationalOperators"],Booleans:"Values",Strings:"Values",Symbols:"Values",Collections:"Values",Lists:"Collections",Dictionaries:"Collections",Sequences:"Collections",Tuples:"Collections",Sets:"Collections",Functions:"Anything",Predicates:"Functions",LogicOperators:"Predicates",RelationalOperators:"Predicates",NumericFunctions:"Functions",RealFunctions:"NumericFunctions",Numbers:"Values",ExtendedComplexNumbers:"Numbers",ComplexNumbers:"ExtendedComplexNumbers",ImaginaryNumbers:"ComplexNumbers",ExtendedRealNumbers:"ExtendedComplexNumbers",RealNumbers:["ComplexNumbers","ExtendedRealNumbers"],PositiveNumbers:"NonNegativeNumbers",NonNegativeNumbers:"RealNumbers",NonPositiveNumbers:"NegativeNumbers",NegativeNumbers:"RealNumbers",TranscendentalNumbers:"RealNumbers",AlgebraicNumbers:"RealNumbers",RationalNumbers:"AlgebraicNumbers",Integers:"RationalNumbers",PositiveIntegers:"NonNegativeIntegers",NonNegativeIntegers:"Integers",NonPositiveIntegers:"NegativeIntegers",NegativeIntegers:"Integers"},dt;function ri(n){return n?qn[n]!==void 0:!1}function He(n){if(dt||(dt={},He("Void")),dt[n])return Array.from(dt[n]);let e=[];if(typeof n!="string"||!qn[n]){if(!Array.isArray(n))throw Error(`Unknown domain literal ${n}`);if(!ki.includes(n[0]))throw Error(`Unknown domain constructor ${n[0]}`);return n[0]==="FunctionOf"?He("Functions"):n[0]==="TupleOf"?He("Tuples"):n[0]==="ListOf"?He("Lists"):n[0]==="DictionaryOf"?He("Dictionaries"):n[0]==="OptArg"||n[0]==="VarArg"?He(n[1]):n[0]==="Literal"?["Anything"]:n[0]==="Union"?["Anything"]:n[0]==="Intersection"?["Anything"]:["Anything"]}if(typeof qn[n]=="string")e=[qn[n],...He(qn[n])];else if(Array.isArray(qn[n]))for(let i of qn[n])e.push(i),e.push(...He(i));return dt[n]=new Set(e),e}function Ua(){let n={};for(let e of Object.keys(qn))n[e]={domain:"Domains",value:["Domain",e]};n.InvalidDomain={signature:{domain:["FunctionOf","Domains","Domains"],canonical:(e,i)=>e.domain(["InvalidDomain",i[0]])}};for(let e of["DictionaryOf","FunctionOf","ListOf","TupleOf"])n[e]={signature:{domain:["FunctionOf",["VarArg","Domains"],"Domains"],canonical:(i,t)=>i.domain([e,...t])}};for(let e of["OptArg","VarArg"])n[e]={signature:{domain:["FunctionOf","Domains","Domains"],canonical:(i,t)=>i.domain([e,t[0]])}};return n}var Wa=pe(ce(),1);function wi(n){return n.string!==null||(n.symbolDefinition?.value?.string??null)!==null?!0:(n.functionDefinition??n.symbolDefinition?.value?.functionDefinition)?.iterator!==void 0}function sr(n){return n.string!==null||(n.symbolDefinition?.value?.string??null)!==null?!0:(n.functionDefinition??n.symbolDefinition?.value?.functionDefinition)?.at!==void 0}function ue(n){if(n.string!==null||(n.symbolDefinition?.value?.string??null)!==null)return!0;let e=n.functionDefinition??n.symbolDefinition?.value?.functionDefinition;return e?e.at!==void 0&&Number.isFinite(e.size?.(n)??1/0):!1}function*X(n){let e=Jf(n);if(!e){yield n;return}let i=n.engine.iterationLimit,t=0;for(;;){let{done:r,value:o}=e.next();if(r)return;if(t++>i){yield n.engine.error("iteration-limit-exceeded");return}yield o}}function Jf(n){let e=n.functionDefinition??n.symbolDefinition?.value?.functionDefinition;if(e?.iterator)return e.iterator(n);let i=n.string??n.symbolDefinition?.value?.string??null;if(i!==null){if(i.length===0)return{next:()=>({done:!0,value:void 0})};let t=0;return{next:()=>({value:n.engine.string(i.charAt(t++)),done:t>i.length})}}}function Ga(n,e){let i=n.functionDefinition??n.symbolDefinition?.value?.functionDefinition;if(i?.at)return i.at(n,e);let t=n.string;if(t)return e<1?n.engine.string(t.charAt(t.length+e)):n.engine.string(t.charAt(e-1))}function te(n,e){if(!e||n.every(t=>!t.ops||t.head!==e))return n;let i=[];for(let t of n)!t.ops||t.head!==e?i.push(t):i.push(...te(t.ops,e));return i.length,n.length,i.length===n.length?n:i}function se(n){if(n.every(i=>i.head!=="Sequence"&&i.head!=="Delimiter"))return n;let e=[];for(let i of n)if(!i.isValid)e.push(i);else if(i.head==="Delimiter")if(i.op1.head==="Sequence"){let t=i.op1.ops??[];t.length===0?e.push(i.engine.box(["Tupple"])):e.push(...se(t))}else e.push(i.op1);else i.head==="Sequence"?i.ops&&e.push(...i.ops):e.push(i);return e}function Do(n,e){return e===void 0?n._fn("Tuple",[]):e.head==="Delimiter"?Do(n,e.op1):e.head==="Sequence"?e:e.ops?n._fn("Tuple",e.ops):e}var ct=pe(ce(),1);function Io(n){if(n.head==="Negate")return[-1,n.op1];let e=n.numericValue;if(e===null)return[1,n];let i=n.engine;return typeof e=="number"&&e<0?[-1,i.number(-e)]:e instanceof v&&e.isNegative()?[-1,i.number(e.neg())]:e instanceof ct.Complex&&e.re<0?[-1,i.number(i.complex(-e.re,-e.im))]:J(e)&&e[0]<0?[-1,i.number([-e[0],e[1]])]:K(e)&&e[0]<0?[-1,i.number([-e[0],e[1]])]:[1,n]}function Wf(n,e,i,t){let r=n.numericValue,o=n.engine;return typeof r=="number"?F(o)&&i?o.chop(i(o.bignum(r))):o.chop(e(r)):r instanceof v?o.chop(i?.(r)??e(r.toNumber())):J(r)?!F(o)||!i?o.chop(e(r[0]/r[1])):o.chop(i(o.bignum(r[0]).div(r[1]))):K(r)?i?o.chop(i(o.bignum(r[0]).div(o.bignum(r[1])))):o.chop(e(Number(r[0])/Number(r[1]))):r instanceof ct.Complex?!t||!ae(o)?NaN:o.chop(t(r)):NaN}function R(n,e,i,t){if((n?.numericValue??null)!==null)return n.engine.number(Wf(n,e,i,t))}function Yf(n,e,i,t,r){n.numericValue!==null&&e.numericValue;let o=n.engine,s=n.numericValue;J(s)&&(s=s[0]/s[1]);let a=e.numericValue;if(J(a)&&(a=a[0]/a[1]),!F(o)&&typeof s=="number"&&typeof a=="number")return i(s,a);let u;s instanceof v?u=s:K(s)?u=o.bignum(s[0]).div(o.bignum(s[1])):s!==null&&typeof s=="number"&&(u=o.bignum(s));let l;return a instanceof v?l=a:K(a)?u=o.bignum(a[0]).div(o.bignum(a[1])):a!==null&&typeof a=="number"&&(l=o.bignum(a)),u&&l?t?.(u,l)??i(u.toNumber(),l.toNumber()):s instanceof ct.Complex||a instanceof ct.Complex?!r||!ae(o)?NaN:r(o.complex(s??u?.toNumber()??NaN),o.complex(a??l?.toNumber()??NaN)):NaN}function Vn(n,e,i,t,r){if(!(n.numericValue===null||e.numericValue===null))return n.engine.number(Yf(n,e,i,t,r))}function Bn(n,e,i){return n==="all"?!0:n==="none"?!1:n==="first"?i===0:n==="rest"?i!==0:n==="last"?i===e:n==="most"?i!==e:!0}function me(n){return n.every(e=>e.isCanonical)?n:n.map(e=>e.canonical)}function Se(n,e,i){if(e=me(e),e=se(e),!n.strict||e.length===i)return e;let t=[...e.slice(0,i)],r=Math.min(i,e.length);for(;r<i;)t.push(n.error("missing")),r+=1;for(;r<e.length;)t.push(n.error("unexpected-argument",e[r])),r+=1;return t}function Pe(n,e,i){let t=typeof i=="number"?i:i?.count,r=typeof i=="number"||(i?.flatten??!0);if(e=me(e),r&&(e=se(e)),typeof r=="string"&&te(e,r),!n.strict){for(let a of e)ue(a)||a.infer(n.Numbers);return e}let o=!0;t??(t=e.length);let s=[];for(let a=0;a<=Math.max(t-1,e.length-1);a++){let u=e[a];if(a>t-1)o=!1,s.push(n.error("unexpected-argument",u));else if(u===void 0)o=!1,s.push(n.error("missing"));else if(u.symbol&&!n.lookupSymbol(u.symbol)&&!n.lookupFunction(u.symbol))s.push(u);else if(u.isNumber||u.domain?.isNumber)s.push(u);else if(!u.isValid)o=!1,s.push(u);else if(!u.domain)s.push(u);else if(ue(u)){for(let l of X(u))if(!l.isNumber&&!l.domain?.isNumber){o=!1;break}o?s.push(u):s.push(n.domainError("Numbers",u.domain,u))}else u.symbolDefinition?.inferredDomain&&u.domain.isCompatible(n.Numbers,"contravariant")||u.functionDefinition?.signature.inferredSignature&&u.domain.isCompatible(n.Numbers,"contravariant")?s.push(u):(o=!1,s.push(n.domainError("Numbers",u.domain,u)))}if(o)for(let a of s)if(ue(a))for(let u of X(a))u.infer(n.Numbers);else a.infer(n.Numbers);return s}function Fe(n,e,i){return e==null?n.error("missing"):i===void 0?n.error("unexpected-argument",e):(e=e.canonical,e.head==="Sequence"&&(e=e.op1),!e.isValid||!e.domain||e.domain.isCompatible(i)?e:n.domainError(i,e.domain,e))}function ja(n,e){return e==null?n.error("missing"):(e=e.canonical,!e.isValid||e.isPure?e:n.error("expected-pure-expression",e))}function ar(n,e,i){if(e.length===i.length&&e.every((r,o)=>!r.domain||r.domain.isCompatible(i[o])))return e;let t=[];for(let r=0;r<=i.length-1;r++)t.push(Fe(n,e[r],i[r]));for(let r=i.length;r<=e.length-1;r++)t.push(n.error("unexpected-argument",e[r]));return t}function Za(n,e,i,t,r,o,s){if(!n.strict)return null;let a=[],u=!0,l=0;for(let f of r){let d=e[l++];if(!d){a.push(n.error("missing")),u=!1;continue}if(Bn(i,r.length,l-1)){a.push(d);continue}if(!d.isValid){a.push(d),u=!1;continue}if(!d.domain){a.push(d);continue}if(t&&ue(d)){a.push(d);continue}if(d.symbolDefinition?.inferredDomain&&d.domain.isCompatible(f,"contravariant")){a.push(d);continue}if(d.functionDefinition?.signature.inferredSignature&&d.domain.isCompatible(f,"contravariant")){a.push(d);continue}if(!d.domain.isCompatible(f)){a.push(n.domainError(f,d.domain,d)),u=!1;continue}a.push(d)}for(let f of o){let d=e[l];if(!d)break;if(Bn(i,r.length,l)){a.push(d);continue}if(!d.isValid){a.push(d),u=!1,l+=1;continue}if(!d.domain){a.push(d),l+=1;continue}if(t&&ue(d)){a.push(d);continue}if(d.symbolDefinition?.inferredDomain&&d.domain.isCompatible(f,"contravariant")){a.push(d);continue}if(!d.domain.isCompatible(f)){a.push(n.domainError(f,d.domain,d)),u=!1,l+=1;continue}a.push(d),l+=1}if(s)for(let f of e.slice(l)){if(l+=1,Bn(i,r.length,l-1)){a.push(f);continue}if(!f.isValid){a.push(f),u=!1;continue}if(!f.domain){a.push(f);continue}if(t&&ue(f)){a.push(f);continue}if(f.symbolDefinition?.inferredDomain&&f.domain.isCompatible(s,"contravariant")){a.push(f);continue}if(!f.domain.isCompatible(s)){a.push(n.domainError(s,f.domain,f)),u=!1;continue}a.push(f)}if(l<e.length)for(let f of e.slice(l))a.push(n.error("unexpected-argument",f)),u=!1;if(!u)return a;l=0;for(let f of r)Bn(i,r.length,l)||(!t||!ue(e[l]))&&e[l].infer(f),l+=1;for(let f of o)(!t||!ue(e[l]))&&e[l]?.infer(f),l+=1;if(s)for(let f of e.slice(l))Bn(i,r.length,l)||(!t||!ue(f))&&f.infer(s),l+=1;return null}function ur(n){if(!n)return;let e=n.engine,i=[],t=n.ops?.length==3,r=n.ops[0].ops[0].ops,o=r?.length??0,s=null;if(!(t&&(s=n.ops[2].ops[0].ops,r?.length!=s?.length))){for(let a=0;a<o;a++){let u,l,f=null,d=null;l=r[a].canonical,r&&r[a].head==="Equal"&&(l=r[a].op1.canonical,f=r[a].op2.canonical),s&&(d=s[a].canonical),d&&f?u=$n(e.tuple([l,f,d])):d?u=$n(e.tuple([l,e.One,d])):f?u=$n(e.tuple([l,f])):u=$n(l),u&&i.push(u)}return i}}function $n(n){if(!n)return;let e=n.engine,i=null,t=null,r=null;return n.head!=="Tuple"&&n.head!=="Triple"&&n.head!=="Pair"&&n.head!=="Single"?i=n:(i=n.ops[0]??null,t=n.ops[1]?.canonical??null,r=n.ops[2]?.canonical??null),i.head==="Hold"&&(i=i.op1),i.symbol&&(e.declare(i.symbol,{domain:"Integers"}),i.bind()),t&&t.isFinite&&(t=Fe(e,t,"Integers")),r&&r.isFinite&&(r=Fe(e,r,"Integers")),t&&r?e.tuple([i,t,r]):r?e.tuple([i,e.One,r]):t?e.tuple([i,t]):i}function zn(n){let e=1,i=e+Xt,t,r=!0;if(n&&(n.head==="Tuple"||n.head==="Triple"||n.head==="Pair"||n.head==="Single")){if(t=(n.op1.head==="Hold"?n.op1.op1.symbol:n.op1.symbol)??"Nothing",e=q(n.op2)??1,Number.isFinite(e)||(r=!1),n.op3.isNothing||n.op3.isInfinity)r=!1;else{let o=q(n.op3);o===null?r=!1:(i=o,Number.isFinite(i)||(r=!1))}!r&&Number.isFinite(e)&&(i=e+Xt)}else n&&(t=(n.head==="Hold"?n.op1.symbol:n.symbol)??"Nothing",e=1,i=e+Xt);return[t,e,i,r]}function Ci(n,e){return n.flatMap(i=>e.map(t=>[i,t]))}function cn(n,e){return Array.from({length:e-n+1},(i,t)=>n+t)}var Qf={Add:["+",11],Negate:["-",14],Subtract:["-",11],Multiply:["*",12],Divide:["/",13],Equal:["===",8],NotEqual:["!==",8],LessEqual:["<=",9],GreaterEqual:[">=",9],Less:["<",9],Greater:[">",9],And:["&&",4],Or:["||",3],Not:["!",14]},Xf={Abs:"Math.abs",Add:(n,e)=>n.length===1?e(n[0]):`(${n.map(i=>e(i)).join(" + ")})`,Arccos:"Math.acos",Arcosh:"Math.acosh",Arsin:"Math.asin",Arsinh:"Math.asinh",Arctan:"Math.atan",Artanh:"Math.atanh",Ceiling:"Math.ceil",Chop:"_SYS.chop",Cos:"Math.cos",Cosh:"Math.cosh",Exp:"Math.exp",Floor:"Math.floor",Gamma:"_SYS.gamma",GCD:"_SYS.gcd",LCM:"_SYS.lcm",Limit:(n,e)=>`_SYS.limit(${e(n[0])}, ${e(n[1])})`,Ln:"Math.log",List:(n,e)=>`[${n.map(i=>e(i)).join(", ")}]`,Log:(n,e)=>n.length===1?`Math.log(${e(n[0])})`:`(Math.log(${e(n[0])}) / Math.log(${e(n[1])}))`,LogGamma:"_SYS.lngamma",Lb:"Math.log2",Max:"Math.max",Min:"Math.min",Power:(n,e)=>{let i=n[0];if(i===null)throw new Error("Power: no argument");let t=E(n[1]);return t===.5?`Math.sqrt(${e(i)})`:t===1/3?`Math.cbrt(${e(i)})`:t===1?e(i):t===-1?`1 / (${e(i)})`:t===-.5?`1 / Math.sqrt(${e(i)})`:`Math.pow(${e(i)}, ${e(n[1])})`},Range:(n,e)=>{if(n.length===0)return"[]";if(n.length===1)return`Array.from({length: ${e(n[0])}}, (_, i) => i)`;let i=e(n[0]),t=e(n[1]),r=n[2]?e(n[2]):"1";if(i===null)throw new Error("Range: no start");if(t===null&&(t=i,i="1"),r==="0")throw new Error("Range: step cannot be zero");if(parseFloat(r)===1){let o=parseFloat(t),s=parseFloat(i);return o!==null&&s!==null?o-s<50?`[${Array.from({length:o-s+1},(a,u)=>s+u).join(", ")}]`:`Array.from({length: ${o-s+1} 
        }, (_, i) => ${i} + i)`:`Array.from({length: ${t} - ${i} + 1
      }, (_, i) => ${i} + i)`}return`Array.from({length: Math.floor((${t} - ${i}) / ${r}) + 1}, (_, i) => ${i} + i * ${r})`},Root:(n,e)=>{let i=n[0];if(i===null)throw new Error("Root: no argument");let t=n[1];return t===null?`Math.sqrt(${e(i)})`:`Math.pow(${e(i)}, 1 / (${e(t)}))`},Random:"Math.random",Round:"Math.round",Square:(n,e)=>{let i=n[0];if(i===null)throw new Error("Square: no argument");return`Math.pow(${e(i)}, 2)`},Sgn:"Math.sign",Sin:"Math.sin",Sinh:"Math.sinh",Sqrt:"Math.sqrt",Tan:"Math.tan",Tanh:"Math.tanh"},ko=class extends Function{constructor(i){super("_SYS","_",`return ${i}`);this.sys={factorial:er,gamma:Ti,lngamma:ot,gcd:Sn,lcm:Kt,chop:_i,limit:Kn};return new Proxy(this,{apply:(t,r,o)=>super.apply(r,[this.sys,...o]),get:(t,r)=>r==="toString"?()=>i:t[r]})}};function Kf(n,e){let i=he(n,e);return new ko(i)}function Ha(n){let e=n.unknowns;return Kf(n,{operators:i=>Qf[i],functions:i=>Xf[i],var:i=>{let t={Pi:"Math.PI",ExponentialE:"Math.E",NaN:"Number.NaN",ImaginaryUnit:"Number.NaN",Half:"0.5",MachineEpsilon:"Number.EPSILON",GoldenRatio:"((1 + Math.sqrt(5)) / 2)",CatalanConstant:"0.91596559417721901",EulerGamma:"0.57721566490153286"}[i];if(t!==void 0)return t;if(e.includes(i))return`_.${i}`},string:i=>JSON.stringify(i),number:i=>i.toString(),indent:0,ws:i=>i??""})}function Ja(n,e,i,t){if(n==="Error")throw new Error("Error");if(n==="Sequence")return e.length===0?"":`(${e.map(o=>he(o,t,i)).join(", ")})`;if(n==="Sum"||n==="Product")return ed(n,e,t);if(e.every(o=>!wi(o))){let o=t.operators?.(n);if(Ki(n)&&e.length>2&&o){let s=[];for(let a=0;a<e.length-1;a++)s.push(Ja(n,[e[a],e[a+1]],o[1],t));return`(${s.join(") && (")})`}if(o!==void 0){if(e===null)return"";let s;return e.length===1?s=`${o[0]}${he(e[0],t,o[1])}`:s=e.map(a=>he(a,t,o[1])).join(` ${o[0]} `),o[1]<i?`(${s})`:s}}if(n==="Function"){let o=e.slice(1).map(s=>s.symbol);return`((${o.join(", ")}) => ${he(e[0].canonical,{...t,var:s=>o.includes(s)?s:t.var(s)})})`}if(n==="Declare")return`let ${e[0].symbol}`;if(n==="Assign")return`${e[0].symbol} = ${he(e[1],t)}`;if(n==="Return")return`return ${he(e[0],t)}`;if(n==="If"){if(e.length!==3)throw new Error("If: wrong number of arguments");return`((${he(e[0],t)}) ? (${he(e[1],t)}) : (${he(e[2],t)}))`}if(n==="Block"){let o=[];for(let a of e)a.head==="Declare"&&o.push(a.ops[0].symbol);if(e.length===1&&o.length===0)return he(e[0],t);let s=e.map(a=>he(a,{...t,var:u=>o.includes(u)?u:t.var(u)}));return s[s.length-1]=`return ${s[s.length-1]}`,`(() => {${t.ws(`
`)}${s.join(`;${t.ws(`
`)}`)}${t.ws(`
`)}})()`}let r=t.functions?.(n);if(!r)throw new Error(`Unknown function ${n}`);if(typeof r=="function"){if(e.length===1&&ue(e[0])){let o=Mi();return`(${he(e[0],t)}).map((${o}) => ${r(e[0].engine.box(o),s=>he(s,t))})`}return r(e,o=>he(o,t))}if(e===null)return`${r}()`;if(e.length===1&&ue(e[0])){let o=Mi();return`(${he(e[0],t)}).map((${o}) => ${r}(${he(e[0].engine.box(o),t)}))`}return`${r}(${e.map(o=>he(o,t)).join(", ")})`}function he(n,e,i=0){if(n===void 0)return"";if(!n.isValid)throw new Error("Invalid expression");let t=E(n);if(t!==null)return e.number(t);let r=n.symbol;if(r!==null)return e.var?.(r)??r;if(n.string!==null)return e.string(r);let s=n.keys;if(s!==null){let u=[];for(let l of s){let f=n.getKey(l);f&&u.push(`${l}: ${he(f,e,0)}`)}return`{${u.join(", ")}}`}let a=n.head;return typeof a=="string"?Ja(a,n.ops,i,e):""}function ed(n,e,i){if(e===null)throw new Error("Sum/Product: no arguments");if(!e[0])throw new Error("Sum/Product: no body");let[t,r,o,s]=zn(e[1]),a=n==="Sum"?"+":"*";if(!t){let d=Mi(),c=Mi();return`${he(e[0],i)}.reduce((${c}, ${d}) => ${c} ${a} ${d}, ${a==="+"?"0":"1"})`}let u=he(e[0],{...i,var:d=>d===t?t:i.var(d)}),l=Mi(),f=Mi();return`(() => {
  let ${f} = ${a==="+"?"0":"1"};
  let ${t} = ${r};
  const _fn = () => ${u};
  while (${l} <= ${o}) {
    ${f} ${a}= _fn();
    ${l}++;
  }
  return ${f};
})()`}function Mi(){return`_${Math.random().toString(36).substring(2)}`}var L=class{constructor(e,i){this.engine=e,i?.latex!==void 0&&(this._latex=i.latex)}valueOf(){return this.symbol==="True"?!0:this.symbol==="False"?!1:this.head&&typeof this.head=="string"&&["List","Set","Sequence","Tuple","Pair","Single","Triple"].includes(this.head)?this.ops?.map(e=>e.valueOf()):E(this)??this.string??this.symbol??JSON.stringify(this.json)}toString(){if(this.symbol)return this.symbol;if(this.string)return`"${this.string}"`;let e=this.numericValue;if(e!==null){if(typeof e=="number"||e instanceof v)return e.toString();if(J(e))return`(${e[0].toString()}/${e[1].toString()})`;if(K(e))return`(${e[0].toString()}/${e[1].toString()})`;if(e instanceof Wa.Complex){let i=e.im===1?"":e.im===-1?"-":e.im.toString();return e.re===0?i+"i":e.im<0?`${e.re.toString()}${i}i`:`(${e.re.toString()}+${i}i)`}}return this.head&&typeof this.head=="string"?this.head==="List"?`[${this.ops?.map(i=>i.toString())}]`:this.head==="Domain"?JSON.stringify(this.json):`${this.head}(${this.ops?.map(i=>i.toString()).join(", ")})`:JSON.stringify(this.json)}print(){this.toString()}[Symbol.toPrimitive](e){if(e==="number"){let i=this.valueOf();return typeof i=="number"?i:null}return this.toString()}toJSON(){return this.json}get rawJson(){return this.json}get scope(){return null}is(e){return e==null?!1:this.isSame(this.engine.box(e))}get canonical(){return this}get latex(){return this._latex??this.engine.serialize(this)}set latex(e){this._latex=e}get symbol(){return null}get isNothing(){return!1}get string(){return null}getSubexpressions(e){return wo(this,e)}get subexpressions(){return this.getSubexpressions("")}get symbols(){let e=new Set;return fr(this,e),Array.from(e)}get unknowns(){let e=new Set;return dr(this,e),Array.from(e)}get freeVariables(){let e=new Set;return lr(this,e),Array.from(e)}get errors(){return this.getSubexpressions("Error")}get ops(){return null}get nops(){return 0}get op1(){return this.engine.Nothing}get op2(){return this.engine.Nothing}get op3(){return this.engine.Nothing}get isValid(){return!0}get isPure(){return!1}get isExact(){return!1}get isConstant(){return!1}get isNaN(){}get isZero(){}get isNotZero(){}get isOne(){}get isNegativeOne(){}get isInfinity(){}get isFinite(){}get isEven(){}get isOdd(){}get isPrime(){}get isComposite(){}get numericValue(){return null}get sgn(){return null}get shape(){return[]}get rank(){return 0}subs(e,i){return i?.canonical?this.canonical:this}solve(e){return null}replace(e){return null}has(e){return!1}isLess(e){}isLessEqual(e){}isGreater(e){}isGreaterEqual(e){}get isPositive(){}get isNonNegative(){}get isNegative(){}get isNonPositive(){}isCompatible(e,i){return!1}get description(){if(this.baseDefinition&&this.baseDefinition.description)return typeof this.baseDefinition.description=="string"?[this.baseDefinition.description]:this.baseDefinition.description}get url(){return this.baseDefinition?.url??void 0}get wikidata(){return this.baseDefinition?.wikidata??void 0}get complexity(){}get baseDefinition(){}get symbolDefinition(){}get functionDefinition(){}infer(e){return!1}bind(){}reset(){}get keys(){return null}get keysCount(){return 0}getKey(e){}hasKey(e){return!1}get value(){return this.N().valueOf()}set value(e){throw new Error(`Can't change the value of \\(${this.latex}\\)`)}get domain(){}set domain(e){throw new Error(`Can't change the domain of \\(${this.latex}\\)`)}get isNumber(){}get isInteger(){}get isRational(){}get isAlgebraic(){return!1}get isReal(){}get isExtendedReal(){}get isComplex(){}get isImaginary(){}get isExtendedComplex(){}simplify(e){return this}evaluate(e){return this.simplify()}N(e){return this.evaluate({numericMode:!0})}compile(e="javascript",i){if(e!=="javascript")return;i??(i={optimize:["simplify"]});let t=this;return i.optimize.includes("simplify")&&(t=t.simplify()),i.optimize.includes("evaluate")&&(t=t.evaluate()),Ha(t)}};function lr(n,e){if(n.head,n.symbol){let i=n.engine.lookupSymbol(n.symbol);if(i&&i.value!==void 0)return;let t=n.engine.lookupFunction(n.symbol);if(t&&(t.signature.evaluate||t.signature.N))return;e.add(n.symbol);return}if(n.head&&typeof n.head!="string"&&lr(n.head,e),n.ops)for(let i of n.ops)lr(i,e);if(n.keys)for(let i of n.keys)lr(n.getKey(i),e)}function fr(n,e){if(n.symbol){e.add(n.symbol);return}if(n.head&&typeof n.head!="string"&&fr(n.head,e),n.ops)for(let i of n.ops)fr(i,e);if(n.keys)for(let i of n.keys)fr(n.getKey(i),e)}function dr(n,e){if(n.symbol){let i=n.symbol;if(i==="Unknown"||i==="Undefined"||i==="Nothing")return;let t=n.engine.lookupSymbol(i);if(t&&t.value!==void 0)return;let r=n.engine.lookupFunction(i);if(r&&(r.signature.evaluate||r.signature.N))return;e.add(i);return}if(n.head&&typeof n.head!="string"&&dr(n.head,e),n.ops)for(let i of n.ops)dr(i,e);if(n.keys)for(let i of n.keys)dr(n.getKey(i),e)}function wo(n,e){let i=!e||n.head===e?[n]:[];if(n.ops)for(let t of n.ops)i.push(...wo(t,e));else if(n.keys)for(let t of n.keys)i.push(...wo(n.getKey(t),e));return i}var Dn=class n extends L{constructor(e,i,t){if(i instanceof n,super(e,t),typeof i=="string"){if(!ri(i))throw Error(`Unknown domain literal "${i}"`);this.base=i,this.ctor=null,this.params=[];return}if(!Array.isArray(i))throw Error("Expected a domain expression");if(!ki.includes(i[0]))throw Error(`Unknown domain constructor "${i[0]}`);let r=i[0];if(this.ctor=r,r==="OptArg"||r==="VarArg")throw Error(`Unexpected domain constructor "${r}" outside of FunctionOf`);if(this.params=i.slice(1).map(o=>o instanceof L?o.json:o),r==="FunctionOf"&&(this.base="Functions",e.strict&&at(this)),r==="DictionaryOf"&&(this.base="Dictionaries"),r==="ListOf"&&(this.base="Lists"),r==="TupleOf"&&(this.base="Tuples"),r==="Covariant"||r==="Contravariant"||r==="Bivariant"||r==="Invariant"){let o=e.domain(i[1]);if(this.ctor=r,this.base=o.base,this.params=[o.json],i.length!==2)throw Error(`Invalid "${r}" in domain "${i}"`)}if(r==="Union"||r==="Intersection"){let o;if(r==="Union")for(let s of this.params)o=Un(o,e.domain(s));else for(let s of this.params)o=mt(o,e.domain(s));this.base=o.base}}get isCanonical(){return!0}get canonical(){return this}get isValid(){return!0}get json(){return this.ctor?[this.ctor,...this.params]:this.base}get hash(){return this._hash===void 0&&(this._hash=xe(JSON.stringify(this.json))),this._hash}isCompatible(e,i="covariant"){let t=this.json,r=e instanceof n?e.json:e,o=Array.isArray(r)?r[0]:null;if(o){let s=r[1];if(o==="Covariant")return ve(t,s);if(o==="Contravariant")return ve(s,t);if(o==="Invariant")return!ve(s,t)&&!ve(t,s);if(o==="Bivariant")return ve(t,s)&&ve(s,t)}return i==="covariant"?ve(t,r):i==="contravariant"?ve(r,t):i==="bivariant"?ve(r,t)&&ve(t,r):!ve(r,t)&&!ve(t,r)}isEqual(e){return e instanceof n?this===e?!0:this.isCompatible(e,"invariant"):!1}isSame(e){return this.isEqual(e)}match(e,i){return e instanceof n&&this.isCompatible(e,"invariant")?{}:null}get head(){return"Domain"}get domain(){return this.engine.domain("Domains")}get isFunction(){return this.base==="Functions"}get isNumeric(){return this.isCompatible(this.engine.domain("Numbers"))}};function mn(n){if(n instanceof Dn)return!0;if(n instanceof L&&(n=n.json),typeof n=="string")return ri(n);if(!Array.isArray(n)||n.length<=1)return!1;let e=n[0];return typeof e!="string"||!ki.includes(e)?!1:e==="ListOf"||e==="OptArg"||e==="VarArg"?n.length===2&&mn(n[1]):e==="FunctionOf"||e==="TupleOf"||e==="Intersection"||e==="Union"?n.slice(1).every(mn):n.every(i=>i!==null)}function ve(n,e){let[i,t]=cr([n],e);return!!(i&&t.length===0)}function cr(n,e){let i=n.shift(),t=typeof e=="string"?e:null;if(t==="Anything")return[!0,n];let r=typeof i=="string"?i:null;if(r&&t)return r===t?[!0,n]:[He(r).includes(t),n];if(t){let s=i[0];return s==="FunctionOf"?[t==="Functions",n]:s==="DictionaryOf"?[t==="Dictionaries",n]:s==="ListOf"?[t==="Lists",n]:s==="TupleOf"?[t==="Tuples",n]:[!0,n]}let o=e[0];if(o==="FunctionOf"){if(r==="Functions")return[!0,n];if(r)return[!1,n];if(i[0]!=="FunctionOf")return[!1,n];if(i.length===1&&e.length===1)return[!0,n];if(!ve(i[i.length-1],e[e.length-1]))return[!1,n];let s=i.slice(1,-1),a=e.slice(1,-1);for(let u=0;u<=s.length-1;u++){if(a.length===0)return(Array.isArray(s[u])?s[u][0]:null)!=="OptArg"?[!1,n]:[!0,n];{let l=!1;if([l,a]=cr(a,s[u]),!l)return[!1,n]}}return[a.length===0,n]}if(o==="Intersection")return[e.slice(1,-1).every(s=>ve(i,s)),n];if(o==="Union")return[e.slice(1,-1).some(s=>ve(i,s)),n];if(o==="OptArg")return r==="NothingDomain"?[!0,n]:cr([i,...n],e[1]);if(o==="VarArg"){let s=e[1];if(!ve(i,s))return[!1,n];i=n.shift();let a=!0;for(;n.length>0&&a;)[a,n]=cr(n,s),i=n.shift();return[!0,n]}if(o==="TupleOf"){if(!Array.isArray(i)||i[0]!=="TupleOf")return[!1,n];if(i.length>e.length)return[!1,n];for(let s=1;s<=e.length-1;s++)if(!i[s]||!ve(i[s],e[s]))return[!1,n];return[!0,n]}return console.error("Unexpected domain constructor "+o),[!1,n]}function Un(n,e){if(n==null)return e;if(e==null)return n;let i=[n.base,...He(n.base)],t=[e.base,...He(e.base)];for(;!t.includes(i[0]);)i.shift();return n.engine.domain(i[0])}function mt(n,e){return n===void 0?e:e===void 0||ve(n.base,e.base)?n:ve(e.base,n.base)?e:n.engine.Void}var Mo=pe(ce(),1);function ht(n){if(n.head==="Power"&&n.op2.numericValue!==null){let e=q(n.op2);return e!==null&&e>0?e:1}if(n.head==="Multiply"){let e=1;for(let i of n.ops){let t=ht(i);t>1&&(e=e+t)}return e}return 1}function Co(n){if(n.head==="Power"&&n.op2.numericValue!==null){let e=q(n.op2);return e!==null&&e>0?e:1}if(n.head==="Multiply"){let e=1;for(let i of n.ops)e=Math.max(e,ht(i));return e}return 1}function pt(n){return n.symbol?n.symbol:n.ops?(typeof n.head=="string"?n.head:pt(n.head))+'"'+n.ops.map(i=>pt(i)).filter(i=>i.length>0).join('"'):""}var pn=1e5;function Ao(n){return n.sort((e,i)=>{let t=pt(e),r=pt(i);if(!t&&!r)return tn(e,i);if(!t)return 1;if(!r||t<r)return-1;if(t>r)return 1;let o=ht(e),s=ht(i);if(o!==s)return s-o;let a=Co(e),u=Co(i);return a!==u?a-u:tn(e,i)})}function tn(n,e){if(n===e||n.numericValue!==null&&n.numericValue===e.numericValue)return 0;let i=E(n);if(i!==null){let t=E(e);return t!==null?i-t:-1}if(n.numericValue instanceof Mo.Complex)return e.numericValue instanceof Mo.Complex?n.numericValue.re===e.numericValue.re?Math.abs(n.numericValue.im)===Math.abs(e.numericValue.im)?n.numericValue.im-e.numericValue.im:Math.abs(n.numericValue.im)-Math.abs(e.numericValue.im):n.numericValue.re-e.numericValue.re:e.numericValue!==null?1:-1;if(n.numericValue)return e.numericValue?1:-1;if(n.head==="Sqrt"&&n.op1.numericValue)return e.head==="Sqrt"&&e.op1.numericValue?tn(n.op1,e.op1):-1;if(n.symbol)return e.symbol?n.symbol===e.symbol?0:n.symbol>e.symbol?1:-1:e.numericValue!==null?1:-1;if(n.ops){if(e.ops){let t=n.functionDefinition?.complexity??pn,r=e.functionDefinition?.complexity??pn;return t===r?typeof n.head=="string"&&typeof e.head=="string"?n.head===e.head?Ai(n)-Ai(e):n.head<e.head?1:-1:Ai(n)-Ai(e):t-r}return e.numericValue!==null||e.symbol?1:-1}if(n.string)return e.string?n.string.length!==e.string.length?e.string.length-n.string.length:e.string<n.string?-1:n.string>e.string?1:0:e.keys?-1:1;if(n.keys&&e.keys){if(n.keysCount!==e.keysCount)return e.keysCount-n.keysCount;let t=0,r=0;for(let o of e.keys)t+=e.getKey(o).complexity??pn;for(let o of n.keys)r+=n.getKey(o).complexity??pn;return r-t}return(n.complexity??pn)-(e.complexity??pn)}function Oo(n,{recursive:e=!1}){if(n.ops){let i=n.ops;e&&(i=i.map(r=>Oo(r,{recursive:e})));let t=n.engine;return n.head==="Add"?i=Ao(i):(n.head==="Multiply"||(t.lookupFunction(n.head)?.commutative??!1))&&(i=i.sort(tn)),n.engine._fn(n.head,i)}return n}function Ai(n){return n.keys!==null?1+n.keysCount:n.ops?(typeof n.head=="string"?1:Ai(n.head))+[...n.ops].reduce((e,i)=>e+Ai(i),0):1}var Ka=pe(ce(),1);var Oi=pe(ce(),1);function Je(n){n.isCanonical;let e=n.engine;if(n.head==="Multiply"){let r=[],o=[1,1];for(let s of n.ops){let a=W(s);a?o=Q(o,a):r.push(s)}return ie(o)?[o,n]:[o,e.mul(...r)]}if(n.head==="Divide"){let[r,o]=Je(n.op1),[s,a]=Je(n.op2),u=Q(r,Tn(s));return a.isOne?[u,o]:ie(u)?[u,n]:[u,e.div(o,a)]}if(n.head==="Power"){if(n.op2.numericValue===null)return[[1,1],n];let[r,o]=Je(n.op1);if(ie(r))return[r,n];let s=E(n.op2);return typeof s=="number"&&Number.isInteger(s)?[ir(r,s),e.pow(o,n.op2)]:[[1,1],n]}if(n.head==="Sqrt"){let[r,o]=Je(n.op1),s=Ra(r);return s?[s,e.sqrt(o)]:[[1,1],n]}if(n.head,n.head==="Negate"){let[r,o]=Je(n.op1);return[_e(r),o]}let i=n.numericValue;if(i instanceof Oi.default&&i.re<0)return[[-1,1],e.number(e.complex(-i.re,-i.im))];let t=W(n);return t?[t,e.One]:[[1,1],n]}function Qa(n,e){if(ie(e))return n;if(Ze(e))return 0;if(n===null)return null;if(Bi(e))return typeof n=="number"?-n:n instanceof Ue||n instanceof Oi.default?n.neg():_e(n);if(U(n))return Q(n,e);if(K(e)){let[i,t]=e;if(typeof n=="number")return Number.isInteger(n)?[BigInt(n)*i,BigInt(n)*t]:new Ue(n).mul(i.toString()).div(t.toString());if(n instanceof Ue){let[r,o]=[new Ue(i.toString()),new Ue(t.toString())];return n.isInteger()?t===BigInt(1)?n.mul(r):[BigInt(n.mul(r).toString()),t]:n.mul(r).div(o)}if(n instanceof Oi.default)return n.mul(Number(i)).div(Number(t))}else{let[i,t]=e;if(typeof n=="number")return Number.isInteger(n)?[n*i,t]:n*i/t;if(n instanceof Ue)return n.isInteger()?[BigInt(n.mul(i).toString()),BigInt(t)]:n.mul(i).div(t);if(n instanceof Oi.default)return n.mul(i).div(t)}return null}function oi(n){let e=n.engine,i=n.head;if(Ki(i))return e.function(i,[oi(n.ops[0]),oi(n.ops[1])]);if(i==="Divide")return e.div(n.ops[0],n.ops[1]);if(i==="Add"){let[t,r]=n.ops.reduce((o,s)=>(s.head==="Divide"?(o[0].push(s.ops[0]),o[1].push(s.ops[1])):o[0].push(s),o),[[],[]]);return e.div(e.add(...t),e.add(...r))}return i==="Negate"?e.neg(oi(n.ops[0])):n}function Ya(n,e){let i=[],t=n.engine;for(let o of n.factors){let s=e.find(o.factor);if(s!==-1)if(o.exponent.isSame(e.factors[s].exponent))i.push(o);else{let a=E(o.exponent),u=E(e.factors[s].exponent);if(a!==null&&u!==null){if(a>0&&u>0){let l=Math.min(a,u);i.push({factor:o.factor,exponent:t.number(l)})}else if(a<0&&u<0){let l=Math.max(a,u);i.push({factor:o.factor,exponent:t.number(l)})}}}}let r=n.integerCoefficient();if(r!==null){let o=e.integerCoefficient();o!==null&&i.push({factor:t.number(Sn(r,o)),exponent:t.One})}return i.length===0?t.One:t.mul(...i.map(o=>t.pow(o.factor,o.exponent)))}function Xa(n){let e=n.head;if(Ki(e)){let t=new Gn(n.op1),r=new Gn(n.op2);t.reduceExactNumbers(),r.reduceExactNumbers();let o=Ya(t,r);return o.isOne||(t.div(o),r.div(o)),n.engine.function(e,[t.asExpression(),r.asExpression()])}if(e==="Add"){let t=null;for(let r of n.ops)if(!t)t=new Gn(r),t.reduceExactNumbers();else{let o=new Gn(r);o.reduceExactNumbers(),t=new Gn(Ya(t,o)),t.reduceExactNumbers()}return t?.asExpression()??n.engine.One}let i=new Gn(oi(n));return i.reduceExactNumbers(),i.asExpression()}var Gn=class{constructor(e){this.factors=[];this.hasNaN=!1;this.hasZero=!1;this.hasInfinity=!1;this.sign=1;this.engine=e.engine,this.mul(oi(e))}div(e){if(!e.isOne){if(e.isNegativeOne){this.sign*=-1;return}this.mul(e,this.engine.NegativeOne)}}mul(e,i){if(i??(i=e.engine.One),e.head==="Negate"&&(this.sign*=-1,e=e.ops[0]),e.head==="Divide"){this.mul(e.ops[0],i),this.mul(e.ops[1],this.engine.neg(i));return}if(e.head==="Multiply"){for(let r of e.ops)this.mul(r,i);return}if(e.head==="Power"){this.mul(e.ops[0],this.engine.mul(e.ops[1],i));return}if(e.head==="Sqrt"){this.mul(e.ops[0],this.engine.mul(this.engine.Half,i));return}if(e.isNegative&&(this.sign*=-1,e=this.engine.neg(e)),i.isZero||e.isOne)return;if(e.isNaN){this.hasNaN=!0;return}if(e.isZero){i.isNonNegative?this.hasZero=!0:this.hasNaN=!0;return}if(e.isInfinity&&i.isNonNegative){i.isNonNegative?this.hasInfinity=!0:this.hasNaN=!0;return}let t=this.find(e);t===-1?this.factors.push({factor:e,exponent:i}):this.factors[t].exponent=this.engine.add(this.factors[t].exponent,i)}find(e){return this.factors.findIndex(i=>i.factor.isSame(e))}has(e){return this.find(e)!==-1}reduceNumbers(){let e=this.factors;this.factors=[];let i=this.engine,t=i.One;for(let r of e){let o=r.factor.N();o.numericValue!==null?t=i.mul(t,i.pow(o,r.exponent)):this.factors.push(r)}t.isOne||this.factors.push({factor:t,exponent:i.One})}reduceExactNumbers(){let e=this.engine;for(let l of this.factors){let f=l.factor;if(f.numericValue!==null&&!f.isExact)return this.reduceNumbers()}let i=this.factors;this.factors=[];let t=[1,1],r=1,o=0,s=[1,1];for(let l of i){let f=E(l.exponent);if(f===null){this.factors.push(l);continue}if(Number.isInteger(2*f)){let m=W(l.factor);if(m){s=Q(s,ir(m,2*f));continue}}let d=W(l.factor);if(d){t=Q(t,ir(d,f));continue}let c=l.factor.numericValue;if(c!==null&&c instanceof Oi.default&&Number.isInteger(c.re)&&Number.isInteger(c.im)&&Number.isInteger(f)){c=c.pow(f),t=Q(t,[c.re,1]),c.im!==0&&(r*=c.im,o+=f);continue}this.factors.push(l)}let[a,u]=qa(s);t=Q(t,a),o!==0&&(o%2===0?t=Q(t,[r,1]):Pa(t)?(this.factors.push({factor:e.number(e.complex(Oe(t),r)),exponent:e.One}),t=[1,1]):this.factors.push({factor:e.number(e.complex(0,r)),exponent:e.One})),ie(t)||this.factors.push({factor:e.number(t),exponent:e.One}),ie(u)||this.factors.push({factor:e.sqrt(e.number(u)),exponent:e.One})}integerCoefficient(){let e=null;for(let i of this.factors){let t=E(i.factor);if(t!==null&&Number.isInteger(t)){let r=E(i.exponent);r!==null&&(e=(e??1)*Math.pow(t,r));continue}}return e}asExpression(){let e=this.engine;if(this.factors.length===0)return e.One;if(this.hasNaN)return e.NaN;if(this.hasInfinity)return this.sign>0?e.PositiveInfinity:e.NegativeInfinity;if(this.hasZero)return e.Zero;if(this.factors.length===1){let{factor:o,exponent:s}=this.factors[0];return e.pow(o,s)}let i=this.factors.filter(o=>o.exponent.isPositive&&!o.factor.isOne).map(o=>e.pow(o.factor,o.exponent)),t;i.length===0?t=this.sign>0?e.One:e.NegativeOne:i.length===1?this.sign<0?t=e.neg(i[0]):t=i[0]:(t=e._fn("Multiply",i),this.sign<0&&(t=e.neg(t)));let r=this.factors.filter(o=>o.exponent.isNegative&&!o.factor.isOne).map(o=>e.pow(o.factor,e.neg(o.exponent)));return r.length===0?t:r.length===1?e.div(t,r[0]):e.div(t,e._fn("Multiply",r))}};var gt=class{constructor(e,i){this.terms=[];this.engine=e;for(let t of i)this.add(t)}sub(e){this.add(e,[-1,1])}add(e,i){i??(i=[1,1]);let[t,r]=Je(e);if(t=Q(t,i),Ze(t))return;if(r.head==="Add"){for(let s of r.ops)this.add(s,t);return}if(r.head==="Negate"){this.add(r.op1,_e(t));return}let o=this.find(r);if(o>=0){this.terms[o].coef=st(this.terms[o].coef,t);return}this.terms.push({coef:t,term:r})}find(e){return this.terms.findIndex(i=>i.term.isSame(e))}reduceNumbers({exact:e}={exact:!0}){let i=this.engine,t=this.terms;this.terms=[];let r=0,o=0,s=0,a=0,u=[0,1],l=i._BIGNUM_ZERO;for(let{coef:f,term:d}of t){if(d.isNaN){this.terms=[{term:i.NaN,coef:[1,1]}];return}if(d.isFinite===!1){d.isPositive?r++:o++;continue}if(d.numericValue!==null){let c=Qa(d.numericValue,f);if(c!==null){U(c)?u=st(u,c):c instanceof Ue?l=l.add(c):c instanceof Ka.default?(F(i)?l=l.add(c.re):s+=c.re,a+=c.im):F(i)?l=l.add(c):s+=c;continue}}this.terms.push({coef:f,term:d})}if(r>0&&o>0){this.terms=[{term:i.NaN,coef:[1,1]}];return}if(r>0){this.terms=[{term:i.PositiveInfinity,coef:[1,1]}];return}if(o>0){this.terms=[{term:i.NegativeInfinity,coef:[1,1]}];return}if(!e||!Number.isInteger(s)||!l.isInteger()||!Number.isInteger(a)){if(!l.isZero()&&F(i)){l=l.add(s),l=l.add(i.bignum(u[0]).div(i.bignum(u[1]))),this.terms.push({term:i.number(l),coef:[1,1]}),a!==0&&this.terms.push({term:i.number(i.complex(0,a)),coef:[1,1]});return}let f=s+l.toNumber()+Number(u[0])/Number(u[1]);a!==0?this.terms.push({term:i.number(i.complex(f,a)),coef:[1,1]}):f!==0&&this.terms.push({term:i.number(f),coef:[1,1]});return}l.isZero()||(l=l.add(s),s=0,Ze(u)||(l=l.add(i.bignum(u[0]).div(i.bignum(u[1]))),u=[0,1]),this.terms.push({coef:[1,1],term:i.number(l)})),a!==0?(Ze(u)||(s+=Number(u[0])/Number(u[1])),this.terms.push({coef:[1,1],term:i.number(i.complex(s,a))})):s!==0&&this.terms.push({coef:[1,1],term:i.number(s)}),Ze(u)||this.terms.push({coef:[1,1],term:i.number(u)})}asExpression(){let e=this.engine,i=this.terms.filter(({coef:t,term:r})=>!Ze(t)&&!r.isZero);if(i.length===0)return e.Zero;if(i.length===1){let{coef:t,term:r}=i[0];return ie(t)?r:Bi(t)?e.neg(r):e.mul(e.number(t),r)}return e.function("Add",i.map(({coef:t,term:r})=>e.mul(e.number(t),r)))}};function In(n,e){if(e.every(i=>i.isCanonical),e=e.filter(i=>i.numericValue===null||!i.isZero),e.length===0)return n.Zero;if(e.length===1&&!sr(e[0]))return e[0];if(e.length===2){let i=0,t=E(e[0]);if(t!==null&&t!==0?i=mr(e[1]):(i=mr(e[0]),i!==0&&e[1].numericValue!==null&&(t=E(e[1]))),t!==null&&i!==null&&i!==0)return n.number(n.complex(t,i))}return e.length===1?e[0]:n._fn("Add",Ao(e))}function nu(n,e){let i=null;for(let t of e){if(!t?.isNumeric)return null;i=Un(i,t)}return i}function pr(n,e){let i=new gt(n,[]);for(let t of e){if(t=t.simplify(),t.isImaginary&&t.isInfinity)return n.ComplexInfinity;if(t.isNaN||t.symbol==="Undefined")return n.NaN;i.add(t)}return i.reduceNumbers({exact:!0}),i.asExpression()}function nd(n){let e=0;for(let i of n){let t=i.numericValue;if(typeof t=="number")e+=t;else return null}return e}function xt(n,e,i="evaluate"){if(i==="N"&&n.numericMode==="machine"){e=e.map(o=>o.N());let r=nd(e);if(r!==null)return n.number(r)}for(let r of e){if(r.isImaginary&&r.isInfinity)return n.ComplexInfinity;if(r.isNaN||r.symbol==="Undefined")return n.NaN;r.numericValue!==null&&!r.isExact&&(i="N")}i==="N"?e=e.map(r=>r.N()):e=e.map(r=>r.evaluate());let t=new gt(n,e);return i==="N"?t.reduceNumbers():t.reduceNumbers({exact:!0}),t.asExpression()}function iu(n,e,i){n.pushScope(),e??(e=n.error("missing"));var t=void 0;if(i&&i.ops&&i.ops[0]?.head==="Delimiter"){var r=ur(i);if(!r)return null;var o=[e.canonical];r.forEach(a=>{o.push(a)}),t=n._fn("Sum",o)}else{var s=$n(i);t=s?n._fn("Sum",[e.canonical,s]):n._fn("Sum",[e.canonical])}return n.popScope(),t}function hr(n,e,i){let t=e[0],r=[];if(e){r=[];for(let m=1;m<e.length;m++)r.push(e[m])}let o=null;if(r?.length===0){let m=i==="simplify"?t.simplify():t.evaluate({numericMode:i==="N"});if(F(n)){let g=n.bignum(0);for(let h of X(m)){let x=Ge(h);if(x===null){o=void 0;break}if(x.isFinite()===!1){g=x;break}g=g.add(x)}o===null&&(o=n.number(g))}else{let g=0;for(let h of X(m)){let x=E(h);if(x===null){o=void 0;break}if(x===null||!Number.isFinite(x)){g=x;break}g+=x}o===null&&(o=n.number(g))}return o??void 0}var s=[];let a=[],u=[],l=[];r.forEach(m=>{let[g,h,x,S]=zn(m.evaluate());g&&(s.push(g),a.push(h),u.push(x),l.push(S))});let f=t,d=n.swapScope(f.scope);n.pushScope(),f.bind();for(let m=0;m<s.length;m++){let g=s[m],h=a[m],x=u[m],S=l[m];if(h>=x||i==="simplify"&&x-h>=rt)return;if(i==="evaluate"&&x-h>=rt&&(i="N"),i==="simplify"){let T=[];for(let _=h;_<=x;_++)n.assign(g,_),T.push(f.simplify());o=n.add(...T).simplify()}}let c=[];if(s.length>1)for(let m=0;m<s.length-1;m++)c.length===0?c=Ci(cn(a[m],u[m]),cn(a[m+1],u[m+1])):c=Ci(c.map(g=>g[0]),cn(a[m+1],u[m+1]));else c=cn(a[0],u[0]).map(m=>[m]);if(i==="evaluate"){let m=[];for(let g of c){let h=s.map((x,S)=>(n.assign(x,g[S]),x));m.push(f.evaluate())}o=n.add(...m).evaluate()}for(let m=0;m<s.length;m++)n.assign(s[m],void 0);if(i==="N")for(let m=0;m<s.length;m++){let g=s[m],h=a[m],x=u[m],S=l[m];if(o===null&&S)if(F(n)){let T=n.bignum(0);for(let _=h;_<=x;_++){n.assign(g,_);let w=Ge(f.N());if(w===null){o=void 0;break}if(w.isFinite()===!1){T=w;break}T=T.add(w)}o===null&&(o=n.number(T))}else{let T=n.numericMode,_=n.precision;n.numericMode="machine";let w=0;for(let j=h;j<=x;j++){n.assign(g,j);let Z=E(f.N());if(Z===null){o=void 0;break}if(!Number.isFinite(Z)){w=Z;break}w+=Z}n.numericMode=T,n.precision=_,o===null&&(o=n.number(w))}else if(o===null){n.assign(g,1e3);let T=f.N();n.assign(g,999);let _=f.N(),w=E(n.div(T,_).N());if(w!==null&&Number.isFinite(w)&&Math.abs(w)>1)o=n.PositiveInfinity;else{let j=0,Z=n.numericMode,De=n.precision;n.numericMode="machine";for(let $e=h;$e<=x;$e++){n.assign(g,$e);let Ce=E(f.N());if(Ce===null){o=void 0;break}if(Math.abs(Ce)<Number.EPSILON||!Number.isFinite(Ce))break;j+=Ce}n.numericMode=Z,n.precision=De,o===null&&(o=n.number(j))}}}return n.popScope(),n.swapScope(d),o??void 0}function mr(n){if(n.symbol==="ImaginaryUnit")return 1;let e=n.numericValue;if(e!==null&&e instanceof eu.default&&e.re===0)return e.im;if(n.head==="Negate")return-mr(n.op1);if(n.head==="Multiply"&&n.nops===2){if(n.op1.symbol==="ImaginaryUnit")return E(n.op2)??0;if(n.op2.symbol==="ImaginaryUnit")return E(n.op1)??0}if(n.head==="Divide"){let i=mr(n.op1),t=E(n.op2);return t===null?0:i/t}return 0}var tu=pe(ce(),1);function ru(n){let e=n.numericValue;return e===null?null:(typeof e=="number"?e=-e:e instanceof v||e instanceof tu.Complex?e=e.neg():Array.isArray(e)&&(e=_e(e)),n.engine.number(e))}function bt(n){let e=-1;for(;n.head==="Negate";)n=n.op1,e=-e;if(e===1)return n;if(n.numericValue!==null)return ru(n);let i=n.engine;if(n.head==="Subtract")return i.add(n.op2,bt(n.op1));if(n.head==="Add"){let t=n.ops.map(r=>bt(r));return i.add(...t)}return n.head==="Multiply"?id(i,n.ops):n.head==="Divide"?i.div(bt(n.op1),n.op2):i._fn("Negate",[n])}function ge(n){let e=-1;for(;n.head==="Negate";)n=n.op1,e=-e;if(e===1)return n;let i=n.engine;if(n.head==="Add"){let t=n.ops.map(r=>ge(r));return In(i,te(se(t),"Add"))}return n.numericValue!==null?ru(n):i._fn("Negate",[n])}function id(n,e){let i=[],t=!1;for(let r of e)!t&&r.head==="Negate"?(t=!0,i.push(r.op1)):i.push(r);if(t)return n.mul(...i);i=[];for(let r of e)t||r.numericValue===null||!r.isInteger?i.push(r):(t=!0,i.push(ge(r)));if(t)return n.mul(...i);i=[];for(let r of e)t||r.numericValue===null||!r.isNumber?i.push(r):(t=!0,i.push(ge(r)));return t?n.mul(...i):n._fn("Negate",[n._fn("Multiply",e)])}function gr(n,e,i="simplify"){return ge(e)}function hn(n,e){if(n.head==="Negate"&&e.head==="Negate")return hn(n.op1,e.op1);if(n.head==="Negate")return ge(hn(n.op1,e));if(e.head==="Negate")return ge(hn(n,e.op1));let i=n.engine;if(n.head==="Divide"&&e.head==="Divide"){let t=i.mul(n.op2,e.op2);return i.div(hn(n.op1,e.op1),t)}return n.head==="Divide"?i.div(hn(n.op1,e),n.op2):e.head==="Divide"?i.div(hn(n,e.op1),e.op2):n.head==="Add"?i.add(...n.ops.map(t=>hn(t,e))):e.head==="Add"?i.add(...e.ops.map(t=>hn(n,t))):i.mul(n,e)}function Pi(n){return n.length===1?n[0]:n.length===2?hn(n[0],n[1]):hn(n[0],Pi(n.slice(1)))}var yt=[[1],[1,1],[1,2,1],[1,3,3,1],[1,4,6,4,1],[1,5,10,10,5,1],[1,6,15,20,15,6,1],[1,7,21,35,35,21,7,1],[1,8,28,56,70,56,28,8,1]];function td(n,e){for(;n>=yt.length;){let i=yt.length,t=[1],r=yt[i-1];for(let o=1;o<i;o++)t[o]=r[o-1]+r[o];t[i]=1,yt.push(t)}return yt[n][e]}function rd(n){let e=n.reduce((t,r)=>t+r,0),i=1;for(let t=0;t<n.length;t+=1)i*=td(e,n[t]),e-=n[t];return i}function*ou(n,e){if(n===1){yield[e];return}for(let i=0;i<=e;i+=1)for(let t of ou(n-1,e-i))yield[i,...t]}function su(n){if(n.head!=="Power")return null;let e=q(n.op2);if(e===null||e<0)return null;if(e===0)return n.engine.One;if(e===1)return rn(n.op1);let i=n.engine;if(n.op1.head==="Negate"){let s=e%2===0?1:-1,a=su(i._fn("Power",[n.op1.op1,n.op2]));return a===null?null:s>0?a:i.neg(a)}if(n.op1.head,n.op1.head!=="Add")return null;let t=n.op1.ops,r=ou(t.length,e),o=[];for(let s of r){let a=[i.number(rd(s))];for(let u=0;u<s.length;u+=1)s[u]!==0&&(s[u]===1?a.push(t[u]):a.push(i.pow(t[u],s[u])));o.push(i.mul(...a))}return i.add(...o)}function Po(n){if(n.head&&n.ops){let e=n.ops.map(t=>Po(t)??t),i=n.engine.box([n.head,...e]);return rn(i)??i}return null}function od(n){if(n.head!=="Divide")return null;let e=rn(n.op1);if(e===null)return null;let i=n.engine;return e.head==="Add"?i.add(...e.ops.map(t=>i.div(t,n.op2))):n.engine.div(e,n.op2)}function rn(n){if(!n)return null;let e=od(n);if(e!==null||n.head==="Multiply"&&(e=Pi(n.ops),e!==null))return e;if(n.head==="Add"){let i=n.ops.map(t=>rn(t)??t);return pr(n.engine,i)}return n.head==="Negate"&&(e=rn(n.op1),e!==null)?n.engine.neg(e):n.head==="Power"&&(e=su(n),e!==null)?e:null}var sd=[{match:["Multiply","_x","__a"],replace:0,id:"ax",condition:({__a:n})=>!n.has("_x")},{match:["Add",["Divide","_a","_x"],"__b"],replace:1/0,condition:({_a:n,__b:e})=>!n.has("_x")&&!e.has("_x")},{match:["Add",["Multiply","_x","__a"],"__b"],replace:["Divide",["Negate","__b"],"__a"],condition:({__a:n,__b:e})=>!n.has("_x")&&!e.has("_x")},{match:["Add",["Multiply","_a",["Power","_x","_n"]],"__b"],replace:["Divide",["Power",["Negate","__b"],["Divide",1,"_n"]],"_a"],condition:({_a:n,__b:e,_n:i})=>!n.has("_x")&&!e.has("_x")&&!i.isZero},{match:["Add",["Multiply","__a",["Power","_x",2]],["Multiply","__b","_x"],"__c"],replace:["Divide",["Add",["Negate","__b"],["Sqrt",["Subtract",["Square","__b"],["Multiply",4,"__a","__c"]]]],["Multiply",2,"__a"]],condition:({__a:n,__b:e,__c:i})=>!n.has("_x")&&!e.has("_x")&&!i.has("_x")},{match:["Add",["Multiply","__a",["Power","_x",2]],["Multiply","__b","_x"],"__c"],replace:["Divide",["Subtract",["Negate","__b"],["Sqrt",["Subtract",["Square","__b"],["Multiply",4,"__a","__c"]]]],["Multiply",2,"__a"]],condition:({__a:n,__b:e,__c:i})=>!n.has("_x")&&!e.has("_x")&&!i.has("_x")},{match:["Add",["Multiply","__a",["Exp",["Multiply","__b","_x"]]],"__c"],replace:["Divide",["Ln",["Negate",["Divide","__c","__a"]]],"__b"],condition:({__a:n,__c:e},i)=>((!n.isZero&&i.div(e,n).isNegative)??!1)&&!n.has("_x")&&!e.has("_x")},{match:["Add",["Multiply","__a",["Exp","_x"]],"__c"],replace:["Ln",["Negate",["Divide","__c","__a"]]],condition:({__a:n,__c:e},i)=>((!n.isZero&&i.div(e,n).isNegative)??!1)&&!n.has("_x")&&!e.has("_x")}];function xr(n,e){let i=n.engine;n.head==="Equal"&&(n=i.add(n.op1.canonical,i.neg(n.op2.canonical)).simplify());let t=i.cache("univariate-roots-rules",()=>ti(i,sd)),r=[n.subs({[e]:"_x"},{canonical:!1})],o=r.flatMap(s=>ft(s,t,{_x:i.symbol("_x")}));return o.length===0&&(r=r.flatMap(s=>au(s)),o=r.flatMap(s=>ft(s,t,{_x:i.symbol(e)}))),o.length===0&&(r=r.flatMap(s=>rn(s.canonical)).filter(s=>s!==null),r=r.flatMap(s=>au(s)),o=r.flatMap(s=>ft(s,t,{_x:i.symbol(e)}))),o.map(s=>s.evaluate().simplify())}var ad=[{match:["Add",["Abs",["Add",["Multiply","__a","_x"],"__b"]],"__c"],replace:["Add",["Multiply","__a","_x"],"__b","__c"]},{match:["Add",["Abs",["Add",["Multiply","__a","_x"],"__b"]],"__c"],replace:["Add",["Negate",["Multiply","__a","_x"]],["Negate","__b"],"__c"]},{match:["Multiply","__a",["Power","_b","_n"]],replace:"_b",condition:({__a:n,_b:e,_n:i})=>!n.has("_x")&&e.has("_x")&&!i.isZero&&!i.has("_x")},{match:["Multiply","__a",["Sqrt","_b"]],replace:["Multiply",["Square","_a"],"__b"],condition:({_b:n})=>n.has("_x")},{match:["Divide","_a","_b"],replace:"_a",condition:({_a:n,_b:e})=>n.has("_x")&&!e.isZero},{match:["Multiply","__a","_b"],replace:"_b",condition:({__a:n,_b:e})=>!n.has("_x")&&e.has("_x")},{match:["Add",["Ln","_a"],["Ln","_b"],"__c"],replace:["Add",["Ln",["Multiply","_a","_b"]],"__c"]},{match:["Multiply",["Exp","__a"],["Exp","__b"],"__c"],replace:["Multiply",["Exp",["Add","_a","_b"]],"__c"]},{match:["Ln","_a"],replace:["Subtract","_a",1],condition:({_a:n})=>n.has("_x")},{match:["Sin","_a"],replace:"_a",condition:({_a:n})=>n.has("_x")},{match:["Cos","_a"],replace:["Subtract","_a",["Divide","Pi",2]],condition:({_a:n})=>n.has("_x")},{match:["Tan","_a"],replace:"_a",condition:({_a:n})=>n.has("_x")},{match:["Add",["Sin","_a"],["Cos","_a"]],replace:1,condition:({_a:n})=>n.has("_x")},{match:["Subtract",["Square",["Sin","_a"]],["Square",["Cos","_a"]]],replace:["PlusMinus",["Sin","_a"],["Divide",["Sqrt",2],2]],condition:({_a:n})=>n.has("_x")}];function au(n){let e=n.engine,i=e.cache("univariate-roots-rules",()=>ti(e,ad));return ft(n,i,{_x:e.symbol("_x")})}function uu(n){return n.head==="Element"?fd(n):n.head==="Equal"?ud(n):md(n)?ld(n):"not-a-predicate"}function ud(n){n.head;let e=n.unknowns;if(e.length===0){let r=n.evaluate();return r.symbol==="True"?"tautology":r.symbol==="False"?"contradiction":(n.canonical.evaluate(),"not-a-predicate")}let i=n.engine,t=n.op1.symbol;if(t&&!cd(i,t)&&!n.op2.has(t)){let r=n.op2.evaluate();if(!r.isValid)return"not-a-predicate";let o=i.lookupSymbol(t);return o?o.domain&&!r.domain?.isCompatible(o.domain)?"contradiction":(o.value=r,"ok"):(i.defineSymbol(t,{value:r,domain:r.domain}),"ok")}if(e.length===1){let r=e[0],o=xr(n,r);o.length===0&&i.assumptions.set(i.box(["Equal",i.add(n.op1.canonical,i.neg(n.op2.canonical)).simplify(),0]),!0);let s=o.length===1?o[0]:i.box(["List",...o]),a=i.lookupSymbol(r);return a?a.domain&&!o.every(u=>!u.domain||s.domain?.isCompatible(u.domain))?"contradiction":(a.value=s,"ok"):(i.defineSymbol(r,{value:s,domain:s.domain}),"ok")}return i.assumptions.set(n,!0),"ok"}function ld(n){let e=n.engine;if(n.op1.symbol&&!Fo(e,n.op1.symbol))return n.op2.evaluate().isZero?n.head==="Less"?e.defineSymbol(n.op1.symbol,{domain:e.domain("NegativeNumbers")}):n.head==="LessEqual"?e.defineSymbol(n.op1.symbol,{domain:e.domain("NonPositiveNumbers")}):n.head==="Greater"?e.defineSymbol(n.op1.symbol,{domain:e.domain("PositiveNumbers")}):n.head==="GreaterEqual"&&e.defineSymbol(n.op1.symbol,{domain:e.domain("NonNegativeNumbers")}):(e.defineSymbol(n.op1.symbol,{domain:e.domain("ExtendedRealNumbers")}),e.assumptions.set(n,!0)),"ok";let i="",t,r;if(n.head==="Less"?(t=n.op1,r=n.op2,i="<"):n.head==="LessEqual"?(t=n.op1,r=n.op2,i="<="):n.head==="Greater"?(t=n.op2,r=n.op1,i="<"):n.head==="GreaterEqual"&&(t=n.op2,r=n.op1,i="<="),!i)return"internal-error";let o=e.add(t.canonical,e.neg(r.canonical)).simplify(),s=e.box([i==="<"?"Less":"LessEqual",o,0]).evaluate();if(s.symbol==="True")return"tautology";if(s.symbol==="False")return"contradiction";let a=s.unknowns;return a.length===0?"not-a-predicate":(a.length===1&&(e.lookupSymbol(a[0])||e.defineSymbol(a[0],{domain:"ExtendedRealNumbers"})),s.head==="Less"||s.head,e.assumptions.set(s,!0),"ok")}function fd(n){n.head;let e=n.engine,i=dd(n.op1);if(i.length===1){let r=e.domain(n.op2.evaluate().json);return r.isValid?(e.declare(i[0],r),"ok"):"not-a-predicate"}if(n.op1.symbol&&Fo(e,n.op1.symbol)){let r=e.domain(n.op2.evaluate().json);if(!r.isValid)return"not-a-predicate";e.context?.ids?.has(n.op1.symbol)||e.declare(n.op1.symbol,r);let o=e.lookupSymbol(n.op1.symbol);if(o)return o.domain&&!r.isCompatible(o.domain)?"contradiction":(o.domain=r,"ok");let s=e.lookupFunction(n.op1.symbol);return s?r.isCompatible(tr(e,s.signature))?"ok":"contradiction":"not-a-predicate"}if(i.length>0)return e.assumptions.set(n,!0),"ok";let t=n.evaluate();return t.symbol==="True"?"tautology":t.symbol==="False"?"contradiction":"not-a-predicate"}function Fo(n,e){return(n.lookupSymbol(e)??n.lookupFunction(e))!==void 0}function dd(n){return n.symbols.filter(e=>!Fo(n.engine,e))}function cd(n,e){return n.lookupFunction(e)?!1:n.lookupSymbol(e)?.value!==void 0}function md(n){let e=n.head;return typeof e!="string"?!1:["Less","Greater","LessEqual","GreaterEqual"].includes(e)}var Dr=pe(ce(),1);var Go=pe(ce(),1);function Ro(n,e){for(n.isInteger()&&e.isInteger();!e.isZero();)[n,e]=[e,n.modulo(e)];return n.abs()}function fu(n,e){return n.mul(e).div(Ro(n,e))}function Lo(n,e){if(!e.isInteger()||e.isNegative())return n._BIGNUM_NAN;if(e.lessThan(10))return n.bignum([1,1,2,6,24,120,720,5040,40320,362880,3628800][e.toNumber()]);if(e.gt(Number.MAX_SAFE_INTEGER)){let o=n._BIGNUM_ONE,s=n._BIGNUM_TWO;for(;s.lessThan(e);)o=o.mul(s),s=s.add(1);return o}if(e.modulo(2).eq(1))return e.times(Lo(n,e.minus(1)));let i=e.toNumber(),t=e,r=e;for(;i>2;)i-=2,t=t.add(i),r=r.mul(t);return r}function du(n,e){if(!e.isInteger()||e.isNegative())return n._BIGNUM_NAN;if(e.lessThan(1))return n._BIGNUM_ONE;let i=e;for(;e.greaterThan(2);)e=e.minus(2),i=i.mul(e);return i}var lu=7;function qo(n,e){if(e.isNegative())return n._BIGNUM_NAN;let i=n.cache("gamma-p-ln",()=>["0.99999999999999709182","57.156235665862923517","-59.597960355475491248","14.136097974741747174","-0.49191381609762019978","0.33994649984811888699e-4","0.46523628927048575665e-4","-0.98374475304879564677e-4","0.15808870322491248884e-3","-0.21026444172410488319e-3","0.2174396181152126432e-3","-0.16431810653676389022e-3","0.84418223983852743293e-4","-0.2619083840158140867e-4","0.36899182659531622704e-5"].map(s=>n.bignum(s))),t=i[0];for(let s=i.length-1;s>0;--s)t=t.add(i[s].div(e.add(s)));let r=n.cache("gamma-g-ln",()=>n.bignum(607).div(128)),o=e.add(r).add(n._BIGNUM_HALF);return n._BIGNUM_NEGATIVE_ONE.acos().mul(n._BIGNUM_TWO).log().mul(n._BIGNUM_HALF).add(o.log().mul(e.add(n._BIGNUM_HALF)).minus(o).add(t.log()).minus(e.log()))}function Vo(n,e){if(e.lessThan(n._BIGNUM_HALF)){let o=n._BIGNUM_NEGATIVE_ONE.acos();return o.div(o.mul(e).sin().mul(Vo(n,n._BIGNUM_ONE.sub(e))))}if(e.greaterThan(100))return qo(n,e).exp();e=e.sub(1);let i=n.cache("lanczos-7-c",()=>["0.99999999999980993227684700473478","676.520368121885098567009190444019","-1259.13921672240287047156078755283","771.3234287776530788486528258894","-176.61502916214059906584551354","12.507343278686904814458936853","-0.13857109526572011689554707","9.984369578019570859563e-6","1.50563273514931155834e-7"].map(o=>n.bignum(o))),t=i[0];for(let o=1;o<lu+2;o++)t=t.add(i[o].div(e.add(o)));let r=e.add(lu).add(n._BIGNUM_HALF);return n._BIGNUM_NEGATIVE_ONE.acos().times(n._BIGNUM_TWO).sqrt().mul(t.mul(r.neg().exp()).mul(r.pow(e.add(n._BIGNUM_HALF))))}function br(n){return n.isFinite()?n.d.length>3||n.d.length===3&&n.d[0]>=90?!1:(n.precision()<=16,n.e<308&&n.e>-306):!0}var Uo=pe(ce(),1);var Fi=pe(ce(),1);function kn(n,e,i,t){if(i.symbol==="ComplexInfinity")return n.NaN;if(i.isZero)return n.One;if(i.isOne)return e;if(i.isNegativeOne)return n.inv(e);if(i.numericValue!==null&&e.numericValue!==null){if(e.isOne)return n.One;if(e.isZero){if(i.isPositive)return n.Zero;if(i.isNegative)return n.ComplexInfinity}if(i.isNegativeOne)return n.inv(e);let r=E(i);if(r===.5||r===-.5){if(W(e)){let s=n._fn("Sqrt",[e],t);return r>0?s:n._fn("Divide",[n.One,s],t)}return n._fn("Power",[e,i],t)}if(e.isInfinity){if(i.numericValue instanceof Fi.Complex){let o=i.numericValue.re;if(o===0)return n.NaN;if(o<0)return n.Zero;if(o>0)return n.ComplexInfinity}if(e.isNegative){if(i.isInfinity)return n.NaN}else if(e.isPositive){if(i.isNegativeOne)return n.Zero;if(i.isInfinity)return i.isNegative?n.Zero:n.PositiveInfinity}}if(i.isInfinity&&(e.isOne||e.isNegativeOne))return n.NaN}if(e.head==="Power"&&e.op1.isReal){let r=q(i);if(r!==null){let o=q(e.op2);if(o!==null)return n.pow(e.op1,n.number(r*o))}if(e.op1.isNonNegative){let o=W(i);if(o){let s=W(e.op2);if(s)return n.pow(e.op1,n.number(Q(o,s)))}}}return n._fn("Power",[e,i],t)}function cu(n,e,i){if(e.numericValue===null||i.numericValue===null)return;if(e.numericValue instanceof Fi.Complex)return i.numericValue instanceof Fi.Complex?n.number(e.numericValue.pow(i.numericValue)):n.number(e.numericValue.pow(E(i)??NaN));if(i.numericValue instanceof Fi.Complex){let s=E(e)??null;return s!==null?n.number(n.complex(s).pow(i.numericValue)):void 0}let t=pd(i);if(F(n)||e.numericValue instanceof v||i.numericValue instanceof v){let s=Ge(e),a=Ge(i);if(!s||!a)return;if(t===2)return s.isNeg()?ae(n)?n.number(n.complex(0,s.neg().sqrt().toNumber())):n.NaN:n.number(s.sqrt());if(!a.isInteger()&&s.isNeg()){if(!ae(n))return n.NaN;let u=n.complex(s.toNumber()),l=n.complex(a.toNumber());return n.number(u.pow(l))}return n.number(s.pow(a))}let r=E(i)??NaN,o=E(e)??NaN;if(t===2)return o<0?ae(n)?n.mul(n.I,n.number(Math.sqrt(-o))):n.NaN:n.number(Math.sqrt(o));if(!Number.isInteger(r)&&o<0){if(!ae(n))return n.NaN;let s=n.complex(o),a=n.complex(r);return n.number(s.pow(a))}return n.number(Math.pow(o,r))}function si(n,e,i,t){if(t!=="simplify"&&e.symbol==="ExponentialE"&&i instanceof Fi.Complex){let r=i.im,o=i.re,s;if(o===0)s=this.number(this.complex(Math.cos(r),Math.sin(r)));else{if(r===0)return this.number(Math.exp(o));{let a=Math.exp(o);s=this.number(this.complex(a*Math.cos(r),a*Math.sin(r)))}}return t==="N"?s.N():s}if(e.head==="Multiply"){let r=F(n)?[BigInt(1),BigInt(1)]:[1,1],o=r,s=[];for(let a of e.ops){let u=W(a);if(u)r=Q(r,u);else{let l=$o(a);l?o=Q(o,l):s.push(a)}}if(!ie(r)||!ie(o)){let a=si(n,n.number(r),i,t),u=si(n,n.number(o),n.div(i,n.number(2)),t),l=n.mul(...s),f=si(n,l,i,t)??n._fn("Power",[l,i]);if(a&&u&&f)return n.mul(a,u,f)}}if(e.head==="Power"){if(q(e.op2)===-1&&q(i)===-1)return e.op1;let r=W(e.op2),o=W(i);if(r&&o){let s=Q(r,o);return n.pow(e.op1,s)}if(t==="N"){let s=E(e.op2),a=E(i);if(s!==null&&a!==null){let u=s*a;return u===0?n.One:u===1?e.op1:n.pow(e.op1,u)}}}if(t!=="N"&&e.numericValue!==null&&e.isInteger){if(e.isOne)return n.One;if(q(i))return cu(n,e,i);let o=W(i);if(o){let[s,a]=[Oe(o),dn(o)];if((s===1||s===-1)&&(a===2||a===3)){if(F(n)||e.numericValue instanceof v){let u=lt(e);if(a%2===0&&u<0&&!ae(n))return n.NaN;let l=u<0?a%2===0?n.I:n.NegativeOne:n.One,[f,d]=ii(u>0?u:-u,a);if(d===BigInt(1)&&f===BigInt(1))return l;if(f!==BigInt(1))return d===BigInt(1)?n.mul(l,n.number(s>=0?f:[BigInt(1),f])):n.mul(l,n.number(f),n.pow(n.number(d),i))}else if(typeof e.numericValue=="number"){if(e.numericValue<0&&a%2===0&&!ae(n))return n.NaN;let[u,l]=Ln(Math.abs(e.numericValue),a),f=e.numericValue<0?a%2===0?n.I:n.NegativeOne:n.One;if(l===1&&u===1)return f;if(u!==1)return l===1?n.mul(f,n.number(s>=0?u:[1,u])):n.mul(f,n.number(u),n.pow(n.number(l),i))}}return e.isNegative?ae?n.mul(n.I,n.box(["Sqrt",n.neg(e)])):n.NaN:void 0}}if(t!=="N"&&U(e.numericValue)){let[r,o]=e.numericValue;return n.div(n.pow(n.number(r),i),n.pow(n.number(o),i))}if(t!=="simplify"&&e.numericValue!==null&&i.numericValue!==null)return cu(n,e,i)}function Ri(n,e,i){if(e.isOne)return n.One;if(e.isZero)return n.Zero;if(e.isNegativeOne)return ae(n)?n.I:n.NaN;if(e.isNegative&&!ae(n))return n.NaN;let t=W(e);if(i==="N"||i==="evaluate"&&!t)return R(e,o=>o<0?n.complex(o).sqrt():Math.sqrt(o),o=>o.isNeg()?n.complex(o.toNumber()).sqrt():o.sqrt(),o=>o.sqrt());let r=q(e);if(r!==null){let[o,s]=Ln(Math.abs(r),2);return o===1?n._fn("Sqrt",[e]):r<0?s===1?n.number(n.complex(0,o)):n.mul(n.number(n.complex(0,o)),n.sqrt(n.number(s))):s===1?n.number(o):n.mul(n.number(o),n.sqrt(n.number(s)))}if(t){if(J(t)&&!F(n)){let[o,s]=t;if(Math.abs(o)<Number.MAX_SAFE_INTEGER&&s<Number.MAX_SAFE_INTEGER){let[a,u]=Ln(Math.abs(o),2),[l,f]=Ln(s,2);if(o<0)return n.mul(n.number([a,l]),n.sqrt(n.number([u,f])),n.I);let d=n.number([a,l]);return d.isOne?n._fn("Sqrt",[n.number([u,f])]):n.mul(d,n.sqrt(n.number([u,f])))}}if(K(t)||F(n)){let o=P(t[0]),[s,a]=ii(o>0?o:-o,2),[u,l]=ii(P(t[1]),2);if(o<0)return n.mul(n.number([s,u]),n.sqrt(n.number([a,l])),n.I);let f=n.number([s,u]);return f.isOne?n._fn("Sqrt",[n.number([a,l])]):n.mul(f,n.sqrt(n.number([a,l])))}}}function pd(n){if(typeof n.numericValue=="number"){let t=1/n.numericValue;return Number.isInteger(t)?t:null}if(n.numericValue instanceof v){let t=n.engine._BIGNUM_ONE.div(n.numericValue);return t.isInt()?t.toNumber():null}if(!U(n.numericValue))return null;let[e,i]=[Oe(n.numericValue),dn(n.numericValue)];return e!==1&&e!==-1?null:e*i}function Li(n){return n.head==="Sqrt"||n.head==="Power"&&E(n.op2)===.5}function $o(n){return Li(n)?W(n.op1)??null:null}var wn=class{constructor(e,i,t){this.options=t;this._terms=[];this._hasInfinity=!1;this._hasZero=!1;this._isCanonical=!0;if(t=t?{...t}:{},"canonical"in t||(t.canonical=!0),this._isCanonical=t.canonical,this.engine=e,this._sign=1,this._rational=F(e)?[BigInt(1),BigInt(1)]:[1,1],this._rationalSqrt=this._rational,this._complex=Uo.Complex.ONE,this._bignum=e._BIGNUM_ONE,this._number=1,i)for(let r of i)this.addTerm(r)}get isEmpty(){return this._isCanonical?this._terms.length===0&&this._hasInfinity===!1&&this._hasZero===!1&&this._sign===1&&this._number===1&&this._complex.re===1&&this._complex.im===0&&this._bignum.eq(this.engine._BIGNUM_ONE)&&ie(this._rational)&&ie(this._rationalSqrt):this._terms.length===0}addTerm(e){if(e.isCanonical,e.head==="Multiply"){for(let o of e.ops)this.addTerm(o);return}if(this._isCanonical){if(e.isNothing)return;if(e.numericValue!==null){if(e.isOne)return;if(e.isZero){this._hasZero=!0;return}if(e.isNegativeOne){this._sign*=-1;return}if(e.isInfinity){this._hasInfinity=!0,e.isNegative&&(this._sign*=-1);return}let s=e.numericValue;if(typeof s=="number"){s<0&&(this._sign*=-1,s=-s),Number.isInteger(s)?this._rational=Q(this._rational,[s,1]):F(this.engine)?this._bignum=this._bignum.mul(s):this._number*=s;return}if(s instanceof v){s.isNegative()&&(this._sign*=-1,s=s.neg()),s.isInteger()?this._rational=Q(this._rational,[P(s),BigInt(1)]):F(this.engine)?this._bignum=this._bignum.mul(s):this._number*=s.toNumber();return}if(s instanceof Uo.Complex){this._complex=this._complex.mul(s);return}if(U(s)){this._rational=Q(this._rational,s),Bo(this._rational)&&(this._sign*=-1,this._rational=_e(this._rational));return}}let o=$o(e);if(o){this._rationalSqrt=Q(this._rationalSqrt,o);return}}let i=e;if(this._isCanonical){let o;[o,i]=Je(e),this._rational=Q(this._rational,o),Bo(this._rational)&&(this._sign*=-1,this._rational=_e(this._rational))}if(i.numericValue!==null&&i.isOne)return;let t=[1,1];if(i.head==="Power"){let o=W(i.op2);o&&(t=o,i=i.op1)}else i.head==="Divide"&&(this.addTerm(i.op1),t=[-1,1],i=i.op2);let r=!1;for(let o of this._terms)if(o.term.isSame(i)){o.exponent=st(o.exponent,t),r=!0;break}r||this._terms.push({term:i,exponent:t})}unitTerms(e){let i=this.engine;if(e==="numeric"){if(!ae(i)&&this._complex.im!==0)return null;if(F(i)){let u=i._BIGNUM_ONE;if(ie(this._rational)||(K(this._rational)?u=i.bignum(this._rational[0].toString()).div(i.bignum(this._rational[1].toString())):u=i.bignum(this._rational[0]).div(this._rational[1])),u=u.mul(this._bignum).mul(this._sign*this._number),this._complex.im!==0){let l=this._complex.mul(u.toNumber());return l.equals(1)?[]:[{exponent:[1,1],terms:[i.number(l)]}]}return u=u.mul(this._complex.re),u.equals(1)?[]:[{exponent:[1,1],terms:[i.number(u)]}]}let a=1;if(ie(this._rational)||(K(this._rational)?a=Number(this._rational[0])/Number(this._rational[1]):a=this._rational[0]/this._rational[1]),a*=this._sign*this._number*this._bignum.toNumber(),this._complex.im!==0){let u=this._complex.mul(a);return u.equals(1)?[]:[{exponent:[1,1],terms:[i.number(u)]}]}return a*=this._complex.re,a===1?[]:[{exponent:[1,1],terms:[i.number(a)]}]}let t=[],r=[];if(this._hasInfinity&&r.push(i.PositiveInfinity),this._rationalSqrt=je(this._rationalSqrt),!ie(this._rationalSqrt)){let[a,u]=this._rationalSqrt,l=i.sqrt(i.number(a)),f=i.sqrt(i.number(u));if(f.isOne){let d=W(l);d?this._rational=Q(this._rational,d):r.push(l)}else l.isInteger&&f.isInteger?(this._rational=Q(Q(this._rational,l),i.inv(f)),r.push(i._fn("Sqrt",[i.div(l.op1,f.op1)]))):Li(l)&&Li(f)?r.push(i._fn("Sqrt",[i.div(l.op1,f.op1)])):r.push(i._fn("Divide",[l,f]))}(this._complex.re!==1||this._complex.im!==0)&&(this._complex.im===0?this._number*=Math.abs(this._complex.re):r.push(i.number(this._complex)));let o=this._sign*this._number,s=this._bignum;return this._rational=je(this._rational),ie(this._rational)||(e==="rational"?(Oe(this._rational)!==1&&(K(this._rational)?s=s.mul(i.bignum(this._rational[0])):o*=this._rational[0]),dn(this._rational)!==1&&t.push({exponent:[-1,1],terms:[i.number(this._rational[1])]})):o===-1?(r.push(i.number(_e(this._rational))),o=1):r.push(i.number(this._rational))),s.equals(i._BIGNUM_ONE)?o!==1&&r.push(i.number(o)):r.push(i.number(s.mul(o))),r.length>0&&t.push({exponent:[1,1],terms:r}),t}groupedByDegrees(e){e??(e={}),"mode"in e||(e.mode="expression");let i=this.engine;if(e.mode==="numeric"){if(this._complex.im!==0&&!ae(i))return null;if(this._hasInfinity)return[{exponent:[1,1],terms:[i.PositiveInfinity]}]}let t=this.unitTerms(e.mode??"expression");if(t===null)return null;for(let r of this._terms){let o=je(r.exponent);if(o[0]===0)continue;let s=!1;for(let a of t)if(o[0]===a.exponent[0]&&o[1]===a.exponent[1]){a.terms.push(r.term),s=!0;break}s||t.push({exponent:o,terms:[r.term]})}return t}asExpression(e="evaluate"){let i=this.engine;if(this._hasInfinity){if(this._hasZero)return i.NaN;if(this._terms.length===0)return Oe(this._rational)>0?i.PositiveInfinity:i.NegativeInfinity}if(this._hasZero)return i.Zero;let t=this.groupedByDegrees({mode:e==="N"?"numeric":"expression"});if(t===null)return i.NaN;let r=zo(i,t);return r.length===0?i.One:r.length===1?r[0]:this.engine._fn("Multiply",r)}asNumeratorDenominator(){if(this._hasZero)return[this.engine.Zero,this.engine.One];if(this._hasInfinity)return[this.engine.NaN,this.engine.NaN];let e=this.groupedByDegrees({mode:"rational"});if(e===null)return[this.engine.NaN,this.engine.NaN];let i=[],t=[];for(let l of e)l.exponent[0]>=0?i.push(l):t.push({exponent:_e(l.exponent),terms:l.terms});let r=this.engine,o=zo(r,i),s=r.One;o.length===1?s=o[0]:o.length>0&&(s=r._fn("Multiply",o));let a=zo(r,t),u=r.One;return a.length===1?u=a[0]:a.length>0&&(u=r._fn("Multiply",a)),[s,u]}asRationalExpression(){let[e,i]=this.asNumeratorDenominator();if(i.numericValue!==null){if(i.isOne)return e;if(i.isNegativeOne)return this.engine.neg(e)}return this.engine._fn("Divide",[e,i])}};function mu(n){if(ie(n))return 0;let[e,i]=[Oe(n),dn(n)];return e>0&&Number.isInteger(e/i)?1:e>0?2:Number.isInteger(e/i)?3:4}function hd(n,e){let i=mu(n.exponent),t=mu(e.exponent);if(i!==t)return i-t;let[r,o]=[Oe(n.exponent),dn(n.exponent)],[s,a]=[Oe(e.exponent),dn(e.exponent)];return r/o-s/a}function zo(n,e){let i=e.sort(hd).map(t=>{let r=te(t.terms,"Multiply"),o=r.length<=1?r[0]:n._fn("Multiply",r.sort(tn));return n.pow(o,t.exponent)});return te(i,"Multiply")??i}function pu(n,e,i,t){if(e.numericValue!==null){if(U(e.numericValue))return Oe(e.numericValue)<0?O(n,"Subtract",[i,n.number(_e(e.numericValue))],t):null;let r=q(e);if(r!==null&&r<0)return O(n,"Subtract",[i,n.number(-r)],t)}return e.head==="Negate"?O(n,"Subtract",[i,e.op1],t):null}function gu(n,e,i,t){let r=n.jsonSerializationOptions.exclude;if(e==="Add"&&i.length===2&&!r.includes("Subtract")){let o=pu(n,i[0],i[1],t)??pu(n,i[1],i[0],t);if(o)return o}if(e==="Divide"&&i.length===2&&r.includes("Divide"))return O(n,"Multiply",[i[0],n._fn("Power",[i[1],n.NegativeOne])],t);if(e==="Multiply"&&!r.includes("Negate")&&E(i[0])===-1)return i.length===2?O(n,"Negate",[i[1]]):O(n,"Negate",[n._fn("Multiply",i.slice(1))],t);if(e==="Multiply"&&!r.includes("Divide")){let o=new wn(n,i,{canonical:!1}).asRationalExpression();if(o.head==="Divide")return O(n,o.head,o.ops,t)}if(e==="Power"){if(!r.includes("Exp")&&i[0]?.symbol==="ExponentialE")return O(n,"Exp",[i[1]],t);if(i[1]?.numericValue!==null){let o=q(i[1]);if(o===2&&!r.includes("Square"))return O(n,"Square",[i[0]],t);if(o!==null&&o<0&&!r.includes("Divide"))return O(n,"Divide",[n.One,o===-1?i[0]:n.pow(i[0],-o)],t);let s=i[1].numericValue;if(!r.includes("Sqrt")&&s===.5)return O(n,"Sqrt",[i[0]],t);if(!r.includes("Sqrt")&&s===-.5)return O(n,"Divide",[n.One,n._fn("Sqrt",[i[0]])],t);if(U(s)){let a=Oe(s),u=dn(s);if(a===1){if(!r.includes("Sqrt")&&u===2)return O(n,"Sqrt",[i[0]],t);if(!r.includes("Root"))return O(n,"Root",[i[0],n.number(s[1])],t)}if(a===-1){if(!r.includes("Sqrt")&&u===2)return O(n,"Divide",[n.One,n._fn("Sqrt",[i[0]])],t);if(!r.includes("Root"))return O(n,"Divide",[n.One,n._fn("Root",[i[0],n.number(s[1])])],t)}}}}if(e==="Add"&&i.length===2&&!r.includes("Subtract")){if(i[1]?.numericValue!==null){let o=q(i[1]);if(o!==null&&o<0)return O(n,"Subtract",[i[0],n.number(-o)],t)}if(i[1]?.head==="Negate")return O(n,"Subtract",[i[0],i[1].op1],t)}if(e==="Tuple"){if(i.length===1&&!r.includes("Single"))return O(n,"Single",i,t);if(i.length===2&&!r.includes("Pair"))return O(n,"Pair",i,t);if(i.length===3&&!r.includes("Triple"))return O(n,"Triple",i,t)}return O(n,e,i,t)}function O(n,e,i,t){let r=n.jsonSerializationOptions.exclude;if(e==="Negate"&&i.length===1){let u=i[0]?.numericValue;if(u!==null){if(typeof u=="number")return ai(n,-u);if(u instanceof v||u instanceof Go.Complex)return ai(n,u.neg());if(U(u))return ai(n,_e(u))}}if(typeof e=="string"&&r.includes(e)){if(e==="Rational"&&i.length===2)return O(n,"Divide",i,t);if(e==="Complex"&&i.length===2)return O(n,"Add",[i[0],n._fn("Multiply",[i[1]??n.symbol("Undefined"),n.I])],t);if(e==="Sqrt"&&i.length===1)return O(n,"Power",[i[0],r.includes("Half")?n.number([1,2]):n.Half],t);if(e==="Root"&&i.length===2&&i[1]?.numericValue!==null){let u=q(i[1]);if(u===2)return O(n,"Sqrt",[i[0]]);if(u!==null)return u<0?O(n,"Divide",[n.One,n._fn("Power",[i[0]??n.symbol("Undefined"),n.number([1,-u])])],t):O(n,"Power",[i[0],n.number([1,-u])],t)}if(e==="Square"&&i.length===1)return O(n,"Power",[i[0],n.number(2)],t);if(e==="Exp"&&i.length===1)return O(n,"Power",[n.E,i[0]],t);if(e==="Pair"||e=="Single"||e==="Triple")return O(n,"Tuple",i,t);if(e==="Subtract"&&i.length===2)return O(n,"Add",[i[0],n._fn("Negate",[i[1]??n.symbol("Undefined")])],t);if(e==="Subtract"&&i.length===1)return O(n,"Negate",i,t)}let s=[typeof e=="string"?e:e.json,...i.map(u=>u?.json??"Undefined")],a={...t??{}};return n.jsonSerializationOptions.metadata.includes("latex")?a.latex=a.latex??n.serialize({fn:s}):a.latex="",n.jsonSerializationOptions.metadata.includes("wikidata")||(a.wikidata=""),!a.latex&&!a.wikidata&&n.jsonSerializationOptions.shorthands.includes("function")?s:a.latex&&a.wikidata?{fn:s,latex:a.latex,wikidata:a.wikidata}:a.latex?{fn:s,latex:a.latex}:a.wikidata?{fn:s,wikidata:a.wikidata}:{fn:s}}function xu(n,e){return e=e,n.jsonSerializationOptions.shorthands.includes("string")?`'${e}'`:{str:e}}function yr(n,e,i){if(e==="Half"&&n.jsonSerializationOptions.exclude.includes("Half"))return ai(n,[1,2],i);if(i={...i},n.jsonSerializationOptions.metadata.includes("latex")?(i.latex=i.latex??n.serialize({sym:e}),i.latex!==void 0&&(i.latex=i.latex)):i.latex=void 0,n.jsonSerializationOptions.metadata.includes("wikidata")){if(i.wikidata===void 0){let t=n.lookupSymbol(e)?.wikidata;t!==void 0&&(i.wikidata=t)}}else i.wikidata=void 0;return e=e,i.latex===void 0&&i.wikidata===void 0&&n.jsonSerializationOptions.shorthands.includes("symbol")?e:i.latex!==void 0&&i.wikidata!==void 0?{sym:e,latex:i.latex,wikidata:i.wikidata}:i.latex!==void 0?{sym:e,latex:i.latex}:i.wikidata!==void 0?{sym:e,wikidata:i.wikidata}:{sym:e}}function ai(n,e,i){i={...i},n.jsonSerializationOptions.metadata.includes("latex")||(i.latex=void 0);let t=i.latex===void 0&&i.wikidata===void 0&&!n.jsonSerializationOptions.metadata.includes("latex")&&n.jsonSerializationOptions.shorthands.includes("number"),r=n.jsonSerializationOptions.exclude,o="";if(e instanceof v){if(e.isNaN())o="NaN";else if(!e.isFinite())o=e.isPositive()?"+Infinity":"-Infinity";else{if(t&&br(e))return e.toNumber();if(e.isInteger()&&e.e<e.precision()+4)o=e.toFixed(0);else{let s=n.jsonSerializationOptions.precision,a=s==="max"?e.toString():e.toPrecision(s==="auto"?n.precision:s);if(o=hu(n,a),t){let u=e.toNumber();if(u.toString()===o)return u}}}return n.jsonSerializationOptions.metadata.includes("latex")&&(i.latex=i.latex??n.serialize({num:o})),i.latex!==void 0?{num:o,latex:i.latex}:t?o:{num:o}}if(e instanceof Go.Complex)return e.isInfinite()?yr(n,"ComplexInfinity",i):e.isNaN()?(o="NaN",n.jsonSerializationOptions.metadata.includes("latex")&&(i.latex=i.latex??n.serialize({num:o})),i.latex!==void 0?{num:o,latex:i.latex}:{num:o}):O(n,"Complex",[n.number(e.re),n.number(e.im)],{...i,wikidata:"Q11567"});if(U(e)){let s=!r.includes("Rational");return t&&n.jsonSerializationOptions.shorthands.includes("function")&&J(e)?e[0]===1&&e[1]===2&&!r.includes("Half")?yr(n,"Half",i):[s?"Rational":"Divide",e[0],e[1]]:O(n,s?"Rational":"Divide",[n.number(e[0]),n.number(e[1])],{...i})}if(Number.isNaN(e))o="NaN";else if(!Number.isFinite(e))o=e>0?"+Infinity":"-Infinity";else{if(t)return e;o=hu(n,e.toString())}return n.jsonSerializationOptions.metadata.includes("latex")&&(i.latex=i.latex??n.serialize({num:o})),i.latex!==void 0?{num:o,latex:i.latex}:{num:o}}function hu(n,e){if(!n.jsonSerializationOptions.repeatingDecimals)return e;let[i,t,r,o]=e.match(/^(.*)\.([0-9]+)([e|E][-+]?[0-9]+)?$/)??[];if(!r)return e.toLowerCase();let s=r[r.length-1];r=r.slice(0,-1);let a=16,u="";for(let l=0;l<r.length-a;l++){u=r.substring(0,l);for(let f=0;f<=a;f++){let d=r.substring(l,l+f+1),c=Math.floor((r.length-u.length)/d.length);if(c<3)break;if((u+d.repeat(c+1)).startsWith(r))return d==="0"?s==="0"?t+"."+u+(o??""):e:t+"."+u+"("+d+")"+(o??"")}}for(r+=s;r.endsWith("0");)r=r.slice(0,-1);return o?`${t}.${r}${o.toLowerCase()}`:`${t}.${r}`}var qi=class n extends L{constructor(i,t,r){r??(r={});super(i,r.metadata);this._value=new Map;let o=r.canonical??!0;if(t instanceof Map)for(let[s,a]of t)this._value.set(s,i.box(a,{canonical:o}));else for(let s of Object.keys(t))this._value.set(s,i.box(t[s],{canonical:o}));i._register(this)}bind(){for(let[i,t]of this._value)t.bind()}reset(){for(let[i,t]of this._value)t.reset()}get hash(){let i=xe("Dictionary");for(let[t,r]of this._value)i^=xe(t)^r.hash;return i}get complexity(){return 97}get head(){return"Dictionary"}get isPure(){return!1}getKey(i){return this._value.get(i)}hasKey(i){return this._value.has(i)}get keys(){return this._value.keys()}get keysCount(){return this._value.size}has(i){for(let[t,r]of this._value)if(r.has(i))return!0;return!1}get domain(){return this.engine.domain("Dictionaries")}get json(){if(this.engine.jsonSerializationOptions.shorthands.includes("dictionary")){let t={};for(let r of this._value.keys())t[r]=this._value.get(r).json;return{dict:t}}let i=[];for(let t of this._value.keys())i.push(this.engine._fn("KeyValuePair",[this.engine.string(t),this._value.get(t)]));return O(this.engine,"Dictionary",i,{latex:this._latex})}isSame(i){if(this===i)return!0;if(!(i instanceof n)||this._value.size!==i._value.size)return!1;for(let[t,r]of this._value){let o=i.getKey(t);if(!o||!r.isSame(o))return!1}return!0}match(i,t){if(!(i instanceof n)||this._value.size!==i._value.size)return null;let r={};for(let[o,s]of this._value){let a=i.getKey(o);if(!a)return null;let u=s.match(a);if(u===null)return null;r={...r,...u}}return r}isEqual(i){if(this===i)return!0;if(!(i instanceof n)||!i.keys||this._value.size!==i._value.size)return!1;for(let[t,r]of this._value){let o=i.getKey(t);if(!o||!r.isEqual(o))return!1}return!0}evaluate(i){return this}get isCanonical(){return this._isCanonical}set isCanonical(i){this._isCanonical=i}get canonical(){return this.isCanonical?this:new n(this.engine,this._value,{canonical:!0})}simplify(i){return this}N(i){return this}replace(i,t){let r=0,o={};for(let s of this.keys){let a=this.getKey(s),u=a.replace(i,t);u!==null&&(r+=1),o[s]=u??a}return r===0?null:new n(this.engine,o)}subs(i,t){let r={};for(let o of this.keys)r[o]=this.getKey(o).subs(i,t);return new n(this.engine,r,t)}};var Nu=pe(ce(),1);var bu=[];function jo(n){if(n.head==="N"&&typeof n.op1.head=="string"){let o={Integrate:"NIntegrate",Limit:"NLimit"}[n.op1.head];o&&(n=n.engine._fn(o,n.op1.ops))}if(n.head==="Function")return n;let e=n.unknowns;e.includes("_")&&(n=n.subs({_:"_1"}),e=n.unknowns);let i=0;for(let o of e)if(o.startsWith("_")){let s=Number(o.slice(1));s>i&&(i=s)}let t=n.engine;return t._fn("Function",[n,...Array.from({length:i},(o,s)=>t.symbol(`_${s+1}`))])}function Zo(n){let e=n.engine,i=n.symbol?e.lookupFunction(n.symbol):void 0;if(i){let a=i.signature.N??i.signature.evaluate;return a?u=>a(e,u)??e._fn(n,u):u=>e._fn(n,u)}let t=jo(n);if(!t)return;t.head;let r=t.ops.slice(1).map(a=>a.symbol??"Nothing");e.pushScope();for(let a of r)e.declare(a,{inferred:!0,domain:void 0});let o=t.op1.canonical;o.bind(),e.popScope();let s=o.scope;return r.length===0?()=>{let a=e.swapScope(s);e.resetContext();let u=o.N()??o.evaluate();return e.swapScope(a),u}:a=>{if(e.strict&&(a=Se(e,a,r.length),!a.every(d=>d.isValid)))return;a=a.map(d=>d.evaluate());let u=e.swapScope(s);e.resetContext();let l=0;for(let d of r)e.assign(d,a[l++]);let f=o.N()??o.evaluate();if(e.swapScope(u),!!f.isValid)return f}}function ui(n,e){return Zo(n)?.(e)??n.engine._fn(n,e)}function li(n){return Zo(n)??(e=>n.engine._fn(n.N(),e).N())}function Ho(n){let e=n.engine,i=Zo(n);return i?t=>i([e.number(t)])?.value??NaN:t=>e._fn(n.evaluate(),[e.number(t)]).value}function Jo(n){let e=n.match(/(.+)\((.*)\)/);if(!e)return[n,void 0];let i=e[1],t=e[2].split(",").map(r=>r.trim());return[i,t]}function on(n,e,i){if(!e.isValid||!i.isValid)return n._fn("Divide",[e,i]);if(e.head==="Negate"&&i.head==="Negate"&&(e=e.op1,i=i.op1),e.numericValue!==null&&i.numericValue!==null){if(i.isOne)return e;if(i.isNegativeOne)return n.neg(e);if(e.isOne)return n.inv(i);if(e.isNegativeOne)return n.neg(n.inv(i));let m=W(e),g=W(i);if(m&&g&&!Ze(g))return n.number(Q(m,Tn(g)))}if(e.head==="Divide"&&i.head==="Divide")return on(n,n.mul(e.op1,i.op2),n.mul(e.op2,i.op1));if(e.head==="Divide")return on(n,n.mul(e.op1,i),e.op2);if(i.head==="Divide")return on(n,n.mul(e,i.op2),i.op1);let t=e.numericValue;if(t!==null){if(J(t)){let[m,g]=t;return on(n,n.number(m),n.mul(n.number(g),i))}if(K(t)){let[m,g]=t;return on(n,n.number(m),n.mul(n.number(g),i))}}let r=i.numericValue;if(r!==null){if(J(r)){let[m,g]=r;return on(n,n.mul(e,n.number(g)),n.number(m))}if(K(r)){let[m,g]=r;return on(n,n.mul(e,n.number(g)),n.number(m))}}let[o,s]=Je(e),[a,u]=Je(i);if(!ie(o)||!ie(a)){let[m,g]=Fa(o,a),[h,x]=[n.mul(n.number(m),s),n.mul(n.number(g),u)];return x.isNegative&&(x=n.neg(x),h=n.neg(h)),x.head==="Negate"&&(x=x.op1,h=n.neg(h)),h.isZero?n.Zero:x.isOne?h:n._fn("Divide",[h,x])}let[l,f]=Io(e),[d,c]=Io(i);return f=f.canonical,c=c.canonical,c.numericValue!==null&&c.isOne?l*d<0?ge(f):f:l*d>0?n._fn("Divide",[f,c]):f.numericValue?n._fn("Divide",[ge(f),c]):ge(n._fn("Divide",[f,c]))}function Er(n,e,i){if(e.numericValue!==null&&i.numericValue!==null){let t=W(e),r=W(i);if(t&&r&&!Ze(r))return n.number(Q(t,Tn(r)))}return new wn(n,[e,n.inv(i)]).asRationalExpression()}function vr(n,e,i){let t=Er(n,e,i);return t?.head==="Divide"&&(!t.op1.isExact||!t.op2.isExact)&&(t=Vn(e,i,(r,o)=>r/o,(r,o)=>r.div(o),(r,o)=>r.div(o))??t),t!==void 0?t:n._fn("Divide",[e,i])}function Et(n,e){if(e.every(s=>s.isCanonical),e.length===0)return n.One;if(e.length===1)return e[0];let i=[],t=1,r,o=0;for(let s of e)if(!s.isOne){if(s.isNegativeOne){t=-t;continue}if(s.head==="Negate"){t=-t,i.push(s.op1);continue}if(r===void 0&&typeof s.numericValue=="number"){r=s.numericValue,r<0&&(t=-t,r=-r);continue}if(s.numericValue!==null&&s.isNegative){t=-t,i.push(n.neg(s));continue}if(s.symbol==="ImaginaryUnit"){o++;continue}i.push(s)}return o>0&&(o%2===0?t=-t:(i.push(n.number(n.complex(0,t*(r??1)))),t=1,r=void 0)),typeof r=="number"&&(i.push(n.number(t*r)),t=1),t<0?i.length===0?n.NegativeOne:i.length===1?n.neg(i[0]):n.neg(n._fn("Multiply",i.sort(tn))):i.length===0?n.One:i.length===1?i[0]:n._fn("Multiply",i.sort(tn))}function yu(n,e){e.every(t=>t.head!=="Multiply");let i=new wn(n);for(let t of e){if(t=t.simplify(),t.isNaN||t.symbol==="Undefined")return n.NaN;i.addTerm(t)}return i.asExpression()}function vt(n,e,i="evaluate"){if(e.length===1)return e[0];if(i==="N"&&(e=e.map(t=>t.N()),(n.numericMode==="machine"||n.numericMode==="auto")&&e.every(t=>typeof t.numericValue=="number"))){let t=1;for(let r of e)t*=r.numericValue;return n.number(t)}for(let t of e){if(t.isNaN||t.symbol==="Undefined")return n.NaN;t.numericValue!==null&&!t.isExact&&(i="N")}return e.every(t=>t.head!=="Multiply"),i==="N"?e=e.map(t=>t.N()):e=e.map(t=>t.evaluate()),new wn(n,e).asExpression(i)}function Eu(n,e,i){n.pushScope(),e??(e=n.error("missing"));var t=void 0;if(i&&i.ops&&i.ops[0]?.head==="Delimiter"){var r=ur(i);if(!r)return null;var o=[e.canonical];r.forEach(a=>{o.push(a)}),t=n._fn("Product",o)}else{var s=$n(i);t=s?n._fn("Product",[e.canonical,s]):n._fn("Product",[e.canonical])}return n.popScope(),t}function Nr(n,e,i){let t=e[0],r=[];if(e){r=[];for(let m=1;m<e.length;m++)r.push(e[m])}let o=null;if(r?.length===0){let m=i==="simplify"?t.simplify():t.evaluate({numericMode:i==="N"});if(F(n)){let g=n.bignum(1);for(let h of X(m)){let x=Ge(h);if(x===null){o=void 0;break}if(x.isFinite()===!1){g=x;break}g=g.mul(x)}o===null&&(o=n.number(g))}else{let g=1;for(let h of X(m)){let x=E(h);if(x===null){o=void 0;break}if(x===null||!Number.isFinite(x)){g=x;break}g*=x}o===null&&(o=n.number(g))}return o??void 0}var s=[];let a=[],u=[],l=[];r.forEach(m=>{let[g,h,x,S]=zn(m.evaluate());g&&(s.push(g),a.push(h),u.push(x),l.push(S))});let f=t,d=n.swapScope(f.scope);n.pushScope(),f.bind();for(let m=0;m<s.length;m++){let g=s[m],h=a[m],x=u[m],S=l[m];if(h>=x||i!=="N"&&(h>=x||x-h>=rt))return;if(i==="simplify"){let T=[];for(let _=h;_<=x;_++)n.assign({[g]:_}),T.push(f.simplify());o=n.mul(...T).simplify()}}let c=[];if(s.length>1)for(let m=0;m<s.length-1;m++)c.length===0?c=Ci(cn(a[m],u[m]),cn(a[m+1],u[m+1])):c=Ci(c.map(g=>g[0]),cn(a[m+1],u[m+1]));else c=cn(a[0],u[0]).map(m=>[m]);if(i==="evaluate"){let m=[];for(let g of c){let h=s.map((x,S)=>(n.assign(x,g[S]),x));m.push(f.evaluate())}o=n.mul(...m).evaluate()}if(i==="N")for(let m=0;m<s.length;m++){let g=s[m],h=a[m],x=u[m],S=l[m];if(o===null&&S){if(F(n)){let j=n.bignum(1);for(let Z=h;Z<=x;Z++){n.assign({[g]:Z});let De=Ge(f.N());if(De===null||De.isFinite()===!1){o=De!==null?n.number(De):void 0;break}j=j.mul(De)}o===null&&(o=n.number(j))}let T=1,_=n.numericMode,w=n.precision;n.numericMode="machine";for(let j=h;j<=x;j++){n.assign({[g]:j});let Z=E(f.N());if(Z===null||!Number.isFinite(Z)){o=Z!==null?n.number(Z):void 0;break}T*=Z}n.numericMode=_,n.precision=w,o===null&&(o=n.number(T))}if(o===null){n.assign({[g]:1e3});let T=f.N();n.assign({[g]:999});let _=f.N(),w=E(n.div(T,_).N());if(w!==null&&Number.isFinite(w)&&Math.abs(w)>1)o=n.PositiveInfinity;else{let j=1,Z=n.numericMode,De=n.precision;n.numericMode="machine";for(let $e=h;$e<=x;$e++){n.assign({[g]:$e});let Ce=E(f.N());if(Ce===null){o=void 0;break}if(Math.abs(1-Ce)<Number.EPSILON||!Number.isFinite(Ce))break;j*=Ce}o===null&&(o=n.number(j)),n.numericMode=Z,n.precision=De}}}for(let m=0;m<s.length;m++)n.assign(s[m],void 0);return n.popScope(),n.swapScope(d),o??void 0}var be=class n extends L{constructor(i,t,r,o){o??(o={}),o.canonical??(o.canonical=!1);super(i,o.metadata);this._result=void 0;this._head=t,this._ops=r,o.canonical&&(this._canonical=this,this.bind()),i._register(this)}get hash(){if(this._hash!==void 0)return this._hash;let i=0;for(let t of this._ops)i=i<<1^t.hash|0;return typeof this._head=="string"?i=i^xe(this._head)|0:i=i^this._head.hash|0,this._hash=i,i}infer(i){let t=this._def;return!t||!t.signature.inferredSignature?!1:(typeof t.signature.result!="function"&&(t.signature.result=mt(t.signature.result,i)),!0)}bind(){this._def=void 0,this._scope=this.engine.context;let i=this._head;if(typeof i!="string"){i.bind();return}this._def=this.engine.lookupFunction(i);for(let t of this._ops)t.bind()}reset(){}get isExact(){return Li(this)&&this.op1.isExact}get isCanonical(){return this._canonical===this}set isCanonical(i){this._canonical=i?this:void 0}get isPure(){if(this._isPure!==void 0)return this._isPure;if(!this.isCanonical)return this._isPure=!1,!1;let i=this.functionDefinition?.pure??!1;return i&&(i=this._ops.every(t=>t.isPure)),this._isPure=i,i}get json(){return this.isValid&&this._canonical===this?gu(this.engine,this._head,this._ops,{latex:this._latex,wikidata:this.wikidata}):O(this.engine,this._head,this._ops,{latex:this._latex,wikidata:this.wikidata})}get rawJson(){return[typeof this._head=="string"?this._head:this._head.rawJson,...this.ops.map(t=>t.rawJson)]}get scope(){return this._scope}get head(){return this._head}get ops(){return this._ops}get nops(){return this._ops.length}get op1(){return this._ops[0]??this.engine.Nothing}get op2(){return this._ops[1]??this.engine.Nothing}get op3(){return this._ops[2]??this.engine.Nothing}get isValid(){return this._head==="Error"||typeof this._head!="string"&&!this._head.isValid?!1:this._ops.every(i=>i?.isValid)}get canonical(){return this._canonical??(this._canonical=this.isValid?_r(this.engine,this._head,this._ops):this),this._canonical}*map(i){let t=0;for(;t<this._ops.length;)yield i(this._ops[t++])}subs(i,t){t=t?{...t}:{},"canonical"in t||(t.canonical=!0);let r=this._ops.map(o=>o.subs(i,t));return t.canonical&&r.every(o=>o.isValid)?_r(this.engine,this._head,r):new n(this.engine,this._head,r,{canonical:!1})}replace(i,t){return rr(this,i,t)}has(i){if(typeof this._head=="string"){if(typeof i=="string"){if(this._head===i)return!0}else if(i.includes(this._head))return!0}for(let t of this._ops)if(t.has(i))return!0;return!1}isSame(i){if(this===i)return!0;if(!(i instanceof n)||this.nops!==i.nops)return!1;if(typeof this.head=="string"){if(this.head!==i.head)return!1}else if(typeof i.head=="string"||!i.head||!this.engine.box(this.head).isSame(this.engine.box(i.head)))return!1;let t=this._ops,r=i._ops;for(let o=0;o<t.length;o++)if(!t[o].isSame(r[o]))return!1;return!0}match(i,t){if(!(i instanceof n))return null;let r={};if(typeof this.head=="string"){if(this.head!==i.head)return null}else{if(typeof i.head=="string")return null;{if(!i.head)return null;let a=this.head.match(i.head,t);if(a===null)return null;r={...r,...a}}}let o=this._ops,s=i._ops;for(let a=0;a<o.length;a++){let u=o[a].match(s[a],t);if(u===null)return null;r={...r,...u}}return r}get complexity(){if(this.isCanonical)return this.functionDefinition?.complexity??pn}get baseDefinition(){return this.functionDefinition}get functionDefinition(){return this._def}isEqual(i){if(this===i)return!0;let t=ni(this,i);return t===0?!0:t!==void 0?!1:this.engine.add(this,this.engine.neg(i)).simplify().isZero?!0:this.isSame(i)}get isNumber(){return this.domain?.isCompatible("Numbers")}get isInteger(){return this.domain?.isCompatible("Integers")}get isRational(){return this.domain?.isCompatible("RationalNumbers")}get isAlgebraic(){return this.domain?.isCompatible("AlgebraicNumbers")}get isReal(){return this.domain?.isCompatible("RealNumbers")}get isExtendedReal(){return this.domain?.isCompatible("ExtendedRealNumbers")}get isComplex(){return this.domain?.isCompatible("ComplexNumbers")}get isImaginary(){return this.domain?.isCompatible("ImaginaryNumbers")}get domain(){if(this._result!==void 0)return this._result;if(!this.canonical)return;let i=this.engine,t;if(typeof this._head!="string")t=this._head.domain;else if(this._def){let r=this._def.signature;typeof r.result=="function"?t=r.result(i,this._ops):t=r.result}return t??(t=void 0),this._result=t,t}simplify(i){if(!this.isValid)return this;if(!this.isCanonical){let f=this.canonical;return!f.isCanonical||!f.isValid?this:f.simplify(i)}let t=i?.recursive??!0,r;if(t&&(r=rn(this),r!==null))return r=r.simplify({...i,recursive:!1}),Nt(this,r);let o=this.functionDefinition,s=t?vu(this._ops,o?.hold??"none",o?.associative?o.name:"",f=>f.simplify(i)):this._ops;if(typeof this._head!="string"){let f=ui(this._head,s);return typeof f.head!="string"?f:f.simplify(i)}if(o)if(o.inert)r=s[0]?.canonical??this;else{let f=o.signature;f?.simplify&&(r=f.simplify(this.engine,s))}r?r=Nt(this.engine.box([this._head,...s]),r):r=this.engine.box([this._head,...s]),r=Nt(this,r);let a=i?.rules??this.engine.cache("standard-simplification-rules",()=>ti(this.engine,bu),f=>{for(let[d,c,m,g]of f)d.reset(),c.reset();return f}),u=0,l=!1;do{let f=r.replace(a);f!==null?(r=Nt(r,f),r===f&&(l=!0)):l=!0,u+=1}while(!l&&u<this.engine.iterationLimit);return Nt(this,r)}evaluate(i){if(!this.isValid)return this;if(i?.numericMode){let a=this.head;if(a==="Integrate"||a==="Limit")return this.engine.box(["N",this],{canonical:!0}).evaluate(i)}if(!this.isCanonical){this.engine.pushScope();let a=this.canonical;return this.engine.popScope(),!a.isCanonical||!a.isValid?this:a.evaluate(i)}let t=this.functionDefinition;if(t?.threadable&&this.ops.some(a=>ue(a))){let a=Math.max(...this._ops.map(l=>l.functionDefinition?.size?.(l)??0)),u=[];for(let l=0;l<=a-1;l++){let f=this._ops.map(d=>ue(d)?Ga(d,l%a+1)??this.engine.Nothing:d);u.push(this.engine._fn(this.head,f).evaluate(i))}return u.length===0?this.engine.box(["Sequence"]):u.length===1?u[0]:this.engine._fn("List",u)}let r=vu(this._ops,t?.hold??"none",t?.associative?t.name:"",a=>a.evaluate(i));if(t?.inert)return r[0]??this;let o;typeof this._head!="string"&&(o=ui(this._head,r));let s=t?.signature;if(!o&&s){let a=i?.numericMode??!1,u=this.engine.swapScope(this.scope);a&&s.N&&(o=s.N(this.engine,r)),!o&&s.evaluate&&(o=s.evaluate(this.engine,r)),this.engine.swapScope(u)}if(o){let a=o.numericValue;a!==null&&(!ae(this.engine)&&a instanceof Nu.Complex?o=this.engine.NaN:!F(this.engine)&&a instanceof v&&(o=this.engine.number(a.toNumber())))}return o??this.engine.box([this._head,...r])}N(i){return this.evaluate({...i,numericMode:!0})}solve(i){return i.length!==1?null:xr(this.simplify(),i[0])}};function gd(n,e,i,t){let r=[];if(e==="Add"||e==="Multiply")r=Pe(n,n.canonical(i),{flatten:e});else if(e==="Negate"||e==="Square"||e==="Sqrt"||e==="Exp"||e==="Ln")r=Pe(n,n.canonical(i),1);else if(e==="Divide"||e==="Power")r=Pe(n,n.canonical(i),2);else return null;if(!r.every(o=>o.isValid))return n._fn(e,r,t);if(e==="Add")return In(n,te(se(r),"Add"));if(e==="Negate")return ge(r[0]);if(e==="Multiply")return Et(n,te(se(r),"Multiply"));if(e==="Divide")return on(n,r[0].canonical,r[1].canonical);if(e==="Exp")return kn(n,n.E,r[0].canonical);if(e==="Power")return kn(n,r[0].canonical,r[1].canonical);if(e==="Square")return kn(n,r[0].canonical,n.number(2));if(e==="Sqrt"){let o=r[0].canonical;return U(o.numericValue)?n._fn("Sqrt",[o],t):kn(n,o,n.Half)}return e==="Ln"?n._fn("Ln",r,t):null}function _r(n,e,i,t){if(typeof e!="string"&&(n.pushScope(),e=e.evaluate().symbol??e,n.popScope()),typeof e=="string"){let u=gd(n,e,i,t);if(u)return u}else if(!e.isValid)return new be(n,e,i.map(u=>n.box(u,{canonical:!1})),{metadata:t,canonical:!1});let r=n.lookupFunction(e);if(!r)return new be(n,e,se(i.map(u=>n.box(u))),{metadata:t,canonical:!0});let o=[];for(let u=0;u<i.length;u++)if(!Bn(r.hold,i.length-1,u))o.push(n.box(i[u]));else{let l=n.box(i[u],{canonical:!1});l.head==="ReleaseHold"?o.push(l.op1.canonical):o.push(l)}let s=r.signature;if(s.canonical){try{let u=s.canonical(n,o);if(u)return u}catch(u){console.error(u)}return new be(n,e,o,{metadata:t,canonical:!1})}o=se(o),r.associative&&(o=te(o,e));let a=Za(n,o,r.hold,r.threadable,s.params,s.optParams,s.restParam);if(a)return n._fn(e,a,t);if(o.length===1&&o[0].head===e){if(r.involution)return o[0].op1;r.idempotent&&(o=o[0].ops)}return o.length>1&&r.commutative===!0&&(o=o.sort(tn)),n._fn(e,o,t)}function vu(n,e,i,t){if(n.length===0)return[];if(n=te(n,i),e==="all")return n;if(e==="none"){let o=[];for(let s of n){let a=s.head;if(a==="Hold")o.push(s);else{let u=a==="ReleaseHold"?s.op1:s;if(u){let l=t(u);l!==null&&o.push(l)}}}return te(o,i)}let r=[];for(let o=0;o<n.length;o++)if(n[o].head==="Hold")r.push(n[o]);else{let s;if(n[o].head==="ReleaseHold"?s=n[o].op1:Bn(e,n.length-1,o)?r.push(n[o]):s=n[o],s){let a=t(s);a!==null&&r.push(a)}}return te(r,i)}function Nt(n,e){if(e==null||n===e)return n;let i=n.engine,t=i.box(e);return i.costFunction(t)<=1.2*i.costFunction(n)?t:n}var Re=pe(ce(),1);var xd=0x3ffffffffffe5;function jn(n){if(!Number.isInteger(n)||!Number.isFinite(n)||Number.isNaN(n)||n<=1)return!1;if(n<=ka)return No.has(n);for(let e of No)if(n%e===0)return!1;return n>=xd?yd(n,30)?void 0:!1:n===bd(n)}function bd(n){if(n===1)return 1;if(n%2===0)return 2;if(n%3===0)return 3;if(n%5===0)return 5;let e=Math.floor(Math.sqrt(n)),i=7;for(;i<=e;){if(n%i===0)return i;if(n%(i+4)===0)return i+4;if(n%(i+6)===0)return i+6;if(n%(i+10)===0)return i+10;if(n%(i+12)===0)return i+12;if(n%(i+16)===0)return i+16;if(n%(i+22)===0)return i+22;if(n%(i+24)===0)return i+24;i+=30}return n}function yd(n,e){let i=0,t=n-1;for(;t%2===0;)t/=2,++i;e:do{let r=Math.pow(2+Math.floor(Math.random()*(n-3)),t)%n;if(!(r===1||r===n-1)){for(let o=i-1;o--;){if(r=r*r%n,r===1)return!1;if(r===n-1)continue e}return!1}}while(--e);return!0}var le=class n extends L{constructor(e,i,t){if(super(e,t?.metadata),typeof i=="number"){this._value=i,this._isCanonical=!0;return}if(U(i)){let[r,o]=i;typeof r!="number"||Number.isInteger(r)&&Number.isInteger(o),!(typeof r=="bigint"&&typeof o=="bigint")||o!==r&&BigInt(1),t?.canonical??!0?(this._value=Wo(e,i),this._isCanonical=!0):(this._value=i,this._isCanonical=!1)}else!(i instanceof Re.Complex)||!Number.isNaN(i.re)&&!Number.isNaN(i.im)&&e.chop(i.im),this._value=Wo(e,i),this._isCanonical=!0}get hash(){if(this._hash!==void 0)return this._hash;let e=0;return typeof this._value=="number"?e=xe(this._value.toString()):this._value instanceof Re.Complex?e=xe(this._value.re.toString()+" +i "+this._value.im.toString()):this._value instanceof v?e=xe(this._value.toString()):e=xe(this._value[0].toString()+" / "+this._value[1].toString()),this._hash=e,e}get head(){return"Number"}get isPure(){return!0}get isExact(){let e=this._value;return typeof e=="number"?Number.isInteger(e):e instanceof v?e.isInteger():e instanceof Re.Complex?Number.isInteger(e.re)&&Number.isInteger(e.im):U(e)}get isCanonical(){return this._isCanonical}set isCanonical(e){this._isCanonical=e}get complexity(){return 1}get numericValue(){return this._value}get domain(){return this._domain??(this._domain=this.engine.domain($a(this._value))),this._domain}get json(){return ai(this.engine,this._value,{latex:this._latex})}get sgn(){if(this._value===0)return 0;if(typeof this._value=="number")return this._value<0?-1:this._value>0?1:null;if(this._value instanceof v)return this._value.isZero()?0:this._value.isNegative()?-1:this._value.isPositive()?1:null;if(Array.isArray(this._value)){let[e,i]=this._value;return e===0&&i!==0?0:e<0?-1:e>0?1:null}return null}isSame(e){if(this===e)return!0;if(!(e instanceof n))return!1;if(typeof this._value=="number")return typeof e._value!="number"?!1:this._value===e._value;if(this._value instanceof v)return e._value instanceof v?this._value.eq(e._value):!1;if(Array.isArray(this._value)){if(!Array.isArray(e._value))return!1;let[i,t]=e._value;return this._value[0]===i&&this._value[1]===t}return this._value instanceof Re.Complex&&e._value instanceof Re.Complex?this._value.equals(e._value):!1}isEqual(e){return this===e||ni(this,e)===0}match(e,i){return this.isEqualWithTolerance(e,i?.numericTolerance??0)?{}:null}isEqualWithTolerance(e,i){return e instanceof n&&ni(this,e,i)===0}isLess(e){let i=ni(this,e);if(i!==void 0)return i<0}isLessEqual(e){let i=ni(this,e);if(i!==void 0)return i<=0}isGreater(e){return e.isLessEqual(this)}isGreaterEqual(e){return e.isLess(this)}get isPositive(){if(typeof this._value=="number")return this._value>0;let e=this.sgn;if(e!=null)return e>0}get isNonNegative(){if(typeof this._value=="number")return this._value>=0;let e=this.sgn;if(e!=null)return e>=0}get isNegative(){if(typeof this._value=="number")return this._value<0;let e=this.sgn;if(e!=null)return e<0}get isNonPositive(){if(typeof this._value=="number")return this._value<=0;let e=this.sgn;if(e!=null)return e<=0}get isZero(){return this._value===0?!0:this._value instanceof v?this._value.isZero():this._value instanceof Re.Complex?this._value.isZero():!1}get isNotZero(){return this._value===0?!1:this._value instanceof v?!this._value.isZero():this._value instanceof Re.Complex?!this._value.isZero():!0}get isOne(){return this._value===1?!0:typeof this._value=="number"?!1:this._value instanceof v?this._value.equals(this.engine._BIGNUM_ONE):this._value instanceof Re.Complex?this._value.im===0&&this._value.re===1:ie(this._value)}get isNegativeOne(){return this._value===-1?!0:typeof this._value=="number"?!1:this._value instanceof v?this._value.equals(this.engine._BIGNUM_NEGATIVE_ONE):this._value instanceof Re.Complex?this._value.im===0&&this._value.re===-1:Bi(this._value)}get isOdd(){if(this.isOne||this.isNegativeOne)return!0;if(this.isZero||!this.isInteger)return!1;if(typeof this._value=="number")return this._value%2!==0;if(this._value instanceof v)return!this._value.mod(2).isZero()}get isEven(){if(this.isOne||this.isNegativeOne)return!1;if(this.isZero)return!0;if(!this.isInteger)return!1;if(typeof this._value=="number")return this._value%2===0;if(this._value instanceof v)return this._value.mod(2).isZero()}get isPrime(){if(!this.isInteger||!this.isFinite||this.isNonPositive||this.isOne||this.isZero)return!1;if(typeof this._value=="number")return jn(this._value);if(this._value instanceof v)return jn(this._value.toNumber())}get isComposite(){if(!this.isInteger||!this.isFinite||this.isNonPositive||this.isOne||this.isZero)return!1;if(typeof this._value=="number")return!jn(this._value);if(this._value instanceof v)return!jn(this._value.toNumber())}get isInfinity(){return typeof this._value=="number"?!Number.isFinite(this._value)&&!Number.isNaN(this._value):this._value instanceof v?!this._value.isFinite()&&!this._value.isNaN():this._value instanceof Re.Complex?!this._value.isFinite()&&!this._value.isNaN():!1}get isNaN(){return typeof this._value=="number"?Number.isNaN(this._value):this._value instanceof v?this._value.isNaN():this._value instanceof Re.Complex?this._value.isNaN():!1}get isFinite(){return!this.isInfinity&&!this.isNaN}get isNumber(){return!0}get isInteger(){return typeof this._value=="number"?Number.isInteger(this._value):this._value instanceof v?this._value.isInteger():!1}get isRational(){return Array.isArray(this._value)?!0:this.isInteger}get isAlgebraic(){if(this.isRational)return!0}get isReal(){return this.isFinite?this._value instanceof Re.Complex?this.engine.chop(this._value.im)===0:!0:!1}get isExtendedReal(){return this.isInfinity||this.isReal}get isComplex(){return!this.isNaN}get isImaginary(){return this._value instanceof Re.Complex?(this._value.im,!0):!1}get isExtendedComplex(){return this.isInfinity||!this.isNaN}get canonical(){return this._isCanonical?this:this.engine.number(Wo(this.engine,this._value))}simplify(e){return this.canonical}evaluate(e){return e?.numericMode?this.N(e):this}N(e){if(!Array.isArray(this._value))return this;let i=this.engine,[t,r]=this._value;return typeof t=="number"&&typeof r=="number"&&!F(i)?i.number(t/r):i.number(i.bignum(t).div(i.bignum(r)))}};function Wo(n,e){if(e instanceof v&&br(e))return e.toNumber();if(!U(e))return e;if(e=je(e),K(e)){let[r,o]=e;if(r>Number.MIN_SAFE_INTEGER&&r<Number.MAX_SAFE_INTEGER&&o>Number.MIN_SAFE_INTEGER&&o<Number.MAX_SAFE_INTEGER)e=[Number(r),Number(o)];else return o<0&&([r,o]=[-r,-o]),o===BigInt(1)?n.bignum(r):o===BigInt(0)?r===o?NaN:r<0?-1/0:1/0:[r,o]}let[i,t]=e;return Number.isNaN(i)||Number.isNaN(t)?NaN:(t<0&&([i,t]=[-i,-t]),t===1?i:t===0?i===0||!Number.isFinite(i)?NaN:i<0?-1/0:1/0:i===0?i:[i,t])}var gn=class n extends L{constructor(e,i,t){super(e,t),this._string=i.normalize(),e._register(this)}get hash(){return xe("String"+this._string)}get json(){return xu(this.engine,this._string)}get head(){return"String"}get isPure(){return!0}get isCanonical(){return!0}set isCanonical(e){}get domain(){return this.engine.Strings}get complexity(){return 19}get string(){return this._string}isEqual(e){return e.string===this._string}isSame(e){return e.string===this._string}match(e,i){return e instanceof n&&this._string===e._string?{}:null}};var Ko=pe(ce(),1);function Sr(n,e){switch(e){case"float64":case"float32":case"int32":case"uint8":return new Yo(n);case"complex128":case"complex64":return new Xo(n);case"bool":case"string":case"expression":return new Qo(n)}throw new Error(`Unknown dtype ${e}`)}var Yo=class{constructor(e){this.ce=e;this.one=1;this.zero=0;this.nan=NaN}cast(e,i){let t=this.ce;switch(i){case"float64":case"float32":case"int32":case"uint8":return e;case"complex128":case"complex64":return Array.isArray(e)?e.map(r=>t.complex(r)):this.ce.complex(e);case"bool":return Array.isArray(e)?e.map(r=>r!==0):e!==0;case"string":return Array.isArray(e)?e.map(r=>Number(r).toString()):Number(e).toString();case"expression":return Array.isArray(e)?e.map(r=>t.number(r)):t.number(e)}throw new Error(`Cannot cast ${e} to ${i}`)}expression(e){return this.ce.number(e)}isZero(e){return e===0}isOne(e){return e===1}equals(e,i){return e===i}add(e,i){return e+i}addn(...e){return e.reduce((i,t)=>i+t,0)}neg(e){return-e}sub(e,i){return e-i}mul(e,i){return e*i}muln(...e){return e.reduce((i,t)=>i*t,1)}div(e,i){return e/i}pow(e,i){return e**i}conjugate(e){return e}},Qo=class{constructor(e){this.one=e.One,this.zero=e.Zero,this.nan=e.NaN,this.ce=e}cast(e,i){if(Array.isArray(e))return e.map(r=>this.cast(r,i));let t=e.value;switch(i){case"float64":case"float32":return typeof t=="number"?t:void 0;case"int32":return typeof t=="number"?Math.round(t):void 0;case"uint8":if(typeof t!="number")return;let r=Math.round(t);return r>=0&&r<=255?r:void 0;case"complex128":case"complex64":if(typeof t=="number")return this.ce.complex(t);let o=e.numericValue;return o instanceof Ko.default?o:void 0;case"bool":return typeof t=="boolean"?t:void 0;case"string":return typeof t=="string"?t:void 0;case"expression":return e}throw new Error(`Cannot cast ${e} to ${i}`)}expression(e){return e}isZero(e){return e.isZero??!1}isOne(e){return e.isOne??!1}equals(e,i){return e.isEqual(i)}add(e,i){return this.ce.add(e,i)}addn(...e){return this.ce.add(...e)}neg(e){return this.ce.neg(e)}sub(e,i){return this.ce.add(e,this.ce.neg(i))}mul(e,i){return this.ce.mul(e,i)}muln(...e){return this.ce.mul(...e)}div(e,i){return this.ce.div(e,i)}pow(e,i){return this.ce.pow(e,i)}conjugate(e){return this.ce.box(["Conjugate",e])}},Xo=class{constructor(e){this.ce=e,this.one=e.complex(1),this.zero=e.complex(0),this.nan=e.complex(NaN)}cast(e,i){if(Array.isArray(e))return e.map(t=>this.cast(t,i));switch(i){case"float64":return e.im===0?e.re:void 0;case"float32":return e.im===0?e.re:void 0;case"int32":return e.im===0?Math.round(e.re):void 0;case"uint8":if(e.im!==0)return;let t=Math.round(e.re);return t>=0&&t<=255?t:void 0;case"complex128":return e;case"complex64":return e;case"bool":return!(e.im===0&&e.re===0);case"string":return e.toString();case"expression":return this.ce.number(e)}throw new Error(`Cannot cast ${e} to ${i}`)}expression(e){return this.ce.number(e)}isZero(e){return e.isZero()}isOne(e){return e.re===1&&e.im===0}equals(e,i){return e.equals(i)}add(e,i){return e.add(i)}addn(...e){return e.reduce((i,t)=>i.add(t),this.zero)}neg(e){return e.neg()}sub(e,i){return e.sub(i)}mul(e,i){return e.mul(i)}muln(...e){return e.reduce((i,t)=>i.mul(t),this.one)}div(e,i){return e.div(i)}pow(e,i){return e.pow(i)}conjugate(e){return e.conjugate()}};function Tr(n,e){return n===e?n:n==="string"||e==="string"||n==="expression"||e==="expression"?"expression":n==="complex128"||e==="complex128"?"complex128":n==="complex64"||e==="complex64"?"complex64":n==="float64"||e==="float64"?"float64":n==="float32"||e==="float32"?"float32":n==="int32"||e==="int32"?"int32":n==="uint8"||e==="uint8"?"uint8":n==="bool"||e==="bool"?"bool":"expression"}function es(n){let e=n.value;if(typeof e=="number")return Number.isInteger(e)?e>=0&&e<=255?"uint8":"int32":"float64";let i=n.numericValue;return i!==null&&i instanceof Ko.default?"complex128":n.string?"string":"expression"}var Zn=class n{constructor(e,i){this.ce=e;this.shape=i.shape,this.rank=this.shape.length,this._strides=Ed(this.shape),this.field=Sr(e,i.dtype)}static align(e,i){if(e.dtype===i.dtype)return[e,i];let t=Tr(e.dtype,i.dtype);return e.dtype===t?[e,i.upcast(t)]:[e.upcast(t),i]}static broadcast(e,i,t){if(!(t instanceof n))return i.map1(e,t);let[r,o]=n.align(i,t),s=r.data.map((a,u)=>e(a,o.data[u]));return xn(r.ce,{dtype:r.dtype,shape:r.shape,data:s})}get expression(){let e=this.shape,i=this.rank,t=this.data,r=this._index.bind(this),o=this.field.expression.bind(this.field),s=a=>{if(a.length===i-1){let u=r(a),l=this.ce._fn("List",t.slice(u,u+e[i-1]).map(f=>o(f)));return l.isCanonical=l.ops.every(f=>f.isCanonical),l}else{let u=[];for(let f=0;f<=e[a.length]-1;f++)u.push(s([...a,f+1]));let l=this.ce._fn("List",u);return l.isCanonical=l.ops.every(f=>f.isCanonical),l}};return s([])}get array(){let e=this.shape,i=this.rank,t=this.data;if(i===1)return t;if(i===2){let[s,a]=e,u=new Array(s);for(let l=0;l<s;l++)u[l]=t.slice(l*a,(l+1)*a);return u}let r=this._index.bind(this),o=s=>{if(s.length===i-1){let a=r(s);return t.slice(a,a+e[i-1])}else{let a=[];for(let u=0;u<e[s.length];u++)a.push(o([...s,u+1]));return a}};return o([])}_index(e){let i=this._strides;return e.reduce((t,r,o)=>t+(r-1)*i[o],0)}get isSquare(){let e=this.shape;return e.length===2&&e[0]===e[1]}get isSymmetric(){if(!this.isSquare)return!1;let e=this.shape[0],i=this.data,t=this.field.equals.bind(this.field);for(let r=0;r<e;r++)for(let o=r+1;o<e;o++)if(!t(i[r*e+o],i[o*e+r]))return!1;return!0}get isSkewSymmetric(){if(!this.isSquare)return!1;let e=this.shape[0],i=this.data,t=this.field.equals.bind(this.field),r=this.field.neg.bind(this.field);for(let o=0;o<e;o++)for(let s=o+1;s<e;s++)if(!t(i[o*e+s],r(i[s*e+o])))return!1;return!0}get isUpperTriangular(){if(!this.isSquare)return!1;let e=this.shape[0],i=this.data,t=this.field.isZero.bind(this.field);for(let r=1;r<e;r++)for(let o=0;o<r;o++)if(t(i[r*e+o]))return!1;return!0}get isLowerTriangular(){if(!this.isSquare)return!1;let e=this.shape[0],i=this.data,t=this.field.isZero.bind(this.field);for(let r=0;r<e-1;r++)for(let o=r+1;o<e;o++)if(!t(i[r*e+o]))return!1;return!0}get isTriangular(){if(!this.isSquare)return!1;let e=this.shape[0],i=this.data,t=this.field.isZero.bind(this.field);for(let r=0;r<e;r++)for(let o=0;o<e;o++)if(r<o&&!t(i[r*e+o])||r>o&&!t(i[r*e+o]))return!1;return!0}get isDiagonal(){if(!this.isSquare)return!1;let e=this.shape[0],i=this.data,t=this.field.isZero.bind(this.field);for(let r=0;r<e;r++)for(let o=0;o<e;o++)if(r===o&&!t(i[r*e+o])||r!==o&&!t(i[r*e+o]))return!1;return!0}get isIdentity(){if(!this.isSquare)return!1;let[e,i]=this.shape,t=this.data,r=this.field.isOne.bind(this.field),o=this.field.isZero.bind(this.field);for(let s=0;s<i;s++)for(let a=0;a<i;a++)if(s===a&&!r(t[s*i+a])||s!==a&&!o(t[s*i+a]))return!1;return!0}get isZero(){let e=this.field.isZero.bind(this.field);return this.data.every(i=>e(i))}at(...e){let i=this.data.length;return this.data[this._index(e)%i]}diagonal(e,i){if(e??(e=1),i??(i=2),e===i||e<=0||e>this.shape.length||this.shape[e-1]!==this.shape[i-1])return;let t=new Array(this.shape[e-1]),r=this.data,o=this.shape[e-1];for(let s=0;s<o;s++)t[s]=r[s*o+s];return t}trace(e,i){if(this.rank!==2)return;let[t,r]=this.shape;if(t!==r)return;let o=this.data,s=new Array(t);for(let a=0;a<t;a++)s[a]=o[a*t+a];return this.field.addn(...s)}reshape(...e){return xn(this.ce,{dtype:this.dtype,shape:e,data:this.data})}flatten(){return this.data}upcast(e){let i=this.field.cast(this.data,e);if(i===void 0)throw Error(`Cannot cast tensor to ${e}`);return xn(this.ce,{dtype:e,shape:this.shape,data:i})}transpose(e,i,t){if(this.rank!==2)return;if(e??(e=1),i??(i=2),e===i)return this;if(e<=0||e>2||i<=0||i>2)return;let[r,o]=this.shape,s=this.data;t&&(s=s.map(f=>t(f)));let a=0,u=new Array(r*o),l=o;for(let f=0;f<o;f++)for(let d=0;d<r;d++)u[a++]=s[d*l+f];return xn(this.ce,{dtype:this.dtype,shape:[o,r],data:u})}conjugateTranspose(e,i){let t=this.field.conjugate.bind(this.field);return this.transpose(e,i,t)}determinant(){if(this.rank!==2)return;let[e,i]=this.shape;if(e!==i)return;if(e===1)return this.data[0];let t=this.field.add.bind(this.field),r=this.field.mul.bind(this.field),o=this.field.neg.bind(this.field);if(e===2){let[h,x,S,T]=this.data;return t(r(h,T),o(r(x,S)))}let s=this.field.addn.bind(this.field),a=this.field.muln.bind(this.field);if(e===3){let[h,x,S,T,_,w,j,Z,De]=this.data;return s([a(h,_,De),a(x,w,j),a(S,T,Z),o(a(S,_,j)),o(a(x,T,De)),o(a(h,w,Z))])}let u=this.shape[0],l=!1,f=this.field.div.bind(this.field),d=this.field.sub.bind(this.field),c=new Array(u).fill(0).map((h,x)=>x),m=[...this.data];for(let h=0;h<u;h++){let x=c[h-1];if(this.at(x,h)===0){let _;for(_=h+1;_<u;_++)if(this.at(c[_],h)!==0){x=c[_],c[_-1]=c[h-1],c[h-1]=x,l=!l;break}if(_===u)return this.at(x,h)}let S=this.at(x,h),T=h===0?1:this.at(c[h-2],h-2);for(let _=h+1;_<u;_++){let w=c[_-1];for(let j=h+1;j<u;j++)m[w][j]=f(d(r(m[w][j],S),r(m[w][h],m[x][j])),T)}}let g=m[c[u-1]][u-1];return l?this.field.neg(g):g}inverse(){if(this.rank!==2)return;let[e,i]=this.shape;if(e!==i)return;if(e===2){let[c,m,g,h]=this.data,x=this.determinant();if(x===void 0||this.field.isZero(x))return;let S=this.field.div.bind(this.field),T=this.field.neg.bind(this.field),_=[S(h,x),T(S(m,x)),T(S(g,x)),S(c,x)];return xn(this.ce,{dtype:this.dtype,shape:[i,i],data:_})}let t=this.shape[0],r=this.field.div.bind(this.field),o=this.field.sub.bind(this.field),s=this.field.mul.bind(this.field),a=this.array,u=new Array(t).fill(0).map((c,m)=>{let g=new Array(t).fill(0);return g[m]=1,g}),l=a.map((c,m)=>[...c,...u[m]]),f=new Array(t).fill(0).map((c,m)=>m);for(let c=0;c<t;c++){let m=f[c-1];if(this.at(m,c)===0){let x;for(x=c+1;x<t;x++)if(this.at(f[x],c)!==0){m=f[x],f[x-1]=f[c-1],f[c-1]=m;break}if(x===t)return}let g=this.at(m,c),h=c===0?1:this.at(f[c-2],c-2);for(let x=c+1;x<t;x++){let S=f[x-1];for(let T=c+1;T<t*2;T++)l[S][T]=o(l[S][T],s(r(s(l[S][c],l[m][T]),g),h))}}for(let c=t-1;c>=0;c--){let m=l[f[c],c];for(let g=0;g<c;g++){let h=f[g];for(let x=t;x<t*2;x++)l[h][x]=o(l[h][x],s(r(s(l[h][c],l[c][x]),m),m))}for(let g=t;g<t*2;g++)l[c][g]=r(l[c][g],m)}let d=l.map(c=>c.slice(t));return xn(this.ce,{dtype:this.dtype,shape:[i,i],data:d})}pseudoInverse(){}adjugateMatrix(){}minor(e,i){}map1(e,i){return xn(this.ce,{dtype:this.dtype,shape:this.shape,data:this.data.map(t=>e(t,i))})}map2(e,i){let t=i.data;return xn(this.ce,{dtype:this.dtype,shape:this.shape,data:this.data.map((r,o)=>e(r,t[o]))})}add(e){return n.broadcast(this.field.add.bind(this.field),this,e)}subtract(e){return n.broadcast(this.field.sub.bind(this.field),this,e)}multiply(e){return n.broadcast(this.field.mul.bind(this.field),this,e)}divide(e){return n.broadcast(this.field.div.bind(this.field),this,e)}power(e){return n.broadcast(this.field.pow.bind(this.field),this,e)}equals(e){if(this.rank!==e.rank||!this.shape.every((o,s)=>o===e.shape[s]))return!1;let i=this.field.equals.bind(this.field),t=this.field.cast.bind(this.field),r=this.dtype;return this.dtype!==e.dtype?!!this.data.every((o,s)=>i(o,t(e.data[s],r))):this.data.every((o,s)=>i(o,e.data[s]))}};function Ed(n){let e=new Array(n.length);for(let i=n.length-1,t=1;i>=0;i--)e[i]=t,t*=n[i];return e}var ns=class extends Zn{constructor(i,t){super(i,t);this.dtype="float64";this.data=t.data}get isZero(){return this.data.every(i=>i===0)}},is=class extends Zn{constructor(i,t){super(i,t);this.dtype="complex128";this.data=t.data}},ts=class extends Zn{constructor(i,t){super(i,t);this.dtype="bool";this.data=t.data}},rs=class extends Zn{constructor(i,t){super(i,t);this.dtype="expression";this.data=t.data}};function xn(n,e){let i=e.dtype;return i==="float64"||i==="float32"||i==="uint8"||i==="int32"?new ns(n,e):i==="bool"?new ts(n,e):i==="complex64"||i==="complex128"?new is(n,e):new rs(n,e)}var _t=class n extends L{constructor(e,i,t){t??(t={}),t.canonical??(t.canonical=!0),super(e,t.metadata),i instanceof Zn?this._tensor=i:(this._head=i.head??"List",this._ops=t.canonical?e.canonical(i.ops):i.ops,this._expression=new be(e,this._head,this._ops,{canonical:t.canonical})),e._register(this)}get expression(){return this._expression??(this._expression=this._tensor.expression),this._expression}get tensor(){if(this._tensor===void 0){this._head,this._ops;let e=vd(this._head,this._ops);if(e===void 0)throw new Error("Invalid tensor");this._tensor=xn(this.engine,e)}return this._tensor}get baseDefinition(){return this.expression.baseDefinition}get functionDefinition(){return this.expression.functionDefinition}bind(){this.expression.bind()}reset(){}get hash(){return xe("BoxedTensor")}get canonical(){return this.isCanonical?this:new n(this.engine,{head:this._head,ops:this._ops},{canonical:!0})}get isCanonical(){return this._tensor?!0:this._expression.isCanonical}set isCanonical(e){this._tensor||(this.expression.isCanonical=e)}get isPure(){return this._tensor?!0:this.expression.isPure}get isValid(){return this._tensor?!0:this.expression.isValid}get complexity(){return 97}get head(){return this._tensor?"List":this._head}get nops(){return this._tensor?this._tensor.shape[0]:this.expression.nops}get ops(){return this.expression.ops}get op1(){if(this._tensor){let e=this._tensor.data;return e.length===0?this.engine.Nothing:this.engine.box(e[0])}return this.expression.op1}get op2(){if(this._tensor){let e=this._tensor.data;return e.length<2?this.engine.Nothing:this.engine.box(e[1])}return this.expression.op2}get op3(){if(this._tensor){let e=this._tensor.data;return e.length<3?this.engine.Nothing:this.engine.box(e[2])}return this.expression.op3}get shape(){return this.tensor.shape}get rank(){return this.tensor.rank}get domain(){return this._tensor?this.engine.domain("Lists"):this.expression.domain}get json(){return this.expression.json}get rawJson(){return this.expression.rawJson}isSame(e){return this===e?!0:e instanceof n?this.tensor.equals(e.tensor):this.expression.isSame(e)}isEqual(e){return this===e?!0:e instanceof n?this.tensor.equals(e.tensor):this.expression.isEqual(e)}match(e,i){return this.expression.match(e,i)}evaluate(e){return this._tensor?this:this.expression.evaluate(e)}simplify(e){return this._tensor?this:this.expression.simplify(e)}N(e){return this._tensor?this:this.expression.N(e)}};function Le(n){return n instanceof _t}function os(n,e){let i,t=[],r=!0,o=(s,a=0)=>{if(s.length!==0){s.length>1&&t[a]!==void 0?r=r&&t[a]===s.length:t[a]=Math.max(t[a]??0,s.length);for(let u of s)if(u.head===n?o(u.ops,a+1):i===void 0?i=es(u):i=Tr(i,es(u)),!r)return}};if(o(e),!!r)return{shape:t,dtype:i}}function vd(n,e){let{shape:i,dtype:t}=os(n,e)??{shape:[],dtype:void 0};if(t===void 0)return;let r=!0,o=[],s=Sr(e[0].engine,"expression"),a=s.cast.bind(s),u=l=>{for(let f of l)if(f.head===n)u(f.ops);else{let d=a(f,t);if(d===void 0){r=!1;return}o.push(d)}};if(u(e),!!r)return{shape:i,data:o,dtype:t}}function St(n){return n[Math.floor(Math.random()*n.length)]}function _u(n,e){if(n==="Add"||n==="Multiply"){let i=[],t=1+Math.floor(Math.random()*12);for(;t>0;)i.push(bn(e+1)),t-=1;return[n,...i]}return n==="Divide"||n==="Power"?[n,bn(e+1),bn(e+1)]:n==="Root"?[n,bn(e+1),bn(10)]:n==="trig"?Nd():[n,bn(e+1)]}function Nd(){return[St(["Cos","Sin","Tan","Sinh","Arccos","Arsinh"]),St(["Pi","-1","0","1",["Divide","Pi",-5],["Multiply",-2,["Divide","Pi",11]],["Multiply","Half","Pi"],["Multiply",5,"Pi"],["Multiply",12,"Pi"],["Divide","Pi",5],["Divide","Pi",9],["Multiply",5,["Divide","Pi",9]],["Multiply",2,["Divide","Pi",11]],["Multiply",2,["Divide","Pi",3]]])]}function bn(n){if(n??(n=1),n===1){let e=St([["Sqrt",["Multiply",6,["Sum",["Divide",1,["Power","n",2]],["Triple",["Hold","n"],1,{num:"+Infinity"}]]]],"Add","Add","Add","Add","Add","Multiply","Multiply","Multiply","Multiply","Divide","Divide","Divide","Root","Sqrt","Subtract","Negate","trig"]);return typeof e=="string"?_u(e,1):e}if(n===2){let e=Math.random();if(e>.75)return bn(1);if(e>.5)return bn(3);let i=St(["Multiply","Multiply","Add","Power","trig","Ln","Exp"]);return _u(i,2)}return St([-12345e-9,-2,-2,-2,-3,-5,-6,-12,-1654e-60,0,0,12345e-8,1654e-60,1,2,2,2,2,3,3,5,5,6,6,1234.5678,5678.1234,10,15,18,30,60,1234e54,"123456789.12345678912345e200","987654321.12345678912345",["Rational",-6,10],["Rational",-12,15],["Rational",-15,12],["Rational",3,5],["Rational",12,15],["Rational",15,12],"ExponentialE",["Sqrt",3],["Sqrt",5],["Sqrt",15],["Sqrt",25],["Complex",-1.1,1.1],["Complex",4,5],"x","x","x","x",["Add","x",1],["Divide","x",3],["Square","x"],["Power","x",3],["Power","x",4],["Subtract","x",1],["Add","x",1],"Pi"])}var Su=[{Nothing:{domain:"NothingDomain"}},{InvisibleOperator:{complexity:9e3,hold:"all",signature:{restParam:"Anything",result:(n,e)=>e.length===0?n.domain("NothingDomain"):e.length===1?e[0].domain:n.Anything,canonical:Br}},Sequence:{hold:"all",signature:{restParam:"Anything",result:(n,e)=>e.length===0?n.domain("NothingDomain"):e.length===1?e[0].domain:n.Anything,canonical:(n,e)=>{let i=me(se(e));return i.length===0?n._fn("Sequence",[]):i.length===1?i[0]:n._fn("Sequence",i)}}},Delimiter:{complexity:9e3,hold:"all",signature:{params:["Anything"],optParams:["Strings"],result:(n,e)=>e[0].domain,canonical:(n,e)=>{if(e.length===0)return n._fn("Tuple",[]);let i=e[0];return i.head==="Sequence"?i=n._fn("Sequence",n.canonical(i.ops)):i=i.canonical,i.head==="Sequence"&&i.ops.length===1&&(i=i.ops[0]),e=[i,...e.slice(1)],e.length===1?n._fn("Delimiter",e):e.length>2?n._fn("Delimiter",Se(n,e,2)):(e[1].string?.length??0)>3?n._fn("Delimiter",[e[0],n.error("invalid-delimiter",e[1])]):n._fn("Delimiter",[e[0],Fe(n,e[1],"Strings")])},evaluate:(n,e)=>{if(e.length===0)return n.Nothing;let i=e[0];return(i.head==="Sequence"||i.head==="Delimiter")&&(e=se(e[0].ops)),e.length===1?e[0].evaluate():n._fn("Tuple",e.map(t=>t.evaluate()))},N:(n,e)=>{if(e.length===0)return n.Nothing;let i=e[0];return(i.head==="Sequence"||i.head==="Delimiter")&&(e=se(e[0].ops)),e.length===1?e[0].N():n._fn("Tuple",e.map(t=>t.N()))}}},Error:{hold:"all",complexity:500,signature:{domain:["FunctionOf","Anything",["OptArg","Anything"],"Void"],canonical:(n,e)=>n._fn("Error",e)}},ErrorCode:{complexity:500,hold:"all",signature:{domain:["FunctionOf","Strings",["VarArg","Anything"],"Anything"],canonical:(n,e)=>{let i=Fe(n,e[0],n.Strings).string;return i==="incompatible-domain"?n._fn("ErrorCode",[n.string(i),e[1],e[2]]):n._fn("ErrorCode",e)}}},Hold:{hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],result:(n,e)=>{let i=e[0];return i.symbol?n.domain("Symbols"):i.string?n.domain("Strings"):i.head==="Numbers"?n.domain("Numbers"):i.domain},canonical:(n,e)=>e.length!==1?null:n.hold(e[0]),evaluate:(n,e)=>e[0]}},HorizontalSpacing:{signature:{domain:"Functions",canonical:(n,e)=>e.length===2?e[0].canonical:n.box(["Sequence"])}},Style:{complexity:9e3,inert:!0,signature:{domain:["FunctionOf","Anything",["OptArg","Dictionaries"],"Anything"]}}},{About:{signature:{domain:"Functions"}},Head:{hold:"all",signature:{domain:"Functions",canonical:(n,e)=>{if(e.length!==1)return null;let i=e[0];return i.head?n.box(i.head):n._fn("Head",me(e))},evaluate:(n,e)=>{let i=e[0];return typeof i?.head=="string"?n.symbol(i.head):i?.head??n.Nothing}}},Tail:{hold:"all",signature:{domain:"Functions",canonical:(n,e)=>{if(e.length!==1)return null;let i=e[0];return i.ops?n._fn("Sequence",i.ops):n._fn("Tail",me(e))},evaluate:(n,e)=>{let i=e[0];return i?.ops?n.box(["Sequence",...i.ops]):n.box(["Sequence"])}}},Identity:{signature:{domain:["FunctionOf","Anything","Anything"],result:(n,e)=>e[0].domain,evaluate:(n,e)=>e[0]}}},{Apply:{signature:{domain:"Functions",canonical:(n,e)=>e[0].symbol?n.box([e[0].symbol,...e.slice(1)]):n._fn("Apply",e),evaluate:(n,e)=>ui(e[0],e.slice(1))}},Assign:{hold:"all",pure:!1,signature:{domain:["FunctionOf","Anything","Anything","Anything"],canonical:(n,e)=>{if(e.length!==2)return null;let i=e[0];if(!i.symbol)return null;let t=e[1];return n._fn("Assign",[i,t])},evaluate:(n,e)=>{let i=e[0],t=e[1];if(!i.symbol)return n.Nothing;let r=t.evaluate();return n.assign(i.symbol,r),r}}},Assume:{hold:"all",pure:!1,signature:{domain:["FunctionOf","Anything","Anything"],evaluate:(n,e)=>n.string(n.assume(e[0]))}},Declare:{hold:"all",pure:!1,signature:{domain:["FunctionOf","Symbols","Anything"],canonical:(n,e)=>{if(e.length!==2)return null;let i=e[0],t=e[1];return i.symbol?t.symbol?n._fn("Declare",e):n._fn("Declare",[i,n._fn("Hold",[t])]):null},evaluate:(n,e)=>{let i=e[0],t=e[1];if(!i.symbol)return n.Nothing;let r=t.evaluate();if(mn(r))return n.declare(i.symbol,r),r}}},Domain:{signature:{domain:["FunctionOf","Anything","Domains"],evaluate:(n,e)=>e[0].domain}},Evaluate:{hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],result:(n,e)=>e[0].domain,canonical:(n,e)=>n._fn("Evaluate",Se(n,e,1)),evaluate:(n,e)=>e[0].evaluate()}},Function:{complexity:9876,hold:"all",signature:{domain:["FunctionOf","Anything",["VarArg","Symbols"],"Functions"],canonical:(n,e)=>e.length===0?n.box(["Sequence"]):(e.length===1?jo(e[0]):n._fn("Function",e))??null,evaluate:(n,e)=>{}}},Simplify:{hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],result:(n,e)=>e[0].domain,canonical:(n,e)=>n._fn("Simplify",Se(n,e,1)),evaluate:(n,e)=>e[0].simplify()}},CanonicalForm:{complexity:8200,hold:"all",signature:{domain:["FunctionOf","Anything",["VarArg","Symbols"],"Anything"],canonical:(n,e)=>{if(e.length===1)return e[0].canonical;let i=e.slice(1).map(t=>t.symbol??t.string).filter(t=>t!=null);return yn(e[0],i)}}},N:{hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],result:(n,e)=>e[0].domain,canonical:(n,e)=>{if(e.length!==1)return n._fn("N",Se(n,e,1));let i=e[0].head;if(i==="N")return e[0].canonical;if(i==="Integrate"){let[t,r,o]=zn(e[0].op2);if(!t||r===void 0||o===void 0)return null;let s=e[0].op1;return n._fn("NIntegrate",[n.box(["Function",s,t]),n.number(r),n.number(o)])}return i==="Limit"?n._fn("NLimit",e[0].ops):n._fn("N",e)},evaluate:(n,e)=>e[0].N()}},Signatures:{signature:{domain:["FunctionOf","Symbols",["ListOf","Domains"]],canonical:(n,e)=>(e=Se(n,e,1),e[0].symbol?n._fn("Signatures",e):n._fn("Signatures",[n.domainError("Symbols",e[0].domain,e[0])])),evaluate:(n,e)=>{let i=e[0].symbol;if(!i)return n.Nothing;let t=n.lookupFunction(i);if(!t)return n.box(["List"]);let r=t.signature,o=[...r.params];return r.optParams.length>0&&o.push(n._fn("OptArg",r.optParams)),r.restParam&&o.push(n._fn("VarArg",[r.restParam])),typeof r.result=="function"?o.push(r.result(n,[])??n.symbol("Undefined")):o.push(r.result),n.box(["List",...o])}}},Subscript:{hold:"last",signature:{domain:["FunctionOf","Anything","Anything","Anything"],result:(n,e)=>{let i=e[0],t=e[1];if(i.string&&q(t)!==null)return n.domain("Integers");if(i.symbol){let r=i.evaluate()?.head;if(r)return n.lookupFunction(r)?.at?void 0:n.domain("Symbols")}},canonical:(n,e)=>{let i=e[0],t=e[1];if(i.string){let r=q(t);if(r!==null&&r>1&&r<=36){let[o,s]=Si(i.string,r);return s?n.error(["unexpected-digit",{str:s[0]}],["LatexString",n.string(i.string)]):n.number(o)}}if(i.symbol){let r=i.evaluate()?.head;if(r&&n.lookupFunction(r)?.at)return n._fn("At",[i.canonical,t.canonical]);let o=t.string??t.symbol??q(t)?.toString();if(o)return n.symbol(i.symbol+"_"+o)}return t.head==="Sequence"&&n._fn("Subscript",[i,n._fn("List",t.ops)]),n._fn("Subscript",e)}}},Symbol:{complexity:500,description:"Construct a new symbol with a name formed by concatenating the arguments",threadable:!0,hold:"all",signature:{domain:["FunctionOf",["VarArg","Anything"],"Anything"],canonical:(n,e)=>{if(e.length===0)return n.Nothing;let i=e.map(t=>t.symbol??t.string??q(t)?.toString()??"").join("");return i.length>0?n.symbol(i):n.Nothing}}},Timing:{description:"`Timing(expr)` evaluates `expr` and return a `Pair` of the number of second elapsed for the evaluation, and the value of the evaluation",signature:{domain:["FunctionOf","Values",["OptArg","Integers"],["TupleOf","Values","Numbers"]],evaluate:(n,e)=>{if(e[1].symbol==="Nothing"){let u=globalThis.performance.now(),l=e[0].evaluate(),f=1e3*(globalThis.performance.now()-u);return n.pair(n.number(f),l)}let i=Math.max(3,Math.round(q(e[1])??3)),t=[],r;for(;i>0;){let u=globalThis.performance.now();r=e[0].evaluate(),t.push(1e3*(globalThis.performance.now()-u)),i-=1}let o=Math.max(...t),s=Math.min(...t);t=t.filter(u=>u>s&&u<o);let a=t.reduce((u,l)=>u+l,0);return a===0?n.pair(n.number(o),r):n.pair(n.number(a/t.length),r)}}}},{LatexString:{inert:!0,signature:{domain:["FunctionOf","Strings","Strings"]}},Latex:{signature:{domain:["FunctionOf",["VarArg","Anything"],"Strings"],evaluate:(n,e)=>n.box(["LatexString",n.string(N(e.map(i=>i.latex)))])}},Parse:{description:"Parse a LaTeX string and evaluate to a corresponding expression",signature:{domain:["FunctionOf","Anything","Anything"],evaluate:(n,e)=>{if(e.length===0)return n.box(["Sequence"]);let i=e[0],t=i.string??i.head==="LatexString"?i.op1.string:"";return n.parse(t)??n.box(["Sequence"])}}}},{RandomExpression:{signature:{domain:"Functions",evaluate:(n,e)=>n.box(bn())}}}];function Br(n,e){if(e.length===0)return null;let i=e[0];if(e.length===1)return Br(n,[i.canonical]);if(e.length===2){let t=E(i);if(t!==null&&Number.isInteger(t)){let o=e[1];if(o.head==="Divide"||o.head==="Rational"){let[s,a]=[E(o.op1),E(o.op2)];if(s!==null&&a!==null&&s>0&&s<=1e3&&a>1&&a<=1e3&&Number.isInteger(s)&&Number.isInteger(a))return n._fn("Add",[i.canonical,o.canonical])}}let r=e[1];if(i.symbol&&r.head==="Delimiter"&&!n.lookupSymbol(i.symbol))return n.lookupFunction(i.symbol)||n.declare(i.symbol,"Functions"),r.nops===0?n.box([i.symbol]):(r=r.op1,r.head==="Sequence"?n.box([i.symbol,...n.canonical(r.ops)]):n.box([i.symbol,r.canonical]))}return e=me(se(e)),e.every(t=>t.isValid&&(!t.domain||t.domain.isNumeric||sr(t)&&!t.string))?n._fn("Multiply",te(e,"Multiply")):n._fn("Tuple",e)}function yn(n,e){if(e===!1)return n;if(e===!0)return n.canonical;typeof e=="string"&&(e=[e]);for(let i of e)switch(i){case"InvisibleOperator":n=ss(n);break;case"Number":n=Bu(n);break;case"Multiply":n=Du(n);break;case"Add":n=Iu(n);break;case"Power":n=Vi(n);break;case"Divide":n=ku(n);break;case"Flatten":n=Tu(n);break;case"Order":n=Oo(n,{recursive:!0});break;default:throw Error("Invalid canonical form")}return n}function Tu(n){if(!n.ops)return n;let e=n.ops.map(Tu);n.head==="Delimiter"&&(e=[Do(n.engine,n.op1)]);let i=n.engine,t=n.head==="Add"||n.head==="Multiply";return t||i.lookupFunction(n.head)?.associative&&(t=!0),t&&typeof n.head=="string"&&(n=i._fn(n.head,te(e,n.head))),n}function ss(n){return n.ops?n.head==="InvisibleOperator"?Br(n.engine,n.ops.map(ss))??n:n.engine._fn(n.head,n.ops.map(ss)):n}function Bu(n){return n.numericValue?n.canonical:n.ops?n.engine._fn(n.head,n.ops.map(Bu)):n}function Du(n){if(!n.ops)return n;let e=n.ops.map(Du);return n.head==="Multiply"?Et(n.engine,e):n.head==="Negate"?Et(n.engine,[e[0],n.engine.NegativeOne]):n}function Iu(n){if(!n.ops)return n;let e=n.ops.map(Iu);return n.head==="Add"?In(n.engine,e):n.head==="Subtract"?In(n.engine,[e[0],n.engine.neg(e[1])]):n.engine._fn(n.head,e)}function Vi(n){return n.ops?n.head==="Power"?kn(n.engine,Vi(n.op1),Vi(n.op2)):n.ops?n.engine._fn(n.head,n.ops.map(Vi)):n:n}function ku(n){return n.head==="Divide"?on(n.engine,Vi(n.op1),Vi(n.op2)):n.ops?n.engine._fn(n.head,n.ops.map(ku)):n}function Ir(n,e,i){if(typeof e=="number"||e instanceof v)return new le(n,e,i);if(i=i?{...i}:{},"canonical"in i||(i.canonical=!0),Array.isArray(e)&&e.length===2&&e[0]instanceof v&&e[1]instanceof v){if(!e[0].isInteger()||!e[1].isInteger())throw new Error("Array argument to `boxNumber()` should be two integers");e=[P(e[0].toString()),P(e[1].toString())]}if(U(e)){if(e.length!==2)throw new Error("Array argument to `boxNumber()` should be two integers or two bignums");let[r,o]=e;if(typeof r=="bigint"&&typeof o=="bigint")return r===o?o===BigInt(0)?n.NaN:n.One:r===BigInt(0)?n.Zero:o===BigInt(1)?n.number(r,i):o===BigInt(-1)?n.number(-r,i):r===BigInt(1)&&o===BigInt(2)?n.Half:new le(n,[r,o],i);if(typeof r!="number"||typeof o!="number")throw new Error("Array argument to `boxNumber()` should be two integers or two bignums");if(!Number.isInteger(r)||!Number.isInteger(o))throw new Error("Array argument to `boxNumber()` should be two integers");return o===r?o===0?n.NaN:n.One:r===0?n.Zero:o===1?n.number(r,i):o===-1?n.number(-r,i):r===1&&o===2?n.Half:new le(n,[r,o],i)}if(e instanceof Dr.Complex)return e.isNaN()?n.NaN:e.isZero()?n.Zero:e.isInfinite()?n.ComplexInfinity:n.chop(e.im)===0?n.number(e.re,i):new le(n,e,i);let t="";if(typeof e=="string")t=e;else if(typeof e=="object"&&"num"in e){if(typeof e.num=="number")return n.number(e.num,i);if(typeof e.num!="string")throw new Error("MathJSON `num` property should be a string of digits");t=e.num}if(t){if(t=t.toLowerCase(),/[0-9][nd]$/.test(t)&&(t=t.slice(0,-1)),t=t.replace(/[\u0009-\u000d\u0020\u00a0]/g,""),t==="nan")return n.NaN;if(t==="infinity"||t==="+infinity")return n.PositiveInfinity;if(t==="-infinity")return n.NegativeInfinity;if(t==="0")return n.Zero;if(t==="1")return n.One;if(t==="-1")return n.NegativeOne;if(/\([0-9]+\)/.test(t)){let[r,o,s,a]=t.match(/(.+)\(([0-9]+)\)(.+)?$/)??[];t=o+s.repeat(Math.ceil(n.precision/s.length))+(a??"")}return Ir(n,n.bignum(t),i)}return null}function as(n,e,i){if(e===null)return n.error("missing");if(typeof e=="object"&&e instanceof L)return e;if(e=H(e),typeof e=="string")return we(n,e,i);if(Array.isArray(e)){let t=e.map(r=>as(n,r,i));return new be(n,t[0],t.slice(1))}if(typeof e=="object"){if("dict"in e)return new qi(n,e.dict);if("fn"in e)return as(n,e.fn,i);if("str"in e)return new gn(n,e.str);if("sym"in e)return we(n,e.sym,i);if("num"in e)return we(n,e.num,i)}return we(n,e,i)}function Tt(n,e,i,t){if(e==="Hold")return new be(n,"Hold",[as(n,i[0],t)],{...t,canonical:!0});if(e==="Error"||e==="ErrorCode")return n._fn(e,i.map(r=>n.box(r,{canonical:!1})),t.metadata);if(e==="Domain")return n.domain(i[0],t.metadata);if(e==="Number"&&i.length===1)return we(n,i[0],t);if(e==="String")return i.length===0?new gn(n,"",t.metadata):new gn(n,i.map(r=>wu(r)??"").join(""),t.metadata);if(e==="Symbol"&&i.length>0)return n.symbol(i.map(r=>wu(r)??"").join(""),t);if(t.canonical&&(e==="Divide"||e==="Rational")&&i.length===2){if(i[0]instanceof L&&i[1]instanceof L){if(n.numericMode==="machine"){let[s,a]=[E(i[0]),E(i[1])];if(s!==null&&Number.isInteger(s)&&a!==null&&Number.isInteger(a))return n.number([s,a],t)}let[r,o]=[lt(i[0]),lt(i[1])];if(r!==null&&o!==null)return n.number([r,o],t)}else{let[r,o]=[To(i[0]),To(i[1])];if(r!==null&&o!==null)return n.number([r,o],t)}e="Divide"}if(t.canonical&&e==="Complex"){if(i.length===1){let r=we(n,i[0],t),o=E(r);return o!==null&&o!==0?n.number(n.complex(0,o),t):n.mul(r,n.I)}if(i.length===2){let r=we(n,i[0],t),o=we(n,i[1],t),s=E(r),a=E(o);return a!==null&&s!==null?a===0&&s===0?n.Zero:a!==null&&a!==0?n.number(n.complex(s,a),t):r:n.add(r,n.mul(o,n.I))}}if(t.canonical&&e==="Negate"&&i.length===1){let r=i[0];if(typeof r=="number")return n.number(-r,t);if(r instanceof v)return n.number(r.neg(),t);let o=n.box(r,t).numericValue;if(o!==null){if(typeof o=="number")return n.number(-o,t);if(o instanceof v)return n.number(o.neg(),t);if(o instanceof Dr.Complex)return n.number(o.neg());if(U(o))return n.number(_e(o))}}if(e==="Dictionary"){let r={};for(let o of i){let s=n.box(o,{canonical:t.canonical}),a=s.head;if(a==="KeyValuePair"||a==="Pair"||a==="Tuple"&&s.nops===2){let u=s.op1;if(u.isValid&&!u.isNothing){let l=s.op2,f=u.symbol??u.string;if(!f&&(u.numericValue!==null||u.string)){let d=typeof u.numericValue=="number"?u.numericValue:q(u);d&&Number.isFinite(d)&&Number.isInteger(d)&&(f=d.toString())}f&&(r[f]=l)}}}return new qi(n,r,t)}if(e==="List"&&t.canonical){let r=i.map(a=>we(n,a)),{shape:o,dtype:s}=os("List",r)??{};return s&&o?new _t(n,{head:e,ops:r}):n._fn(e,r)}return t.canonical?_r(n,e,i,t.metadata):new be(n,e,i.map(r=>we(n,r,{canonical:!1})),t)}function we(n,e,i){if(e==null)return n._fn("Sequence",[]);if(e instanceof L)return yn(e,i?.canonical??!0);i=i?{...i}:{},"canonical"in i||(i.canonical=!0);let t=i.canonical===!0;if(Array.isArray(e)){if(J(e))return Number.isInteger(e[0])&&Number.isInteger(e[1])?n.number(e):yn(Tt(n,"Divide",e,{canonical:t}),i.canonical);if(K(e))return n.number(e);if(typeof e[0]=="string")return yn(Tt(n,e[0],e.slice(1),{canonical:t}),i.canonical);Array.isArray(e[0]);let r=e.slice(1).map(s=>we(n,s,i)),o=we(n,e[0],{canonical:!1});return yn(new be(n,o,r),i.canonical)}if(typeof e=="number"||e instanceof Dr.Complex||e instanceof v)return n.number(e);if(typeof e=="string")return e.startsWith("'")&&e.endsWith("'")?new gn(n,e.slice(1,-1)):/^[+-]?[0-9]/.test(e)?n.number(e):ri(e)?n.domain(e):Ee(e)?n.symbol(e,{canonical:t}):n.error("invalid-identifier",{str:e});if(typeof e=="object"){let r={latex:e.latex,wikidata:e.wikidata};if("dict"in e)return yn(new qi(n,e.dict,{canonical:!0,metadata:r}),i.canonical);if("fn"in e)return typeof e.fn[0]=="string"?yn(Tt(n,e.fn[0],e.fn.slice(1),{canonical:t}),i.canonical):yn(new be(n,we(n,e.fn[0],i),e.fn.slice(1).map(o=>we(n,o,i)),{metadata:r}),i.canonical);if("str"in e)return new gn(n,e.str,r);if("sym"in e)return n.symbol(e.sym,{canonical:t});if("num"in e)return n.number(e,{canonical:t})}return n.symbol("Undefined")}function wu(n){if(typeof n=="string")return n;if(n instanceof L)return n.string??n.symbol??n.toString();if(typeof n=="object"){if("str"in n)return n.str;if("fn"in n&&n.fn[0]==="String"&&typeof n.fn[1]=="string")return n.fn[1]}return Array.isArray(n)&&n[0]==="String"&&typeof n[1]=="string"?n[1]:null}var ls=pe(ce(),1);var Au=[{Abs:{wikidata:"Q3317982",threadable:!0,idempotent:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","NonNegativeNumbers"],simplify:(n,e)=>us(n,e[0],"simplify"),evaluate:(n,e)=>us(n,e[0],"evaluate"),N:(n,e)=>us(n,e[0],"N")}},Add:{wikidata:"Q32043",associative:!0,commutative:!0,threadable:!0,idempotent:!0,complexity:1300,hold:"all",signature:{domain:"NumericFunctions",result:(n,e)=>nu(n,e.map(i=>i.domain)),simplify:(n,e)=>pr(n,e.map(i=>i.simplify())),evaluate:(n,e)=>xt(n,e.map(i=>i.evaluate())),N:(n,e)=>xt(n,e.map(i=>i.N()),"N")}},Ceil:{description:"Rounds a number up to the next largest integer",complexity:1250,threadable:!0,signature:{domain:["FunctionOf","Numbers","Integers"],evaluate:(n,e)=>R(e[0],Math.ceil,i=>i.ceil(),i=>i.ceil(0))}},Chop:{associative:!0,threadable:!0,idempotent:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>R(e[0],i=>n.chop(i),i=>n.chop(i),i=>n.chop(i))}},Divide:{wikidata:"Q1226939",complexity:2500,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],canonical:(n,e)=>{if(e=Pe(n,e,2),e.length!==2)return n._fn("Divide",e);let[i,t]=e;return n.div(i,t)},simplify:(n,e)=>Er(n,e[0],e[1]),evaluate:(n,e)=>vr(n,e[0],e[1])}},Exp:{wikidata:"Q168698",threadable:!0,complexity:3500,signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(n,e)=>(e=Pe(n,e,1),e.length!==1?n._fn("Power",[n.E,...e]):n.pow(n.E,e[0]))}},Factorial:{description:"Factorial Function",wikidata:"Q120976",threadable:!0,complexity:9e3,signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(n,e)=>{let i=e[0];return i instanceof le&&i.isNegative?n.neg(n._fn("Factorial",[n.neg(i)])):n._fn("Factorial",[i])},evaluate:(n,e)=>{let i=q(e[0]);if(i!==null&&i>=0)return F(n)?n.number(Lo(n,n.bignum(i))):n.number(er(i));let t=e[0].numericValue;if(t!==null&&t instanceof ls.Complex)return n.number(t.add(1));let r=E(e[0]);if(r!==null)return n.number(Ti(1+r))}}},Factorial2:{description:"Double Factorial Function",complexity:9e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>{let i=q(e[0]);if(i!==null)return F(n)?n.number(du(n,n.bignum(i))):n.number(wa(i))}}},Floor:{wikidata:"Q56860783",complexity:1250,threadable:!0,signature:{domain:["FunctionOf","Numbers","ExtendedRealNumbers"],evaluate:(n,e)=>R(e[0],Math.floor,i=>i.floor(),i=>i.floor(0))}},Gamma:{wikidata:"Q190573",complexity:8e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],N:(n,e)=>R(e[0],i=>Ti(i),i=>Vo(n,i),i=>i)}},GammaLn:{complexity:8e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],N:(n,e)=>R(e[0],i=>ot(i),i=>qo(n,i),i=>i)}},Ln:{description:"Natural Logarithm",wikidata:"Q204037",complexity:4e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],simplify:Mu,evaluate:Mu,N:(n,e)=>R(e[0],i=>i>=0?Math.log(i):n.complex(i).log(),i=>i.isNeg()?n.complex(i.toNumber()).log():i.ln(),i=>i.log())}},Log:{description:"Log(z, b = 10) = Logarithm of base b",wikidata:"Q11197",complexity:4100,threadable:!0,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers"],"Numbers"],canonical:(n,e)=>{if(e.length===1)return n._fn("Log",[Fe(n,e[0],"Numbers")]);if(e=Pe(n,e,2),e.length!==2)return n._fn("Log",e);let[i,t]=e;return t.numericValue===10?n._fn("Log",[i]):n._fn("Log",[i,t])},N:(n,e)=>e[1]===void 0?R(e[0],i=>i>=0?Math.log10(i):n.complex(i).log().div(Math.LN10),i=>i.isNeg()?n.complex(i.toNumber()).log().div(Math.LN10):v.log10(i),i=>i.log().div(Math.LN10)):Vn(e[0],e[1],(i,t)=>Math.log(i)/Math.log(t),(i,t)=>i.log(t),(i,t)=>i.log().div(typeof t=="number"?Math.log(t):t.log()))}},Lb:{description:"Base-2 Logarithm",wikidata:"Q581168",complexity:4100,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],N:(n,e)=>R(e[0],i=>i>=0?Math.log2(i):n.complex(i).log().div(Math.LN2),i=>i.isNeg()?v.log10(i):n.complex(i.toNumber()).log().div(Math.LN2),i=>i.log().div(Math.LN2))}},Lg:{description:"Base-10 Logarithm",wikidata:"Q966582",complexity:4100,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],N:(n,e)=>R(e[0],i=>i>=0?Math.log10(i):n.complex(i).log().div(Math.LN10),i=>i.isNeg()?n.complex(i.toNumber()).log().div(Math.LN10):v.log10(i),i=>i.log().div(Math.LN10))}},Mod:{description:"Modulo",wikidata:"Q1799665",complexity:2500,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],evaluate:(n,e)=>{if(e.length!==2)return;let[i,t]=e,r=i.value,o=t.value;if(typeof r=="number"&&typeof o=="number")return n.number((r%o+o)%o)}}},Multiply:{wikidata:"Q40276",associative:!0,commutative:!0,idempotent:!0,complexity:2100,hold:"all",threadable:!0,signature:{domain:"NumericFunctions",simplify:(n,e)=>yu(n,e.map(i=>i.simplify())),evaluate:(n,e)=>vt(n,e.map(i=>i.evaluate())),N:(n,e)=>vt(n,e.map(i=>i.N()),"N")}},Negate:{description:"Additive Inverse",wikidata:"Q715358",complexity:2e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],result:(n,e)=>{let i=e[0].domain;if(!i?.base)return i;let t={PositiveNumbers:"NegativeNumbers",NonNegativeNumbers:"NonPositiveNumbers",NonPositiveNumbers:"NonNegativeNumbers",NegativeNumbers:"PositiveNumbers",PositiveIntegers:"NegativeIntegers",NonNegativeIntegers:"NonPositiveIntegers",NonPositiveIntegers:"NonNegativeIntegers",NegativeIntegers:"PositiveIntegers"}[i.base];return t?n.domain(t):i},canonical:(n,e)=>(e=Pe(n,e),e.length!==1?n._fn("Negate",e):n.neg(e[0])),simplify:(n,e)=>gr(n,e[0],"simplify"),evaluate:(n,e)=>gr(n,e[0],"evaluate"),N:(n,e)=>gr(n,e[0],"N"),sgn:(n,e)=>{let i=e[0].sgn;if(i!=null){if(i===0)return 0;if(i>0)return-1;if(i<0)return 1}}}},PlusMinus:{description:"Plus or Minus",wikidata:"Q120812",complexity:1200,involution:!0,signature:{domain:["FunctionOf","Values","Tuples"],evaluate:(n,e)=>{if(e.length===1)return n.box(["Pair",e[0],n.neg(e[0])])}}},Power:{wikidata:"Q33456",commutative:!1,threadable:!0,complexity:3500,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],canonical:(n,e)=>{if(e=Pe(n,e,2),e.length!==2)return n._fn("Power",e);let[i,t]=e;return i instanceof le&&i.isNegative?n.neg(n.pow(i,t)):n.pow(i,t)},simplify:(n,e)=>si(n,e[0],e[1],"simplify"),evaluate:(n,e)=>si(n,e[0],e[1],"evaluate"),N:(n,e)=>n.numericMode==="machine"&&typeof e[0].numericValue=="number"&&typeof e[1].numericValue=="number"?n.number(Math.pow(e[0].numericValue,e[1].numericValue)):si(n,e[0],e[1],"N")}},Rational:{complexity:2400,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers"],"RationalNumbers"],canonical:(n,e)=>(e=me(se(e)),e.length===0?n._fn("Rational",[n.error("missing")]):e.length===1?n._fn("Rational",[Fe(n,e[0],"ExtendedRealNumbers")]):(e=ar(n,e,["Integers","Integers"]),e.length!==2||!e[0].isValid||!e[1].isValid?n._fn("Rational",e):n.div(e[0],e[1]))),simplify:(n,e)=>{if(e.length===2)return Er(n,e[0],e[1])},evaluate:(n,e)=>{if(e.length===2){let[t,r]=[q(e[0]),q(e[1])];return t!==null&&r!==null?n.number([t,r]):void 0}let i=E(e[0].N());if(i!==null)return n.number(La(i))},N:(n,e)=>e.length===1?e[0]:Vn(e[0],e[1],(i,t)=>i/t,(i,t)=>i.div(t),(i,t)=>i.div(t))}},Root:{complexity:3200,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],canonical:(n,e)=>{e=Pe(n,e,2);let[i,t]=e;return e.length!==2||!i.isValid||!t.isValid?n._fn("Root",e):n.pow(i,n.inv(t))}}},Round:{complexity:1250,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>R(e[0],Math.round,i=>i.round(),i=>i.round(0))}},Sign:{complexity:1200,threadable:!0,signature:{domain:["FunctionOf","Numbers","Integers"],simplify:(n,e)=>{let i=e[0].sgn;if(i===0)return n.Zero;if(i===1)return n.One;if(i===-1)return n.NegativeOne},evaluate:(n,e)=>{let i=e[0].sgn;if(i===0)return n.Zero;if(i===1)return n.One;if(i===-1)return n.NegativeOne},N:(n,e)=>{let i=e[0].sgn;if(i===0)return n.Zero;if(i===1)return n.One;if(i===-1)return n.NegativeOne}}},Sqrt:{description:"Square Root",wikidata:"Q134237",complexity:3e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(n,e)=>(e=me(se(e)),e.length!==1?n._fn("Sqrt",e):n.pow(e[0],n.Half)),simplify:(n,e)=>Ri(n,e[0],"simplify"),evaluate:(n,e)=>Ri(n,e[0],"evaluate"),N:(n,e)=>Ri(n,e[0],"N")}},Square:{wikidata:"Q3075175",complexity:3100,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(n,e)=>(e=me(se(e)),e.length!==1?n._fn("Square",e):n._fn("Power",[e[0],n.number(2)]).canonical)}},Subtract:{wikidata:"Q40754",complexity:1350,threadable:!0,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers"],"Numbers"],canonical:(n,e)=>{if(e.length===1){let r=Fe(n,e[0],"Numbers");if(r.isValid)return ge(r)}e=Pe(n,e,2);let[i,t]=e;return e.length!==2||!i.isValid||!t.isValid?n._fn("Subtract",e):In(n,te([i,ge(t)],"Add"))}}}},{e:{domain:"TranscendentalNumbers",constant:!0,holdUntil:"never",value:"ExponentialE"},i:{domain:"ImaginaryNumbers",constant:!0,holdUntil:"never",flags:{imaginary:!0},value:"ImaginaryUnit"},MachineEpsilon:{domain:"RealNumbers",holdUntil:"N",constant:!0,flags:{real:!0},value:{num:Number.EPSILON.toString()}},Half:{domain:"RationalNumbers",constant:!0,holdUntil:"evaluate",value:["Rational",1,2]},ImaginaryUnit:{domain:"ImaginaryNumbers",constant:!0,holdUntil:"evaluate",wikidata:"Q193796",flags:{imaginary:!0},value:["Complex",0,1]},ExponentialE:{domain:"TranscendentalNumbers",flags:{algebraic:!1,real:!0},wikidata:"Q82435",constant:!0,holdUntil:"N",value:n=>F(n)?n._BIGNUM_ONE.exp():Math.exp(1)},GoldenRatio:{domain:"AlgebraicNumbers",wikidata:"Q41690",constant:!0,flags:{algebraic:!0},holdUntil:"simplify",value:["Divide",["Add",1,["Sqrt",5]],2]},CatalanConstant:{domain:"RealNumbers",flags:{algebraic:void 0},wikidata:"Q855282",constant:!0,holdUntil:"N",value:{num:`0.91596559417721901505460351493238411077414937428167
                  21342664981196217630197762547694793565129261151062
                  48574422619196199579035898803325859059431594737481
                  15840699533202877331946051903872747816408786590902
                  47064841521630002287276409423882599577415088163974
                  70252482011560707644883807873370489900864775113225
                  99713434074854075532307685653357680958352602193823
                  23950800720680355761048235733942319149829836189977
                  06903640418086217941101917532743149978233976105512
                  24779530324875371878665828082360570225594194818097
                  53509711315712615804242723636439850017382875977976
                  53068370092980873887495610893659771940968726844441
                  66804621624339864838916280448281506273022742073884
                  31172218272190472255870531908685735423498539498309
                  91911596738846450861515249962423704374517773723517
                  75440708538464401321748392999947572446199754961975
                  87064007474870701490937678873045869979860644874974
                  64387206238513712392736304998503539223928787979063
                  36440323547845358519277777872709060830319943013323
                  16712476158709792455479119092126201854803963934243
                  `}},EulerGamma:{domain:"RealNumbers",flags:{algebraic:void 0},wikidata:"Q273023",holdUntil:"N",constant:!0,value:{num:`0.57721566490153286060651209008240243104215933593992359880576723488486772677766
          467093694706329174674951463144724980708248096050401448654283622417399764492353
          625350033374293733773767394279259525824709491600873520394816567085323315177661
          152862119950150798479374508570574002992135478614669402960432542151905877553526
          733139925401296742051375413954911168510280798423487758720503843109399736137255
          306088933126760017247953783675927135157722610273492913940798430103417771778088
          154957066107501016191663340152278935867965497252036212879226555953669628176388
          792726801324310104765059637039473949576389065729679296010090151251959509222435
          014093498712282479497471956469763185066761290638110518241974448678363808617494
          551698927923018773910729457815543160050021828440960537724342032854783670151773
          943987003023703395183286900015581939880427074115422278197165230110735658339673`}}},{PreIncrement:{signature:{domain:["FunctionOf","Numbers","Numbers"]}},PreDecrement:{signature:{domain:["FunctionOf","Numbers","Numbers"]}}},{GCD:{description:"Greatest Common Divisor",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Anything"],"Numbers"],evaluate:(n,e)=>Cu(n,e,"GCD")}},LCM:{description:"Least Common Multiple",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Anything"],"Numbers"],evaluate:(n,e)=>Cu(n,e,"LCM")}},Numerator:{description:"Numerator of an expression",complexity:1200,threadable:!0,hold:"all",signature:{domain:["FunctionOf","Anything","Numbers"],canonical:(n,e)=>{if(e.length===0)return n.box(["Sequence"]);let i=e[0];if(i.head==="Rational"||i.head==="Divide")return i.op1;let t=W(i);return t!==void 0?n.number(t[0]):n._fn("Numerator",me(e))},evaluate:(n,e)=>{if(e.length===0)return n.box(["Sequence"]);let i=e[0];if(i.head==="Rational"||i.head==="Divide")return i.op1.evaluate();let t=W(i.evaluate());return t!==void 0?n.number(t[0]):n._fn("Numerator",e.map(r=>r.evaluate()))}}},Denominator:{description:"Denominator of an expression",complexity:1200,threadable:!0,hold:"all",signature:{domain:["FunctionOf","Anything","Numbers"],canonical:(n,e)=>{if(e.length===0)return n.box(["Sequence"]);let i=e[0];if(i.head==="Rational"||i.head==="Divide")return i.op2;let t=W(i);return t!==void 0?n.number(t[1]):n._fn("Denominator",me(e))},evaluate:(n,e)=>{if(e.length===0)return n.box(["Sequence"]);let i=e[0];if(i.head==="Rational"||i.head==="Divide")return i.op2.evaluate();let t=W(i.evaluate());return t!==void 0?n.number(t[1]):n._fn("Denominator",e.map(r=>r.evaluate()))}}},NumeratorDenominator:{description:"Sequence of Numerator and Denominator of an expression",complexity:1200,threadable:!0,hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],canonical:(n,e)=>{if(e.length===0)return n.box(["Sequence"]);let i=e[0];if(i.head==="Rational"||i.head==="Divide")return n._fn("Sequence",i.ops);let t=W(i.evaluate());return t!==void 0?n._fn("Sequence",[n.number(t[0]),n.number(t[1])]):n._fn("NumeratorDenominator",e.map(r=>r.evaluate()))},evaluate:(n,e)=>{if(e.length===0)return n.box(["Sequence"]);let i=e[0];if(i.head==="Rational"||i.head==="Divide")return n._fn("Sequence",i.ops);let t=W(i);return t!==void 0?n._fn("Sequence",[n.number(t[0]),n.number(t[1])]):n._fn("NumeratorDenominator",me(e))}}}},{Max:{description:"Maximum of two or more numbers",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Values"],"Numbers"],simplify:(n,e)=>e.length===0?n.NegativeInfinity:e.length===1?e[0]:n.box(["Max",...e]),evaluate:(n,e)=>kr(n,e,"Max")}},Min:{description:"Minimum of two or more numbers",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Values"],"Numbers"],simplify:(n,e)=>e.length===0?n.PositiveInfinity:e.length===1?e[0]:n.box(["Min",...e]),evaluate:(n,e)=>kr(n,e,"Min")}},Supremum:{description:"Like Max, but defined for open sets",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Values"],"Numbers"],simplify:(n,e)=>e.length===0?n.NegativeInfinity:e.length===1?e[0]:n.box(["Min",...e]),evaluate:(n,e)=>kr(n,e,"Supremum")}},Infimum:{description:"Like Min, but defined for open sets",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Values"],"Numbers"],simplify:(n,e)=>e.length===0?n.PositiveInfinity:e.length===1?e[0]:n.box(["Min",...e]),evaluate:(n,e)=>kr(n,e,"Infimum")}},Product:{wikidata:"Q901718",complexity:1e3,hold:"all",threadable:!1,signature:{domain:["FunctionOf","Anything",["OptArg","Tuples"],"Numbers"],canonical:(n,e)=>Eu(n,e[0],e[1]),simplify:(n,e)=>Nr(n,e,"simplify"),evaluate:(n,e)=>Nr(n,e,"evaluate"),N:(n,e)=>Nr(n,e,"N")}},Sum:{wikidata:"Q218005",complexity:1e3,hold:"all",threadable:!1,signature:{domain:["FunctionOf",["Union","Collections","Functions"],["OptArg","Tuples"],"Numbers"],canonical:(n,e)=>iu(n,e[0],e[1]),simplify:(n,e)=>hr(n,e,"simplify"),evaluate:(n,e)=>hr(n,e,"evaluate"),N:(n,e)=>hr(n,e,"N")}}},{BaseForm:{description:"`BaseForm(expr, base=10)`",complexity:9e3,inert:!0,signature:{domain:["FunctionOf","Values",["OptArg","Integers"],"Values"],result:(n,e)=>e[0].domain}},FromDigits:{description:"`FromDigits(s, base=10)`       return an integer representation of the string `s` in base `base`.",signature:{domain:["FunctionOf","Strings",["OptArg","Anything"],"Integers"],evaluate:(n,e)=>{let i=e[0]?.string;if(!i)return n.domainError("Strings",e[0]?.domain,e[0]);if(i=i.trim(),i.startsWith("0x"))return n.number(parseInt(i.slice(2),16));if(i.startsWith("0b"))return n.number(parseInt(i.slice(2),2));let t=e[1]??n.Nothing;if(t.isNothing)return n.number(Number.parseInt(i,10));let r=E(t);if(r&&(!Number.isInteger(r)||r<2||r>36))return n.error(["unexpected-base",r],t);let[o,s]=Si(i,t.string??t.symbol??10);return s?n.error(["unexpected-digit",{str:s[0]}],{str:s}):n.number(o)}}},IntegerString:{description:"`IntegerString(n, base=10)`       return a string representation of the integer `n` in base `base`.",threadable:!0,signature:{domain:["FunctionOf","Integers",["OptArg","Integers"],"Strings"],evaluate:(n,e)=>{let i=e[0],t=E(i)??NaN;if(Number.isNaN(t)||!Number.isInteger(t))return n.domainError("Integers",i.domain,i);let r=e[1]??n.Nothing;if(r.isNothing){let s=i.numericValue;return typeof s=="number"?n.string(Math.abs(s).toString()):s instanceof v?n.string(s.abs().toString()):n.string(Math.abs(Math.round(E(i)??NaN)).toString())}if(q(r)===null)return n.domainError("Integers",r.domain,r);let o=q(r);return o<2||o>36?n.error(["out-of-range",2,36,o],r):n.string(Math.abs(t).toString(o))}}}}];function us(n,e,i){if(i!=="simplify"){let t=e.numericValue;if(t!==null){if(typeof t=="number")return n.number(Math.abs(t));if(t instanceof v||t instanceof ls.Complex)return n.number(t.abs());if(J(t))return n.number(i==="N"?Math.abs(t[0]/t[1]):[Math.abs(t[0]),t[1]]);if(K(t)){let[r,o]=t;return n.number(i==="N"?n.bignum(r).div(n.bignum(o)).abs():[r>0?r:-r,o])}}}if(e.isNonNegative)return e;if(e.isNegative)return n.neg(e)}function Ou(n,e){let i=n.engine,t=e==="Max"||e==="Supremum";if(n.head==="Interval"){let r=t?n.op2:n.op1;return!r.isNumber||r.numericValue===void 0?[void 0,[n]]:[r,[]]}if(n.head==="Range"){if(n.nops===1)n=t?n.op1:i.One;else if(!t)n=n.op1;else{let r=n.nops===2?1:E(n.op3);if(r===null||!isFinite(r))return[void 0,[n]];let[o,s]=[E(n.op1),E(n.op2)];if(o===null||s===null)return[void 0,[n]];let a=Math.floor((s-o)/r);n=i.number(o+r*a)}return[n,[]]}if(n.head==="Linspace")return n.nops===1?n=t?n.op1:i.One:t?n=n.op2:n=n.op1,[n,[]];if(wi(n)){let r,o=[];for(let s of X(n)){let[a,u]=Ou(s,e);a&&(r?(t&&a.isGreater(r)||!t&&a.isLess(r))&&(r=a):r=a),o.push(...u)}return[r,o]}return!n.isNumber||n.numericValue===void 0?[void 0,[n]]:[n,[]]}function kr(n,e,i){let t=i==="Max"||i==="Supremum";if(e.length===0)return t?n.NegativeInfinity:n.PositiveInfinity;let r,o=[];for(let s of e){let[a,u]=Ou(s,i);a&&(r?(t&&a.isGreater(r)||!t&&a.isLess(r))&&(r=a):r=a),o.push(...u)}return o.length>0?n.box(r?[i,r,...o]:[i,...o]):r??(t?n.NegativeInfinity:n.PositiveInfinity)}function Cu(n,e,i){let t=i==="LCM"?Kt:Sn,r=i==="LCM"?fu:Ro,o=[];if(F(n)){let a=null;for(let u of e)if(a===null)a=Ge(u),(a===null||!a.isInteger())&&o.push(u);else{let l=Ge(u);l&&l.isInteger()?a=r(a,l):o.push(u)}return o.length===0?a===null?n.One:n.number(a):a===null?n._fn(i,o):n._fn(i,[n.number(a),...o])}let s=null;for(let a of e)if(s===null)s=E(a),(s===null||!Number.isInteger(s))&&o.push(a);else{let u=E(a);u&&Number.isInteger(u)?s=t(s,u):o.push(a)}return o.length===0?s===null?n.One:n.number(s):s===null?n._fn(i,o):n._fn(i,[n.number(s),...o])}function Mu(n,e){let i=e[0];if(i.isZero)return n.NaN;if(i.isOne)return n.Zero;if(i.isNegativeOne&&ae(n))return n.mul(n.Pi,n.I);if(i.symbol==="ExponentialE")return n.One;if(i.head==="Power"&&i.op1.symbol==="ExporentialE")return i.op2;if(i.head==="Power"){let[t,r]=i.ops;return n.mul(r,n.box(["Ln",t]).simplify())}if(i.head==="Multiply"){let[t,r]=i.ops;return n.add(n.box(["Ln",t]).simplify(),n.box(["Ln",r]).simplify())}if(i.head==="Divide"){let[t,r]=i.ops;return n.add(n.box(["Ln",t]).simplify(),n.neg(n.box(["Ln",r]).simplify()))}}var _d={Sin:["Cos","_"],Cos:["Negate",["Sin","_"]],Tan:["Power",["Sec","_"],2],Sec:["Multiply",["Tan","_"],["Sec","_"]],Csc:["Multiply",["Negate",["Cot","_"]],["Csc","_"]],Cot:["Negate",["Power",["Csc","_"],2]],Arcsin:["Power",["Subtract",1,["Power","_",2]],["Negate","Half"]],Arccos:["Negate",["Power",["Subtract",1,["Power","_",2]],["Negate","Half"]]],Arctan:["Power",["Add",1,["Power","_",2]],-1],Arcsec:["Multiply",["Power",["Subtract",1,["Power","_",2]],["Negate","Half"]],["Negate",["Power","_",2]]],Arccsc:["Multiply",["Power",["Subtract",1,["Power","_",2]],["Negate","Half"]],["Negate",["Power","_",2]]],Arccot:["Negate",["Power",["Add",1,["Power","_",2]],-1]],Sinh:["Cosh","_"],Cosh:["Sinh","_"],Tanh:["Power",["Sech","_"],2],Sech:["Multiply",["Tanh","_"],"Sech"],Csch:["Multiply",["Coth","_"],"Csch"],Coth:["Negate",["Power",["Csch","_"],2]],Arcsinh:["Power",["Add",["Power","_",2],1],["Negate","Half"]],Arccosh:["Power",["Subtract",["Power","_",2],1],["Negate","Half"]],Arctanh:["Power",["Subtract",1,["Power","_",2]],-1],Arcsech:["Negate",["Power",["Multiply","2","Subtract",["Power","_",2]],["Negate","Half"]]],Arccsch:["Negate",["Power",["Multiply","2","Add",["Power","_",2]],["Negate","Half"]]],Arccoth:["Negate",["Power",["Subtract",1,["Power","_",2]],-1]],Ln:["Divide",1,"_"],Log:["Power",["Multiply","_",["Ln","10"]],-1],Sqrt:["Multiply",["Power","_",["Negate","Half"]],"Half"],Abs:["Piecewise",["Tuple",["Multiply","_",["Power","_",-1]],["Greater","_",0]]],Erf:["Multiply",["Divide","2",["Sqrt","Pi"]],["Exp",["Negate",["Square","_"]]]],Gamma:["Multiply",["Gamma","_"],["Digamma","_"]],Digamma:["Add",["Multiply",["Digamma","_"],["Gamma","_"]],["Multiply",["Power","_",-1],["Gamma","_"]]],Zeta:["Multiply",["Multiply",-1,["Zeta","_"]],["Digamma","_"]],PolyGamma:["Add",["Multiply",["PolyGamma","_"],["Gamma","_"]],["Multiply",["Power","_",-1],["Gamma","_"]]],Beta:["Multiply",["Add",["Multiply",["Beta","_"],["Digamma","_"]],["Multiply",["Power","_",-1],["Beta","_"]]],["Beta","_"]],Erfc:["Multiply",["Negate",["Erfc","_"]],["Exp",["Negate",["Power","_",2]]],["Power","_",-1]],LambertW:["Multiply",["Power","_",-1],["Multiply",["Add","_",["LambertW","_"]],["Add",["LambertW","_"],1]]],AiryAi:["Multiply",["AiryAi","_"],["AiryBi","_"]],AiryBi:["Multiply",["AiryAi","_"],["AiryBi","_"]],BesselJ:["Multiply",["BesselJ","_"],["BesselY","_"]],BesselY:["Multiply",["BesselJ","_"],["BesselY","_"]],BesselI:["Multiply",["BesselI","_"],["BesselK","_"]],BesselK:["Multiply",["BesselI","_"],["BesselK","_"]],FresnelS:["Multiply",["FresnelS","_"],["FresnelC","_"]],FresnelC:["Multiply",["FresnelS","_"],["FresnelC","_"]],Erfi:["Multiply",["Erfi","_"],["Erf","_"]]};function qe(n,e){let i=n.engine;if(!(n.string||n.keys)){if(n.numericValue!==null)return n.engine.Zero;if(n.symbol===e)return n.engine.One;if(n.symbol)return n.engine.Zero;if(n.head&&typeof n.head=="string"){if(n.head==="Negate"){let s=qe(n.op1,e);return s?i.neg(s):i.neg(i._fn("D",[n.op1,i.symbol(e)]))}if(n.head==="Add"){let s=n.ops.map(a=>qe(a,e));return s.some(a=>a===void 0)?void 0:i.add(...s)}if(n.head==="Multiply"){let s=n.ops.map((a,u)=>{let l=n.ops.slice();l.splice(u,1);let f=i.mul(...l),d=qe(a,e)??i._fn("D",[a,i.symbol(e)]);return i.mul(d,f)});return s.some(a=>a===void 0)?void 0:i.add(...s)}if(n.head==="Power"){let[s,a]=n.ops;if(s.symbol===e)return i.mul(a,i.pow(s,i.add(a,i.NegativeOne)));let u=s,l=a,f=qe(u,e)??i._fn("D",[u,i.symbol(e)]),d=qe(l,e)??i._fn("D",[l,i.symbol(e)]),c=i.box(["Ln",u]).evaluate(),m=i.mul(d,c),g=i.mul(l,f),h=i.div(g,u);return i.mul(n,i.add(m,h))}if(n.head==="Divide"){let[s,a]=n.ops,u=qe(s,e)??i._fn("D",[s,i.symbol(e)]),l=qe(a,e)??i._fn("D",[a,i.symbol(e)]);return i.div(i.add(i.mul(u,a),i.neg(i.mul(l,s))),i.pow(a,2))}let t=_d[n.head];if(!t){if(n.nops>1)return;let s=i._fn("Derivative",[i.symbol(n.head),i.One]);if(!s.isValid)return;let a=n.ops[0],u=qe(a,e)??i._fn("D",[a,i.symbol(e)]);return u.isValid?i.mul(i._fn("Apply",[s,a]),u):void 0}if(n.nops>1)return i._fn("D",[n,i.symbol(e)]);let r=n.ops[0],o=qe(r,e)??i._fn("D",[r,i.symbol(e)]);return i.mul(ui(i.box(t),[r]),o)}}}var Pu=[{Derivative:{hold:"all",threadable:!1,signature:{domain:["FunctionOf","Functions",["OptArg","Numbers"],"Functions"],canonical:(n,e)=>e[0].functionDefinition?qe(n._fn(e[0].canonical,[n.symbol("_")]),"_")?.canonical??n._fn("Derivative",e):n._fn("Derivative",e),simplify:(n,e)=>{let i=e[0].simplify();return e[1]?n._fn("Derivative",[i,e[1]]):n._fn("Derivative",[i])},evaluate:(n,e)=>{let i=e[0].evaluate();if(i.functionDefinition)return qe(n._fn(i,[n.symbol("_")]),"_")?.canonical??void 0;let t=qe(i,"_");if(t)return t.canonical}}},D:{hold:"all",threadable:!1,signature:{domain:["FunctionOf","Anything","Symbols",["VarArg","Symbols"],"Anything"],canonical:(n,e)=>{let i=e[0];if(!i)return null;n.pushScope();let t=e.slice(1);i.bind(),i=i.canonical;let r=n._fn("D",[i,...t]);return n.popScope(),r},evaluate:(n,e)=>{let i=e[0].canonical,t=n.swapScope(i.scope);i=i.evaluate();let r=e.slice(1);r.length===0&&(i=void 0);for(let o of r){if(!o.symbol){i=void 0;break}if(i=qe(i,o.symbol),i===void 0)break}return n.swapScope(t),i=i?.canonical,i?.head==="D"?i:i?.evaluate()}}},ND:{hold:"first",threadable:!1,signature:{domain:["FunctionOf","Anything","Numbers","Functions"],N:(n,e)=>{let i=e[1]?.value;if(typeof i!="number")return;let t=Ho(n.box(e[0]));return n.number(Ma(t,i))}}},Integrate:{wikidata:"Q80091",hold:"all",threadable:!1,signature:{domain:["FunctionOf","Functions",["OptArg",["Union","Tuples","Symbols"]],"Numbers"],canonical:(n,e)=>{let i=e[1],t=null,r=null,o=null;i&&i.head!=="Tuple"&&i.head!=="Triple"&&i.head!=="Pair"&&i.head!=="Single"?t=i:i&&(t=i.ops?.[0]??null,r=i.ops?.[1]?.canonical??null,o=i.ops?.[2]?.canonical??null),t&&t.head==="Hold"&&(t=t.op1),t&&t.head==="ReleaseHold"&&(t=t.op1.evaluate()),t??(t=n.Nothing),t.symbol||(t=n.domainError("Symbols",t.domain,t)),r&&(r=Fe(n,r,n.Numbers)),o&&(o=Fe(n,o,n.Numbers)),r&&o?i=n.tuple([t,r,o]):o?i=n.tuple([t,n.NegativeInfinity,o]):r?i=n.tuple([t,r]):i=t;let s=e[0]??n.error("missing");return s=s.canonical,s.head==="Delimiter"&&s.op1.head==="Sequence"&&(s=s.op1.op1),n._fn("Integrate",[s,i])}}},NIntegrate:{hold:"first",threadable:!1,signature:{domain:["FunctionOf","Functions","Numbers","Numbers","Numbers"],evaluate:(n,e)=>{let i=n.numericMode,t=n.precision;n.numericMode="machine";let r=Ho(e[0]),[o,s]=e.slice(1).map(u=>u.value),a;return typeof o=="number"&&typeof s=="number"&&(a=n.number(Aa(r,o,s))),n.numericMode=i,n.precision=t,a}}}},{Limit:{description:"Limit of a function",complexity:5e3,hold:"all",threadable:!1,signature:{domain:["FunctionOf","Anything","Numbers",["OptArg","Numbers"],"Numbers"],N:(n,e)=>{let[i,t,r]=e,o=E(t.N());if(o===null)return;let s=li(i);return n.number(Kn(a=>{let u=s([n.number(a)])?.value;return typeof u=="number"?u:Number.NaN},o,r?E(r)??1:1))}}},NLimit:{description:"Numerical approximation of the limit of a function",complexity:5e3,hold:"all",threadable:!1,signature:{domain:["FunctionOf","Anything","Numbers",["OptArg","Numbers"],"Numbers"],evaluate:(n,e)=>{let[i,t,r]=e,o=E(t.N());if(o===null)return;let s=li(i);return n.number(Kn(a=>{let u=s([n.number(a)])?.value;return typeof u=="number"?u:Number.NaN},o,r?E(r)??1:1))}}}}];var wr=50,Ru={List:{complexity:8200,hold:"all",signature:{domain:["FunctionOf",["VarArg","Anything"],"Lists"],canonical:Td},size:n=>n.nops,iterator:(n,e,i)=>{let t=e??1;return i=Math.min(i??n.nops,n.nops),i<=0?{next:()=>({value:void 0,done:!0})}:{next:()=>i>0?(i--,{value:n.ops[t++-1],done:!1}):{value:void 0,done:!0}}},at:(n,e)=>{if(typeof e=="number"&&!(e<1||e>n.nops))return n.ops[e-1]},indexOf:(n,e,i)=>{if(i??(i=1),i<0){if(i<-n.nops)return;i=n.nops+i+1;let r=i;for(let o=r;o>=1;o--)if(n.ops[o-1].isEqual(e))return o;return}let t=i;for(let r=t;r<=n.nops;r++)if(n.ops[r-1].isEqual(e))return r}},Range:{complexity:8200,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers","Numbers"],"Values"]},size:n=>{let[e,i,t]=Ar(n);return!isFinite(e)||!isFinite(i)?1/0:1+Math.max(0,Math.floor((i-e)/t))},at:(n,e)=>{if(typeof e!="number")return;let[i,t,r]=Ar(n);if(!(e<1||e>1+(t-i)/r))return n.engine.number(i+r*(e-1))},iterator:(n,e,i)=>{let[t,r,o]=Ar(n),s=e??1;return i=Math.min(i??r,r),i<=0?{next:()=>({value:void 0,done:!0})}:{next:()=>i>0?(i--,{value:n.engine.number(t+o*(s++-1)),done:!1}):{value:void 0,done:!0}}}},Linspace:{complexity:8200,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers","Numbers"],"Values"]},size:n=>{let e=E(n.op3)??wr;return Math.max(0,Math.floor(e))},at:(n,e)=>{if(typeof e!="number")return;let i=E(n.op1),t=E(n.op2),r=E(n.op3)??wr;if(!(i===void 0||t===void 0)&&!(e<1||e>r))return n.engine.number(i+(t-i)*(e-1)/r)},iterator:(n,e,i)=>{let t=E(n.op1),r=E(n.op2),o;r===void 0?(r=t,t=1,o=wr):o=Math.max(0,E(n.op3)??wr);let s=e??1;return i=Math.min(i??o,o),i<=0?{next:()=>({value:void 0,done:!0})}:{next:()=>i>0?(i--,{value:n.engine.number(t+(r-t)*(s++-1)/o),done:!1}):{value:void 0,done:!0}}}},KeyValuePair:{description:"A key/value pair",complexity:8200,signature:{domain:["FunctionOf","Strings","Anything","Tuples"],canonical:(n,e)=>{let[i,t]=ar(n,e,[n.Strings,"Values"]);return!i.isValid||!t.isValid?n._fn("KeyValuePair",[i,t]):n.tuple([i,t])}},size:n=>1},Single:{description:"A tuple with a single element",complexity:8200,signature:{domain:["FunctionOf","Anything","Tuples"],canonical:(n,e)=>n.tuple(Se(n,e,1))},size:n=>n.nops,at:(n,e)=>{if(!(typeof e!="number"||e!==1))return n.ops[0]}},Pair:{description:"A tuple of two elements",complexity:8200,signature:{domain:["FunctionOf","Anything","Anything","Tuples"],canonical:(n,e)=>n.tuple(Se(n,e,2))},size:n=>n.nops,at:(n,e)=>typeof e=="number"?n.ops[e-1]:void 0},Triple:{description:"A tuple of three elements",complexity:8200,signature:{domain:["FunctionOf","Anything","Anything","Anything","Tuples"],canonical:(n,e)=>n.tuple(Se(n,e,3))},size:n=>n.nops,at:(n,e)=>typeof e=="number"?n.ops[e-1]:void 0},Tuple:{description:"A fixed number of heterogeneous elements",complexity:8200,signature:{domain:["FunctionOf","Anything",["VarArg","Anything"],"Tuples"],canonical:(n,e)=>n.tuple(me(e))},size:n=>n.nops,at:(n,e)=>typeof e=="number"?n.ops[e-1]:void 0},String:{threadable:!0,signature:{domain:["FunctionOf",["OptArg","Anything"],"Strings"],evaluate:(n,e)=>e.length===0?n.string(""):n.string(e.map(i=>i.string??i.toString()).join(""))}},Length:{complexity:8200,signature:{domain:["FunctionOf","Values","Numbers"],evaluate:(n,e)=>{let i=e[0].functionDefinition;if(i?.size)return n.number(i.size(e[0]));let t=e[0].string;return t!==null?n.number(t.length):n.Zero}}},IsEmpty:{complexity:8200,signature:{domain:["FunctionOf","Values","Numbers"],evaluate:(n,e)=>{let i=e[0].functionDefinition,t;if(i?.size)t=i.size(e[0]);else{let r=e[0].string;r!==null&&(t=r.length)}if(t!==void 0)return t===0?n.True:n.False}}},Take:{complexity:8200,signature:{domain:["FunctionOf","Values",["VarArg","Values"],"Values"],evaluate:(n,e)=>{if(e.length<2)return;let i=e[0].string;if(i!==null){let o=e.slice(1).map(s=>Cr(s,i.length));return n.string(Sd(i,o))}let r=e[0].functionDefinition?.size?.(e[0]);return Mr(e[0],e.slice(1).map(o=>Cr(o,r)))}}},Drop:{complexity:8200,signature:{domain:["FunctionOf","Values",["VarArg","Values"],"Values"],evaluate:(n,e)=>{if(e.length<2)return;let i=e[0].string;if(i!==null){let a=Fu(e.slice(1).map(u=>Cr(u,i.length)));return n.string(i.split("").filter((u,l)=>!a.includes(l+1)).join(""))}let t=e[0].functionDefinition,r=t?.size?.(e[0]);if(!r||!t?.at)return n.Nothing;let o=Fu(e.slice(1).map(a=>Cr(a,r))),s=[];for(let a=1;a<=r;a++)if(!o.includes(a)){let u=t.at(e[0],a);u&&s.push(u)}return n.box(["List",...s])}}},At:{complexity:8200,signature:{domain:["FunctionOf","Values","Values","Values"],evaluate:(n,e)=>{let i=e[0],t=i.functionDefinition;if(!t?.at)return;if(e[1].string!==null)return t.at(i,1)??n.Nothing;let o=E(e[1]);if(!(o===null||!Number.isInteger(o)))return t.at(i,o)??n.Nothing}}},First:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0],t=i.functionDefinition;return t?.at?t.at(i,1)??n.Nothing:n.Nothing}}},Second:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0],t=i.functionDefinition;return t?.at?t.at(i,2)??n.Nothing:n.Nothing}}},Last:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0],t=i.functionDefinition;return t?.at?t.at(i,-1)??n.Nothing:n.Nothing}}},Rest:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>Mr(e[0],[[2,-1,1]])}},Most:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>Mr(e[0],[[1,-2,1]])}},Reverse:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>Mr(e[0],[[-1,2,1]])}},Ordering:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Functions"],"Values"],evaluate:(n,e)=>{}}},Sort:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Functions"],"Values"],evaluate:(n,e)=>{}}},Shuffle:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{}}},Map:{complexity:8200,signature:{domain:["FunctionOf","Collections","Functions","Collections"],evaluate:(n,e)=>{}}},Filter:{complexity:8200,signature:{domain:["FunctionOf","Values","Functions","Values"],evaluate:(n,e)=>{}}},Reduce:{complexity:8200,signature:{domain:["FunctionOf","Values","Functions",["OptArg","Values"],"Values"],evaluate:(n,e)=>{}}},Tabulate:{complexity:8200,signature:{domain:["FunctionOf","Functions","Integers",["VarArg","Integers"],"Values"],evaluate:(n,e)=>{}}},Tally:{complexity:8200,signature:{domain:["FunctionOf","Values","Tuples"],evaluate:(n,e)=>{}}},Unique:{complexity:8200,signature:{domain:["FunctionOf","Values","Tuples"],evaluate:(n,e)=>{}}},Zip:{complexity:8200,signature:{domain:["FunctionOf","Values",["VarArg","Values"],"Values"],evaluate:(n,e)=>{}}},RotateLeft:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Integers"],"Values"],evaluate:(n,e)=>{}}},RotateRight:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Integers"],"Values"],evaluate:(n,e)=>{}}},Join:{complexity:8200,signature:{domain:["FunctionOf",["VarArg","Values"],"Values"],evaluate:(n,e)=>{}}},Iterate:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Values"],"Values"],evaluate:(n,e)=>{}}},Repeat:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{}}},Cycle:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{}}},Fill:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{}}}};function Ar(n){let e=E(n.op1)??1,i=E(n.op2);if(i===void 0)return[1,e,1];let t=E(n.op3)??1;return[e,i,t]}function Cr(n,e){if(!n)return[0,0,0];let i=E(n);if(i!==null){if(i=Math.round(i),i<0){if(e===void 0)return[0,0,0];i=e+i+1}return[i,i,1]}let t=n.head;if(!t||typeof t!="string"||!/^(Single|Pair|Triple|Tuple|)$/.test(t))return[0,0,0];let[r,o,s]=Ar(n);return(r<0||o<0)&&e===void 0?[0,0,0]:(r<0&&(r=e+r+1),o<0&&(o=e+o+1),s=Math.abs(Math.round(s)),s===0?[0,0,0]:(r>o&&(s=-s),[r,o,s]))}function Mr(n,e){let i=n.engine,t=n.functionDefinition;if(!t?.at)return i.Nothing;let r=[];for(let o of e){let[s,a,u]=o;if(u!==0)if(u<0)for(let l=s;l>=a;l+=u){let f=t.at(n,l);f&&r.push(f)}else for(let l=s;l<=a;l+=u){let f=t.at(n,l);f&&r.push(f)}}return i.box(["List",...r])}function Sd(n,e){let i="";for(let t of e){let[r,o,s]=t;if(s===1)i+=n.slice(r-1,o);else if(s<0)for(let a=r;a>=o;a+=s)i+=n[a-1];else for(let a=r;a<=o;a+=s)i+=n[a-1]}return i}function Fu(n){let e=[];for(let i of n){let[t,r,o]=i;if(o!==0)if(o<0)for(let s=t;s>=r;s+=o)e.push(s);else for(let s=t;s<=r;s+=o)e.push(s)}return e}function Td(n,e){let i=e[0];if(e.length===1&&i.head==="Matrix"){let[t,r,o]=i.ops;if(!r||r.string==="..")return o?n._fn("Matrix",[t,n.string("[]"),o]):n._fn("Matrix",[t,r])}return e=e.map(t=>t.head==="Delimiter"?t.op1.head==="Sequence"?n.box(["List",...me(t.op1.ops)]):n.box(["List",t.op1?.canonical??n.Nothing]):t.canonical),n.box(["List",...e])}var Lu=[{Block:{hold:"all",signature:{domain:"Functions",canonical:kd,evaluate:Id}},If:{hold:"rest",signature:{domain:"Functions",result:(n,e)=>Un(e[0],e[1]),evaluate:(n,e)=>{let i=e[0];return i&&i.symbol==="True"?e[1]?e[1].evaluate():n.Nothing:e[2]?e[2].evaluate():n.Nothing}}},Loop:{hold:"all",signature:{domain:"Functions",evaluate:(n,e)=>{let i=e[0]??n.Nothing;if(i.isNothing)return i;let t=e[1];if(t&&wi(t)){let o,s=li(i),a=0;for(let u of X(t)){if(o=s([u])??n.Nothing,o.head==="Break")return o.op1;if(o.head==="Return")return o;if(a++>n.iterationLimit)return n.error("iteration-limit-exceeded")}}let r=0;for(;;){let o=i.evaluate();if(o.head==="Break")return o.op1;if(o.head==="Return")return o;if(r++>n.iterationLimit)return n.error("iteration-limit-exceeded")}}}},Which:{hold:"all",signature:{domain:"Functions",result:(n,e)=>Bd(n,e),evaluate:(n,e)=>Dd(n,e,"evaluate")}},FixedPoint:{hold:"all",signature:{domain:"Functions"}}}];function Bd(n,e){let i=null;for(let t=1;t<=e.length-1;t+=2)i=Un(i,e[t].domain);return i??n.domain("NothingDomain")}function Dd(n,e,i){let t=0;for(;t<e.length-1;){if(e[t].evaluate().symbol==="True")return e[t+1]?i==="N"?e[t+1].N():e[t+1].evaluate():n.symbol("Undefined");t+=2}return n.symbol("Undefined")}function Id(n,e){if(e.length===0)return n.Nothing;n.resetContext();let i;for(let t of e){let r=t.head;if(r==="Return"){i=t.op1.evaluate();break}if(r==="Break"||r==="Continue"){i=n.box([r,t.op1.evaluate()]);break}i=t.evaluate()}return i??n.Nothing}function kd(n,e){if(e.length===0)return null;n.pushScope();let i=[],t=[];for(let o of e)o.head==="Declare"?i.push(o):t.push(qu(o));let r=n._fn("Block",[...i,...t]);return n.popScope(),r}function qu(n){return n.head==="Declare"&&n.engine.error("unexpected-declare"),n.ops?n.engine._fn(n.head,n.ops.map(qu)):n}var Vu=[{Real:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>{let i=e[0].numericValue;if(i!==null)return n.isComplex(i)?n.number(i.re):e[0]}}},Imaginary:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>{let i=e[0].numericValue;if(i!==null)return n.isComplex(i)?n.number(i.im):n.Zero}}},Argument:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>{let i=e[0].numericValue;if(i===null)return;if(n.isComplex(i))return n.number(i.arg());let t=E(e[0]);if(t!==null)return t>=0?n.Zero:n.Pi}}},AbsArg:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Tuples"],evaluate:(n,e)=>{let i=e[0].numericValue;if(i===null)return;if(n.isComplex(i))return n.tuple([n.number(i.abs()),n.number(i.arg())]);let t=E(e[0]);if(t!==null)return n.tuple([n.number(Math.abs(t)),n.number(t>=0?0:Math.PI)])}}},Conjugate:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>{let i=e[0].numericValue;if(!(i===null||!n.isComplex(i)))return n.number(i.conjugate())}}},ComplexRoots:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers","Lists"],evaluate:(n,e)=>{let i=E(e[0]),t=E(e[1]);if(i===null||t===null||!Number.isInteger(t)||t<=0)return;let r=[],[o,s]=n.isComplex(i)?[i.re,i.im]:[i,0],a=Math.atan2(s,o),u=Math.sqrt(o*o+s*s);for(let l=0;l<t;l++){let f=(a+2*Math.PI*l)/t,d=Math.pow(u,1/t);r.push([d*Math.cos(f),d*Math.sin(f)])}return n.box(["List",...r.map(l=>n.number(l[1]!==0?n.complex(l[0],l[1]):l[0]))])}}}}];var $u=[{Matrix:{complexity:9e3,hold:"all",signature:{params:["Lists"],optParams:["Strings","Strings"],result:"Lists",canonical:wd,evaluate:(n,e)=>e[0].evaluate(),N:(n,e)=>e[0].N()}},Vector:{complexity:9e3,hold:"all",signature:{restParam:"Anything",result:"Lists",canonical:(n,e)=>n._fn("Matrix",[n.box(["List",...n.canonical(e).map(i=>n.box(["List",i]))])])}}},{Shape:{complexity:8200,signature:{domain:["FunctionOf","Values","Tuples"],evaluate:(n,e)=>{let i=e[0];return Le(i)?n.tuple(i.tensor.shape):n.tuple([])}}},Rank:{complexity:8200,signature:{domain:["FunctionOf","Values","Numbers"],evaluate:(n,e)=>{let i=e[0];return Le(i)?n.number(i.tensor.rank):n.Zero}}},Reshape:{complexity:8200,signature:{domain:["FunctionOf","Values","Tuples","Values"],evaluate:(n,e)=>{let i=e[0],t=e[1].ops?.map(r=>r.value)??[];if(!Le(i)&&ue(i)&&(i=n.box(["List",...X(i)])),Le(i))return i.tensor.reshape(...t).expression}}},Flatten:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0];if(Le(i))return n.box(["List",...i.tensor.flatten().map(t=>n.box(t))]);if(ue(i))return n.box(["List",...X(i)])}}},Transpose:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Numbers","Numbers"],"Values"],evaluate:(n,e)=>{let i=e[0],t=1,r=2;if(e.length===3&&(t=e[1].value,r=e[2].value,t>0&&r>0),t!==r&&(!Le(i)&&ue(i)&&(i=n.box(["List",...X(i)])),Le(i)))return t===1&&r===2?i.tensor.transpose()?.expression:i.tensor.transpose(t,r)?.expression}}},ConjugateTranspose:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0],t=1,r=2;if(e.length===3&&(t=e[1].value,r=e[2].value,t>0&&r>0),t!==r&&Le(i))return i.tensor.conjugateTranspose(t,r)?.expression}}},Determinant:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0];if(Le(i))return i.tensor.determinant()}}},Inverse:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0];if(Le(i))return i.tensor.inverse()?.expression}}},PseudoInverse:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0];if(Le(i))return i.tensor.pseudoInverse()?.expression}}},AdjugateMatrix:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0];if(Le(i))return i.tensor.adjugateMatrix()?.expression}}},Trace:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0];if(Le(i))return i.tensor.trace()}}}}];function wd(n,e,i="Matrix"){if(e.length===0)return n._fn(i,[]);let t=e[0].head==="Vector"?e[0].canonical.ops[0]:e[0].canonical,r=e[1]?.canonical,o=e[2]?.canonical;return e.length>3?n._fn(i,Se(n,e,3)):o?n._fn(i,[t,r,o]):r?n._fn(i,[t,r]):n._fn(i,[t])}var Hu={True:{wikidata:"Q16751793",domain:"Booleans",constant:!0},False:{wikidata:"Q5432619",domain:"Booleans",constant:!0},And:{wikidata:"Q191081",threadable:!0,associative:!0,commutative:!0,idempotent:!0,complexity:1e4,signature:{domain:"LogicOperators",simplify:zu,evaluate:zu}},Or:{wikidata:"Q1651704",threadable:!0,associative:!0,commutative:!0,idempotent:!0,complexity:1e4,signature:{domain:"LogicOperators",simplify:Uu,evaluate:Uu}},Not:{wikidata:"Q190558",threadable:!0,involution:!0,complexity:10100,signature:{domain:"LogicOperators",simplify:Gu,evaluate:Gu}},Equivalent:{wikidata:"Q220433",threadable:!0,complexity:10200,signature:{domain:"LogicOperators",canonical:(n,e)=>{let i=e[0].symbol,t=e[1].symbol;return i==="True"&&t==="True"||i==="False"&&t==="False"?n.True:i==="True"&&t==="False"||i==="False"&&t==="True"?n.False:n._fn("Equivalent",e)},simplify:ju,evaluate:ju}},Implies:{wikidata:"Q7881229",threadable:!0,complexity:10200,signature:{domain:"LogicOperators",simplify:Zu,evaluate:Zu}},Exists:{signature:{domain:"Functions"}}};function zu(n,e){if(e.length===0)return n.True;let i=[];for(let t of e){if(t.symbol==="False")return n.False;if(t.symbol!=="True"){let r=!1;for(let o of i)if(o.isSame(t))r=!0;else if(t.head==="Not"&&t.op1.isSame(o)||o.head==="Not"&&o.op1.isSame(t))return n.False;r||i.push(t)}}return i.length===0?n.True:i.length===1?i[0]:n._fn("And",i)}function Uu(n,e){if(e.length===0)return n.True;let i=[];for(let t of e){if(t.symbol==="True")return n.True;if(t.symbol!=="False"){let r=!1;for(let o of i)if(o.isSame(t))r=!0;else if(t.head==="Not"&&t.op1.isSame(o)||o.head==="Not"&&o.op1.isSame(t))return n.True;r||i.push(t)}}return i.length===0?n.True:i.length===1?i[0]:n._fn("Or",i)}function Gu(n,e){let i=e[0]?.symbol;if(i==="True")return n.False;if(i==="False")return n.True}function ju(n,e){let i=e[0].symbol,t=e[1].symbol;if(i==="True"&&t==="True"||i==="False"&&t==="False")return n.True;if(i==="True"&&t==="False"||i==="False"&&t==="True")return n.False}function Zu(n,e){let i=e[0].symbol,t=e[1].symbol;if(i==="True"&&t==="True"||i==="False"&&t==="False"||i==="False"&&t==="True")return n.True;if(i==="True"&&t==="False")return n.False}var Ju=[{Expand:{description:"Expand out products and positive integer powers",signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>rn(e[0])??e[0]}},ExpandAll:{description:"Recursively expand out products and positive integer powers",signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>Po(e[0])??e[0]}},Factor:{description:"Factors an algebraic expression into a product of irreducible factors",signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>Xa(e[0])}},Together:{description:"Combine rational expressions into a single fraction",signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>oi(e[0])}},Distribute:{description:"Distribute multiplication over addition",signature:{domain:["FunctionOf","Values","Values"],evaluate:(n,e)=>{let i=e[0].head;if(i==="Multiply")return Pi(e[0].ops)??e[0];if(i==="Negate")return Pi([n.NegativeOne,...e[0].ops])??e[0];if(i==="Divide"&&e[0].ops[0].head==="Multiply"){let t=Pi(e[0].ops),r=e[0].ops[1];if(t)return t.head==="Add"?n.add(...t.ops.map(o=>n.div(o,r))).evaluate():n.div(t,r).evaluate()}return e[0]}}}}];var Wu={Congruent:{commutative:!1,complexity:11e3,numeric:!0,signature:{simplify:(n,e)=>{if(!(e.length<3))return n._fn("Equal",[n.box(["Mod",e[0],e[2]]).simplify(),n.box(["Mod",e[1],e[2]]).simplify()]).simplify()},evaluate:(n,e)=>{if(e.length<3)return;let[i,t,r]=e,o=i.value,s=t.value,a=r.value;if(typeof o=="number"&&typeof s=="number"&&typeof a=="number")return o%a===s%a?n.True:n.False}}},IsSame:{description:"Compare two expressions for structural equality",hold:"all",signature:{domain:"RelationalOperators",evaluate:(n,e)=>{if(e.length!==2)return;let[i,t]=e;return i.isSame(t)===!0?n.True:n.False}}},Equal:{commutative:!0,complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"Equal",e),evaluate:(n,e)=>{if(e.length<2)return n.True;let i;for(let t of e)if(!i)i=t;else if(i.isEqual(t)!==!0)return n.False;return n.True}}},NotEqual:{wikidata:"Q28113351",commutative:!0,complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"NotEqual",e),evaluate:(n,e)=>{if(e.length<2)return n.False;let i;for(let t of e)if(!i)i=t;else if(i.isEqual(t)===!0)return n.False;return n.True}}},Less:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"Less",e),evaluate:(n,e)=>{if(e.length<2)return n.True;let i;for(let t of e){if(!t.isNumber)return;if(!i)i=t;else{let r=n.box(["Subtract",t,i]).N().sgn;if(r==null)return;if(r<=0)return n.False;i=t}}return n.True}}},NotLess:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"Less",e)])}},Greater:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"Less",e.reverse()),evaluate:(n,e)=>{if(e.length<2)return n.True;let i;for(let t of e){if(!t.isNumber)return;if(!i)i=t;else{let r=n.box(["Subtract",t,i]).N().sgn;if(r==null)return;if(r>=0)return n.False;i=t}}return n.True}}},NotGreater:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[n._fn("Greater",e)])}},LessEqual:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"LessEqual",e),evaluate:(n,e)=>{if(e.length<2)return n.True;let i;for(let t of e){if(!t.isNumber)return;if(!i)i=t;else{let r=n.box(["Subtract",t,i]).N().sgn;if(r==null)return;if(r<0)return n.False;i=t}}return n.True}}},NotLessNotEqual:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"LessEqual",e)])}},GreaterEqual:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"LessEqual",e.reverse()),evaluate:(n,e)=>{if(e.length<2)return n.True;let i;for(let t of e){if(!t.isNumber)return;if(!i)i=t;else{let r=n.box(["Subtract",t,i]).N().sgn;if(r==null)return;if(r>0)return n.False;i=t}}return n.True}}},NotGreaterNotEqual:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"GreaterEqual",e)])}},TildeFullEqual:{description:"Indicate isomorphism, congruence and homotopic equivalence",signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"TildeFullEqual",e)}},NotTildeFullEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"TildeFullEqual",e)])}},TildeEqual:{description:"Approximately or asymptotically equal",complexity:11e3,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"TildeEqual",e)}},NotTildeEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"TildeEqual",e)])}},Approx:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"Approx",e)}},NotApprox:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"Approx",e)])}},ApproxEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"ApproxEqual",e)}},NotApproxEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"ApproxEqual",e)])}},ApproxNotEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"ApproxNotEqual",e)}},NotApproxNotEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"ApproxNotEqual",e)])}},Precedes:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"Precedes",e)}},NotPrecedes:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"Precedes",e)])}},Succeeds:{signature:{domain:"RelationalOperators",canonical:(n,e)=>fe(n,"Succeeds",e)}},NotSucceeds:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(n,e)=>n._fn("Not",[fe(n,"Succeeds",e)])}}};function fe(n,e,i){i=te(se(me(i)),e);let t=[],r=[];for(let o of i)Cd(o)?(t.push(o),r.push(o.ops[o.ops.length-1])):r.push(o);return r=r.map(o=>ja(n,o)),t.length===0?n._fn(e,r):n._fn("And",[n._fn(e,r),...t])}function Cd(n){return typeof n.head=="string"&&/Equal|NotEqual|Less|NotLess|Greater|NotGreater|LessEqual|NotLessNotEqual|GreaterEqual|NotGreater|NotEqual|TildeFullEqual|NotTildeFullEqual|TildeEqual|NotTildeEqual|Approx|NotApprox|ApproxEqual|NotApproxEqual|ApproxNotEqual|NotApproxNotEqual|Precedes|NotPrecedes|Succeeds|NotSucceeds/.test(n.head)}var Yu={EmptySet:{domain:"Sets",constant:!0,wikidata:"Q226183"},Element:{complexity:11200,hold:"all",signature:{domain:"Predicates",canonical:(n,e)=>(e=Se(n,e,2),e.length===2&&e[0].isValid&&mn(e[1])?n._fn("Element",[e[0],n.domain(e[1])]):n._fn("Element",e)),evaluate:(n,e)=>Pd(n,e)}},NotElement:{complexity:11200,hold:"all",signature:{domain:"Predicates",canonical:(n,e)=>n.box(["Not",["Element",...e]])}},Subset:{complexity:11200,signature:{domain:"Predicates"}},NotSubset:{complexity:11200,signature:{domain:"Predicates",canonical:(n,e)=>n.box(["Not",["Subset",...e]])}},Superset:{complexity:11200,signature:{domain:"Predicates"}},SupersetEqual:{complexity:11200,signature:{domain:"Predicates"}},NotSuperset:{complexity:11200,signature:{domain:"Predicates",canonical:(n,e)=>n.box(["Not",["Superset",...e]])}},NotSupersetEqual:{complexity:11200,signature:{domain:"Predicates",canonical:(n,e)=>n.box(["Not",["SupersetEqual",...e]])}},SubsetEqual:{complexity:11200,signature:{domain:"Predicates"}},NotSubsetNotEqual:{complexity:11200,signature:{domain:"Predicates",canonical:(n,e)=>n.box(["Not",["SubsetEqual",...e]])}},CartesianProduct:{wikidata:"Q173740",signature:{domain:["FunctionOf","Sets",["VarArg","Sets"],"Sets"]}},Complement:{wikidata:"Q242767",signature:{domain:["FunctionOf","Sets","Sets"]}},Intersection:{wikidata:"Q185837",associative:!0,commutative:!0,involution:!0,signature:{domain:["FunctionOf","Collections",["VarArg","Collections"],"Sets"],canonical:(n,e)=>e.length===0||e.length===1?n.symbol("EmptySet"):n._fn("Intersection",e),evaluate:Ad}},Union:{wikidata:"Q185359",associative:!0,commutative:!0,involution:!0,signature:{domain:["FunctionOf","Collections",["VarArg","Collections"],"Sets"],canonical:(n,e)=>e.length===0?n.symbol("EmptySet"):n._fn("Union",e),evaluate:Md}},SetMinus:{wikidata:"Q18192442",signature:{domain:["FunctionOf","Sets","Values","Sets"],evaluate:Od}},SymmetricDifference:{wikidata:"Q1147242",signature:{domain:["FunctionOf","Sets",["VarArg","Sets"],"Sets"]}}};function Md(n,e){let i=[];for(let t of e)if(ue(t))for(let r of X(t))i.every(o=>!o.isEqual(r))&&i.push(r);else i.every(r=>!r.isEqual(t))&&i.push(t);return i.length===0?n.symbol("EmptySet"):n._fn("Set",i)}function Ad(n,e){let i=e[0].ops??[];for(let t of e.slice(1))ue(t)?i=i.filter(r=>[...X(t)].some(o=>r.isEqual(o))):i=i.filter(r=>r.isEqual(t));return i.length===0?n.symbol("EmptySet"):n._fn("Set",i)}function Od(n,e){return n.symbol("EmptySet")}function Pd(n,e){e.length;let[i,t]=e;if(t.string)return i.string&&t.string.includes(i.string)?n.True:n.False;if(t.keys){if(i.string){for(let r of t.keys)if(r===i.string)return n.True}return n.False}if(t.head==="List"){if(i.head==="List"){let o=!1;for(let s=0;s<1+(t.nops-i.nops);++s){o=!0;for(let a=0;a<i.nops;++a)if(!t.ops[s+a].isEqual(i.ops[a])){o=!1;break}if(o)return n.True}return n.False}let r=i.head==="Hold"?i.op1:i;for(let o of t.ops)if(r.isEqual(o))return n.True;return n.False}return mn(t)&&i.domain?i.domain.isCompatible(n.domain(t))?n.True:n.False:n._fn("Element",[i,t])}var Qu=[{Mean:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(n,e)=>{let i=0,t=0;for(let r of X(e[0])){let o=E(r);if(o===null)return;i+=o,t++}return t===0?n.NaN:n.number(i/t)}}},Median:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(n,e)=>{let i=[];for(let r of X(e[0])){let o=E(r);if(o===null)return;i.push(o)}if(i.length===0)return n.NaN;i.sort((r,o)=>r-o);let t=Math.floor(i.length/2);return i.length%2===0?n.number((i[t-1]+i[t])/2):n.number(i[t])}}},Variance:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(n,e)=>{let i=0,t=0,r=0;for(let o of X(e[0])){let s=E(o);if(s===null)return;i+=s,t+=s*s,r++}return r===0?n.NaN:n.number((t-i*i/r)/(r-1))}}},StandardDeviation:{complexity:1200,threadable:!1,description:"Sample Standard Deviation of a collection of numbers.",signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(n,e)=>{let i=0,t=0,r=0;for(let o of X(e[0])){let s=E(o);if(s===null)return;i+=s,t+=s*s,r++}return r===0?n.NaN:n.number(Math.sqrt((t-i*i/r)/(r-1)))}}},Kurtosis:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(n,e)=>{let i=0,t=0,r=0,o=0;for(let u of X(e[0])){let l=E(u);if(l===null)return;i+=l,t+=l*l,r+=l*l*l*l,o++}if(o===0)return n.NaN;let s=(t-i*i/o)/(o-1),a=(r-t*t/o)/(o-1);return n.number((a/(s*s)-3)*(o*(o+1))/6)}}},Skewness:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(n,e)=>{let i=0,t=0,r=0,o=0;for(let u of X(e[0])){let l=E(u);if(l===null)return;i+=l,t+=l*l,r+=l*l*l,o++}if(o===0)return n.NaN;let s=(t-i*i/o)/(o-1),a=(r-t*i/o)/(o-1);return n.number(a/Math.pow(s,3/2)*Math.sqrt(o*1))}}},Mode:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(n,e)=>{let i=[];for(let s of X(e[0])){let a=E(s);if(a===null)return;i.push(a)}if(i.length===0)return n.NaN;i.sort((s,a)=>s-a);let t={};for(let s of i)t[s]=(t[s]??0)+1;let r=0,o=i[0];for(let s of i){let a=t[s];a>r&&(r=a,o=s)}return n.number(o)}}},Quartiles:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Lists"],evaluate:(n,e)=>{let i=[];for(let s of X(e[0])){let a=E(s);if(a===null)return;i.push(a)}if(i.length===0)return n.NaN;i.sort((s,a)=>s-a);let t=Math.floor(i.length/2),r=i.slice(0,t),o=i.slice(t+1);return n.box(["List",n.number(i[t]),n.number(r[Math.floor(r.length/2)]),n.number(o[Math.floor(o.length/2)])])}}},InterquartileRange:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(n,e)=>{let i=[];for(let s of X(e[0])){let a=E(s);if(a===null)return;i.push(a)}if(i.length===0)return n.NaN;i.sort((s,a)=>s-a);let t=Math.floor(i.length/2),r=i.slice(0,t),o=i.slice(t+1);return n.number(o[Math.floor(o.length/2)]-r[Math.floor(r.length/2)])}}},Erf:{complexity:7500,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>{let i=E(e[0]);if(i!==null)return n.number(So(i))}}},Erfc:{complexity:7500,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>{let i=E(e[0]);if(i!==null)return n.number(1-So(i))}}},ErfInv:{complexity:7500,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(n,e)=>{let i=E(e[0]);if(i!==null)return n.number(Ca(i))}}}}];var Cn=n=>["FunctionOf","Numbers","ExtendedRealNumbers"],Or=n=>["FunctionOf","Numbers","Numbers"],Hn=n=>["FunctionOf","Numbers","Numbers"],Xu=[{Pi:{domain:"TranscendentalNumbers",flags:{algebraic:!1},constant:!0,holdUntil:"N",wikidata:"Q167",value:n=>F(n)?n._BIGNUM_PI:Math.PI}},{Degrees:{signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(n,e)=>{if(e=Pe(n,e,1),e.length!==1)return n._fn("Degrees",e);let i=e[0];if(i.numericValue===null||!i.isValid)return n._fn("Degrees",e);let t=E(i);if(t!==null){if(t=t%360,t<0&&(t+=360),Number.isInteger(t)){let r=je([t,180]);return r[0]===0?n.Zero:r[0]===1&&r[1]===1?n.Pi:r[0]===1?n.div(n.Pi,n.number(r[1])):n.mul(n.number(r),n.Pi)}return n.mul(n.div(n.number(t),n.number(180)),n.Pi)}return n.div(n.mul(i,n.Pi),n.number(180))},evaluate:(n,e)=>n.mul(e[0],n.div(n.Pi,n.number(180))).evaluate()}},Hypot:{threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","NonNegativeNumbers"],simplify:(n,e)=>n.box(["Sqrt",["Add",["Square",e[0]],["Square",e[1]]]]).simplify(),evaluate:["Function",["Sqrt",["Add",["Square","_1"],["Square","_2"]]]]}},Sin:{complexity:5e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],simplify:(n,e)=>Ne(n,"Sin",e[0])?.simplify()??(ae(n)?n.box(["Divide",["Subtract",["Exp",["Multiply","ImaginaryUnit",e[0]]],["Exp",["Multiply","ImaginaryUnit",["Negate",e[0]]]]],["Complex",0,2]]).simplify():void 0),evaluate:(n,e)=>k(n,"evaluate","Sin",e[0]),N:(n,e)=>k(n,"N","Sin",e[0])}}},{Arctan:{wikidata:"Q2257242",complexity:5200,threadable:!0,signature:{domain:Cn("Arctan"),simplify:(n,e)=>Ne(n,"Arctan",e[0])?.simplify(),evaluate:(n,e)=>k(n,"evaluate","Arctan",e[0]),N:(n,e)=>k(n,"N","Arctan",e[0])}},Arctan2:{wikidata:"Q776598",complexity:5200,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],N:(n,e)=>Vn(e[0],e[1],Math.atan2,(i,t)=>v.atan2(i,t))}},Cos:{complexity:5050,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],simplify:(n,e)=>Ne(n,"Cos",e[0])?.simplify()??n.box(["Sin",["Add",e[0],["Multiply","Half","Pi"]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Cos",e[0]),N:(n,e)=>k(n,"N","Cos",e[0])}},Tan:{complexity:5100,threadable:!0,signature:{domain:Or("Tan"),simplify:(n,e)=>Ne(n,"Tan",e[0])?.simplify()??n.box(["Divide",["Sin",e[0]],["Cos",e[0]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Tan",e[0]),N:(n,e)=>k(n,"N","Tan",e[0])}}},{Arcosh:{complexity:6200,threadable:!0,signature:{domain:Hn("Arcosh"),simplify:(n,e)=>Ne(n,"Arcosh",e[0])?.simplify()??n.box(["Ln",["Add",e[0],["Sqrt",["Subtract",["Square",e[0]],1]]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Arcosh",e[0]),N:(n,e)=>k(n,"N","Arcosh",e[0])}},Arcsin:{complexity:5500,threadable:!0,signature:{domain:Hn("Arcsin"),simplify:(n,e)=>Ne(n,"Arcsin",e[0])?.simplify()??n.box(["Multiply",2,["Arctan2",e[0],["Add",1,["Sqrt",["Subtract",1,["Square",e[0]]]]]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Arcsin",e[0]),N:(n,e)=>k(n,"N","Arcsin",e[0])}},Arsinh:{complexity:6100,threadable:!0,signature:{domain:Hn("Arsinh"),simplify:(n,e)=>Ne(n,"Arsinh",e[0])?.simplify()??n.box(["Ln",["Add",e[0],["Sqrt",["Add",["Square",e[0]],1]]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Arsinh",e[0]),N:(n,e)=>k(n,"N","Arsinh",e[0])}},Artanh:{complexity:6300,threadable:!0,signature:{domain:Hn("Artanh"),simplify:(n,e)=>Ne(n,"Artanh",e[0])?.simplify()??n.box(["Multiply","Half",["Ln",["Divide",["Add",1,e[0]],["Subtract",1,e[0]]]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Artanh",e[0]),N:(n,e)=>k(n,"N","Artanh",e[0])}},Cosh:{complexity:6050,threadable:!0,signature:{domain:Hn("Cosh"),simplify:(n,e)=>Ne(n,"Cosh",e[0])?.simplify()??n.box(["Multiply","Half",["Add",["Exp",e[0]],["Exp",["Negate",e[0]]]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Cosh",e[0]),N:(n,e)=>k(n,"N","Cosh",e[0])}},Cot:{complexity:5600,threadable:!0,signature:{domain:Or("Cot"),simplify:(n,e)=>Ne(n,"Cot",e[0])?.simplify()??n.box(["Divide",["Cos",e[0]],["Sin",e[0]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Cot",e[0]),N:(n,e)=>k(n,"N","Cot",e[0])}},Csc:{description:"Cosecant",complexity:5600,threadable:!0,signature:{domain:Or("Csc"),simplify:(n,e)=>Ne(n,"Csc",e[0])?.simplify()??n.box(["Divide",1,["Sin",e[0]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Csc",e[0]),N:(n,e)=>k(n,"N","Csc",e[0])}},Haversine:{wikidata:"Q2528380",threadable:!0,signature:{domain:["FunctionOf","ExtendedRealNumbers","Numbers"],evaluate:["Divide",["Subtract",1,["Cos","_1"]],2]}},InverseHaversine:{threadable:!0,signature:{domain:["FunctionOf","ExtendedRealNumbers","RealNumbers"],evaluate:["Multiply",2,["Arcsin",["Sqrt","_1"]]]}},Sec:{description:"Secant, inverse of cosine",complexity:5500,threadable:!0,signature:{domain:Or("Sec"),simplify:(n,e)=>Ne(n,"Sec",e[0])?.simplify()??n.box(["Divide",1,["Cos",e[0]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Sec",e[0]),N:(n,e)=>k(n,"N","Sec",e[0])}},Sinh:{complexity:6e3,threadable:!0,signature:{domain:Hn("Sinh"),simplify:(n,e)=>Ne(n,"Sinh",e[0])?.simplify()??n.box(["Multiply","Half",["Subtract",["Exp",e[0]],["Exp",["Negate",e[0]]]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Sinh",e[0]),N:(n,e)=>k(n,"N","Sinh",e[0])}}},{Csch:{complexity:6200,threadable:!0,signature:{domain:Cn("Csch"),simplify:(n,e)=>Ne(n,"Csch",e[0])?.simplify()??n.box(["Divide",1,["Sinh",e[0]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Csch",e[0]),N:(n,e)=>k(n,"N","Csch",e[0])}},Sech:{complexity:6200,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],simplify:(n,e)=>Ne(n,"Sech",e[0])?.simplify()??n.box(["Divide",1,["Cosh",e[0]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Sech",e[0]),N:(n,e)=>k(n,"N","Sech",e[0])}},Tanh:{complexity:6200,threadable:!0,signature:{domain:Hn("Tanh"),simplify:(n,e)=>Ne(n,"Tanh",e[0])?.simplify()??n.box(["Divide",["Sinh",e[0]],["Cosh",e[0]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Tanh",e[0]),N:(n,e)=>k(n,"N","Tanh",e[0])}}},{Arccos:{complexity:5550,threadable:!0,signature:{domain:Cn("Arccos"),simplify:(n,e)=>Ne(n,"Arccos",e[0])?.simplify()??n.box(["Subtract",["Divide","Pi",2],["Arcsin",e[0]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Arccos",e[0]),N:(n,e)=>k(n,"N","Arccos",e[0])}},Arccot:{numeric:!0,threadable:!0,signature:{domain:Cn("Arccot"),evaluate:(n,e)=>k(n,"evaluate","Arccot",e[0]),N:(n,e)=>k(n,"N","Arccot",e[0])}},Arcoth:{numeric:!0,threadable:!0,signature:{domain:Cn("Arcoth"),evaluate:(n,e)=>k(n,"evaluate","Arcoth",e[0]),N:(n,e)=>k(n,"N","Arcoth",e[0])}},Arcsch:{numeric:!0,threadable:!0,signature:{domain:Cn("Arcsch"),evaluate:(n,e)=>k(n,"evaluate","Arcsch",e[0]),N:(n,e)=>k(n,"N","Arcsch",e[0])}},Arcsec:{numeric:!0,threadable:!0,signature:{domain:Cn("Arcsec"),evaluate:(n,e)=>k(n,"evaluate","Arcsec",e[0]),N:(n,e)=>k(n,"N","Arcsec",e[0])}},Arsech:{numeric:!0,threadable:!0,signature:{domain:Cn("Arsech"),evaluate:(n,e)=>k(n,"evaluate","Arsech",e[0]),N:(n,e)=>k(n,"N","Arsech",e[0])}},Arccsc:{numeric:!0,threadable:!0,signature:{domain:Cn("Arccsc"),evaluate:(n,e)=>k(n,"evaluate","Arccsc",e[0]),N:(n,e)=>k(n,"N","Arccsc",e[0])}},Coth:{complexity:6300,threadable:!0,signature:{domain:Hn("Coth"),simplify:(n,e)=>Ne(n,"Coth",e[0])?.simplify()??n.box(["Divide",1,["Tanh",e[0]]]).simplify(),evaluate:(n,e)=>k(n,"evaluate","Coth",e[0]),N:(n,e)=>k(n,"N","Coth",e[0])}},InverseFunction:{signature:{domain:["FunctionOf","Functions","Functions"],canonical:(n,e)=>(e=Se(n,e,1),fs(n,e)??n._fn("InverseFunction",e)),simplify:(n,e)=>fs(n,e),evaluate:(n,e)=>fs(n,e)}}}],Jn=["Sqrt",2],$i=["Sqrt",3],zi=["Sqrt",5],Pr=["Sqrt",6],Fd=[[[0,1],{Sin:0,Cos:1,Tan:0,Cot:"ComplexInfinity",Sec:1,Csc:"ComplexInfinity"}],[[1,12],{Sin:["Divide",["Subtract",Pr,Jn],4],Cos:["Divide",["Add",Pr,Jn],4],Tan:["Subtract",2,$i],Cot:["Add",2,$i],Sec:["Subtract",Pr,Jn],Csc:["Add",Pr,Jn]}],[[1,10],{Sin:["Divide",["Subtract",zi,1],4],Cos:["Divide",["Sqrt",["Add",10,["Multiply",2,zi]]],4],Tan:["Divide",["Sqrt",["Subtract",25,["Multiply",10,zi]]],5],Cot:["Sqrt",["Add",5,["Multiply",2,zi]]],Sec:["Divide",["Sqrt",["Subtract",50,["Multiply",10,zi]]],5],Csc:["Add",1,zi]}],[[1,8],{Sin:"$\\frac{\\sqrt{2-\\sqrt2}}{2}$",Cos:"$\\frac{\\sqrt {2+{\\sqrt {2}}}}{2}$",Tan:"$\\sqrt{2} - 1$",Cot:"$\\sqrt{2} + 1$",Sec:"$\\sqrt{ 4 - 2\\sqrt{2}}$",Csc:"$\\sqrt{ 4 + 2\\sqrt{2}}$"}],[[1,6],{Sin:"$\\frac{1}{2}$",Cos:"$\\frac{\\sqrt{3}}{2}$",Tan:"$\\frac{\\sqrt{3}}{3}$",Cot:"$\\sqrt{3}$",Sec:"$\\frac{2\\sqrt{3}}{3}$",Csc:2}],[[1,5],{Sin:"$\\frac{\\sqrt{10- 2\\sqrt{5}}} {4}$",Cos:"$\\frac{1+ \\sqrt{5}} {4}$",Tan:"$\\sqrt{5-2\\sqrt5}$",Cot:"$\\frac{\\sqrt{25+10\\sqrt5}} {5}$",Sec:"$\\sqrt{5} - 1$",Csc:"$\\frac{\\sqrt{50+10\\sqrt{5}}} {5}$"}],[[1,4],{Sin:["Divide",Jn,2],Cos:["Divide",Jn,2],Tan:1,Cot:1,Sec:Jn,Csc:Jn}],[[3,10],{Sin:"$\\frac{1+ \\sqrt5} {4}$",Cos:"$\\frac{\\sqrt{10- 2\\sqrt5}} {4}$",Tan:"$\\frac{\\sqrt{25+10\\sqrt5}} {5}$",Cot:"$\\sqrt{5-2\\sqrt5}$",Sec:"$\\frac{\\sqrt{50+10\\sqrt5}} {5}$",Csc:"$\\sqrt5-1$"}],[[1,3],{Sin:["Divide",$i,2],Cos:"Half",Tan:$i,Cot:["Divide",$i,3],Sec:2,Csc:["Divide",["Multiply",2,$i],3]}],[[3,8],{Sin:"$\\frac{ \\sqrt{2 + \\sqrt{2}} } {2}$",Cos:"$\\frac{ \\sqrt{2 - \\sqrt{2}} } {2}$",Tan:"$\\sqrt{2} + 1$",Cot:"$\\sqrt{2} - 1$",Sec:"$\\sqrt{ 4 + 2 \\sqrt{2} }$",Csc:"$\\sqrt{ 4 - 2 \\sqrt{2} }$"}],[[2,5],{Sin:"$\\frac{\\sqrt{10+ 2\\sqrt{5}}} {4}$",Cos:"$\\frac{\\sqrt{5}-1} {4}$",Tan:"$\\sqrt{5+2\\sqrt{5}}$",Cot:"$\\frac{\\sqrt{25-10\\sqrt{5}}} {5}$",Sec:"$1 + \\sqrt{5}$",Csc:"$\\frac{\\sqrt{50-10\\sqrt{5}}} {5}$"}],[[5,12],{Sin:"$\\frac{\\sqrt{6} + \\sqrt{2}} {4}$",Cos:"$\\frac{ \\sqrt{6} - \\sqrt{2}} {4}$",Tan:"$2+\\sqrt{3}$",Cot:"$2-\\sqrt{3}$",Sec:"$\\sqrt{6}+\\sqrt{2}$",Csc:"$\\sqrt{6} - \\sqrt{2}$"}],[[1,2],{Sin:1,Cos:0,Tan:"ComplexInfinity",Cot:0,Sec:"ComplexInfinity",Csc:1}]],Rd={Sin:[[1,"Sin"],[1,"Cos"],[-1,"Sin"],[-1,"Cos"]],Cos:[[1,"Cos"],[-1,"Sin"],[-1,"Cos"],[1,"Sin"]],Sec:[[1,"Sec"],[-1,"Csc"],[-1,"Sec"],[1,"Csc"]],Csc:[[1,"Csc"],[1,"Sec"],[-1,"Csc"],[-1,"Sec"]],Tan:[[1,"Tan"],[-1,"Cot"],[1,"Tan"],[-1,"Cot"]],Cot:[[1,"Cot"],[-1,"Tan"],[1,"Cot"],[-1,"Tan"]]};function Ne(n,e,i){if(!i)return;let t=E(i.N());if(t===null)return;let r=n.cache("constructible-trigonometric-values",()=>Fd.map(([u,l])=>[u,Object.fromEntries(Object.entries(l).map(([f,d])=>[f,n.parse(Ii(d))??n.box(d)]))]),u=>{for(let[l,f]of u)for(let d of Object.values(f))d.reset();return u}),o=e!=="Cos"&&e!=="Sec"?Math.sign(t):1;t=Math.abs(t%(2*Math.PI));let s=Math.floor(t*2/Math.PI);t=t%(Math.PI/2);let a;[a,e]=Rd[e]?.[s]??[1,e];for(let[[u,l],f]of r){let d=f[e];if(d&&n.chop(t-Math.PI*u/l)===0)return d.symbol==="ComplexInfinity"?d:o*a<0?ge(d):d}}function fs(n,e){if(e.length!==1||!e[0].isValid)return;let i=e[0],t=i.symbol;if(typeof t!="string")return;if(t==="InverseFunction")return i.op1;let r={Sin:"Arcsin",Cos:"Arccos",Tan:"Arctan",Sec:"Arcsec",Csc:" Arccsc",Sinh:"Arsinh",Cosh:"Arcosh",Tanh:"Artanh",Sech:"Arcsech",Csch:"Arcsch",Arcosh:"Cosh",Arccos:"Cos",Arccsc:"Csc",Arcsch:"Csch",Arcsec:"Sec",Arcsin:"Sin",Arsinh:"Sinh",Arctan:"Tan",Artanh:"Tanh"}[t];return r?n.symbol(r):void 0}function k(n,e,i,t){if(!t)return;let r=Ne(n,i,t)?.evaluate({numericMode:e==="N"});if(r)return r;if(!(e==="evaluate"&&t.isExact))switch(i){case"Arccos":return R(t,Math.acos,o=>o.acos(),o=>o.acos());case"Arccot":return R(t,o=>Math.atan2(1,o),o=>v.atan2(n._BIGNUM_ONE,o),o=>o.inverse().atan());case"Arccsc":return R(t,o=>Math.asin(1/o),o=>n._BIGNUM_ONE.div(o).asin(),o=>o.inverse().asin());case"Arcosh":return R(t,Math.acosh,o=>o.acosh(),o=>o.acosh());case"Arcoth":return R(t,o=>o,o=>o.acosh(),o=>o.acosh());case"Arcsch":return R(t,o=>Math.log(1/o+Math.sqrt(1/(o*o)+1)),o=>n._BIGNUM_ONE.div(o.mul(o)).add(n._BIGNUM_ONE).sqrt().add(n._BIGNUM_ONE.div(o)).log(),o=>o.mul(o).inverse().add(1).sqrt().add(o.inverse()).log());case"Arcsec":return R(t,o=>Math.acos(1/o),o=>n._BIGNUM_ONE.div(o).acos(),o=>o.inverse().acos());case"Arcsin":return R(t,Math.asin,o=>o.asin(),o=>o.asin());case"Arsech":return R(t,o=>Math.log((1+Math.sqrt(1-o*o))/o),o=>n._BIGNUM_ONE.sub(o.mul(o).add(n._BIGNUM_ONE).div(o)).log(),o=>n.complex(1).sub(o.mul(o)).add(1).div(o).log());case"Arsinh":return R(t,Math.asinh,o=>o.asinh(),o=>o.asinh());case"Arctan":return R(t,Math.atan,o=>o.atan(),o=>o.atan());case"Artanh":return R(t,Math.atanh,o=>o.atanh(),o=>o.atanh());case"Cos":return R(t,Math.cos,o=>o.toSignificantDigits(n.precision+4).cos().toSignificantDigits(n.precision),o=>o.cos());case"Cosh":return R(t,Math.cosh,o=>o.cosh(),o=>o.cosh());case"Cot":return R(t,o=>1/Math.tan(o),o=>n._BIGNUM_ONE.div(o.tan()),o=>o.tan().inverse());case"Coth":return R(t,o=>1/Math.tanh(o),o=>n._BIGNUM_ONE.div(o.tanh()),o=>o.tanh().inverse());case"Csc":return R(t,o=>1/Math.sin(o),o=>n._BIGNUM_ONE.div(o.sin()),o=>o.sin().inverse());case"Csch":return R(t,o=>1/Math.sinh(o),o=>n._BIGNUM_ONE.div(o.sinh()),o=>o.sinh().inverse());case"Sec":return R(t,o=>1/Math.cos(o),o=>n._BIGNUM_ONE.div(o.cos()),o=>o.cos().inverse());case"Sech":return R(t,o=>1/Math.cosh(o),o=>n._BIGNUM_ONE.div(o.cosh()),o=>o.cosh().inverse());case"Sin":return R(t,Math.sin,o=>o.toSignificantDigits(n.precision+4).sin().toSignificantDigits(n.precision),o=>o.sin());case"Sinh":return R(t,Math.sinh,o=>o.sinh(),o=>o.sinh());case"Tan":return R(t,Math.tan,o=>o.toSignificantDigits(n.precision+4).tan().toSignificantDigits(n.precision),o=>o.tan());case"Tanh":return R(t,Math.tanh,o=>o.tanh(),o=>o.tanh())}}var Ku=pe(ce(),1);var de=class{constructor(e,i,t){if(!e.context)throw Error("No context available");this.name=i,this.wikidata=t.wikidata,this.description=t.description,this.url=t.url,this._engine=e,this.scope=e.context,this.name=i,this._flags=t.flags?Bt(t.flags):void 0,this._domain=t.domain?e.domain(t.domain):void 0,this.inferredDomain=t.inferred??!1,this.constant=t.constant??!1,this.holdUntil=t.holdUntil??"evaluate",this.constant?(this._defValue=t.value,this._value=null):(t.value!==void 0?Di(t.value)?this._value=e.parse(t.value)??e.symbol("Undefined"):typeof t.value=="function"?this._value=e.box(t.value(e)??"Undefined"):t.value instanceof L?this._value=t.value:this._value=e.box(t.value):this._value=void 0,!this._value&&this._domain&&!t.flags&&(this._flags=Fr(this._domain))),this._value&&!this._domain&&(this._domain=this._value.domain,this.inferredDomain=!0)}update(e){e.wikidata&&(this.wikidata=e.wikidata),e.description&&(this.description=e.description),e.url&&(this.url=e.url);let i=e?.flags,t=e?.domain?this._engine.domain(e.domain):void 0;t&&(i={...Fr(t),...i??{}}),i&&(this._flags=Bt(i)),t&&(this._domain=t,this.inferredDomain=!1),e.holdUntil&&(this.holdUntil=e.holdUntil),e.constant?(this.constant=e.constant,this._defValue=e.value,this._value=null):e.value&&(Di(e.value)?this._value=this._engine.parse(e.value)??this._engine.symbol("Undefined"):typeof e.value=="function"?this._value=this._engine.box(e.value(this._engine)??"Undefined"):e.value instanceof L?this._value=e.value:this._value=this._engine.box(e.value)),this._value&&!this._domain&&(this._domain=this._value.domain,this.inferredDomain=!0)}reset(){this.constant&&(this._value=null)}get value(){if(this._value===null){let e=this._engine;if(Di(this._defValue)?this._value=e.parse(this._defValue)??e.symbol("Undefined"):typeof this._defValue=="function"?this._value=e.box(this._defValue(e)??"Undefined"):this._defValue?this._value=e.box(this._defValue):this._value=void 0,this._value?.numericValue){let i=this._value.numericValue;!F(e)&&i instanceof v?this._value=e.number(i.toNumber()):!ae(e)&&i instanceof Ku.Complex&&(this._value=e.NaN)}}return this._value??void 0}set value(e){if(this.constant)throw new Error(`The value of the constant "${this.name}" cannot be changed`);if(this._defValue,typeof e=="number")this._value=this._engine.number(e);else if(e){let i=this._engine.box(e);this.inferredDomain?(this._value=i,this._domain=Un(this._domain,i.domain)):!this._domain||!i.domain||i.domain?.isCompatible(this._domain)?this._value=i:this._value=void 0}else this._value=void 0;this._value!==void 0?this._flags=void 0:this._flags=Fr(this._domain)}get domain(){return this._domain??void 0}set domain(e){if(this.constant)throw new Error(`The domain of the constant "${this.name}" cannot be changed`);if(!this.inferredDomain)throw Error(`The domain of "${this.name}" cannot be changed because it has already been declared`);if(!e){this._defValue=void 0,this._value=void 0,this._flags=void 0,this._domain=void 0;return}if(e=this._engine.domain(e),this._domain&&!e.isCompatible(this._domain))throw Error(`The domain of "${this.name}" cannot be widened from "${this._domain.base}" to "${e.base}"`);if(this._value?.domain&&!this._value.domain.isCompatible(e))throw Error(`The domain of "${this.name}" cannot be changed to "${e.base}" because its value has a domain of "${this._value.domain.base}"`);this._domain=e,this._flags=void 0,this._value===void 0&&e.isNumeric&&(this._flags=Fr(e))}get number(){return this.value?.isNumber??this._flags?.number}set number(e){this.updateFlags({number:e})}get integer(){return this.value?.isInteger??this._flags?.integer}set integer(e){this.updateFlags({integer:e})}get rational(){return this.value?.isRational??this._flags?.rational}set rational(e){this.updateFlags({rational:e})}get algebraic(){return this.value?.isAlgebraic??this._flags?.algebraic}set algebraic(e){this.updateFlags({algebraic:e})}get real(){return this.value?.isReal??this._flags?.real}set real(e){this.updateFlags({real:e})}get extendedReal(){return this.value?.isExtendedReal??this._flags?.extendedReal}set extendedReal(e){this.updateFlags({extendedReal:e})}get complex(){return this.value?.isComplex??this._flags?.complex}set complex(e){this.updateFlags({complex:e})}get extendedComplex(){return this.value?.isExtendedComplex??this._flags?.extendedComplex}set extendedComplex(e){this.updateFlags({extendedComplex:e})}get imaginary(){return this.value?.isImaginary??this._flags?.imaginary}set imaginary(e){this.updateFlags({imaginary:e})}get positive(){return this.value?.isPositive??this._flags?.positive}set positive(e){this.updateFlags({positive:e})}get nonPositive(){return this.value?.isNonPositive??this._flags?.nonPositive}set nonPositive(e){this.updateFlags({nonPositive:e})}get negative(){return this.value?.isNegative??this._flags?.negative}set negative(e){this.updateFlags({negative:e})}get nonNegative(){return this.value?.isNonNegative??this._flags?.nonNegative}set nonNegative(e){this.updateFlags({nonNegative:e})}get zero(){return this.value?.isZero??this._flags?.zero}set zero(e){this.updateFlags({zero:e})}get notZero(){return this.value?.isNotZero??this._flags?.notZero}set notZero(e){this.updateFlags({notZero:e})}get one(){return this.value?.isOne??this._flags?.one}set one(e){this.updateFlags({one:e})}get negativeOne(){return this.value?.isNegativeOne??this._flags?.negativeOne}set negativeOne(e){this.updateFlags({negativeOne:e})}get infinity(){return this.value?.isInfinity??this._flags?.infinity}set infinity(e){this.updateFlags({infinity:e})}get finite(){return this.value?.isFinite??this._flags?.finite}set finite(e){this.updateFlags({finite:e})}get NaN(){return this.value?.isNaN??this._flags?.NaN}set NaN(e){this.updateFlags({NaN:e})}get even(){return this.value?.isEven??this._flags?.even}set even(e){this.updateFlags({even:e})}get odd(){return this.value?.isOdd??this._flags?.odd}set odd(e){this.updateFlags({odd:e})}get prime(){let e=this._value;return e?!e.isInteger||e.isNonPositive?!1:jn(E(e)??NaN):this._flags?.prime}set prime(e){this.updateFlags({prime:e})}get composite(){let e=this._value;return e?!e.isInteger||e.isNonPositive?!1:!jn(E(e)??NaN):this._flags?.composite}set composite(e){this.updateFlags({composite:e})}updateFlags(e){if(this.constant)throw Error("The flags of constant cannot be changed");if(this.domain?.isNumeric===!1)throw Error("Flags only apply to numeric domains");let i=0,t=!0;for(let r in Object.keys(e))if(i+=1,this._value&&e[r]!==void 0)switch(r){case"number":t=this._value.isNumber===e.number;break;case"integer":t=this._value.isInteger===e.integer;break;case"rational":t=this._value.isRational===e.rational;break;case"algebraic":t=this._value.isAlgebraic===e.algebraic;break;case"real":t=this._value.isReal===e.real;break;case"extendedReal":t=this._value.isExtendedReal===e.extendedReal;break;case"complex":t=this._value.isComplex===e.complex;break;case"extendedComplex":t=this._value.isExtendedComplex===e.extendedComplex;break;case"imaginary":t=this._value.isImaginary===e.imaginary;break;case"positive":t=this._value.isPositive===e.positive;break;case"nonPositive":t=this._value.isNonPositive===e.nonPositive;break;case"negative":t=this._value.isNegative===e.negative;break;case"nonNegative":t=this._value.isNonNegative===e.nonNegative;break;case"zero":t=this._value.isZero===e.zero;break;case"notZero":t=this._value.isNotZero===e.notZero;break;case"one":t=this._value.isOne===e.one;break;case"negativeOne":t=this._value.isNegativeOne===e.negativeOne;break;case"infinity":t=this._value.isInfinity===e.infinity;break;case"NaN":t=this._value.isNaN===e.NaN;break;case"finite":t=this._value.isFinite===e.finite;break;case"even":t=this._value.isEven===e.even;break;case"odd":t=this._value.isOdd===e.odd;break;case"prime":t=this._value.isPrime===e.prime;break;case"composite":t=this._value.isComposite===e.composite;break}i>0&&(t||(this._defValue=void 0,this._value=void 0),this._domain=this._engine.Numbers,this._flags?this._flags={...this._flags,...Bt(e)}:this._flags=Bt(e))}};function Ld(n){return Object.fromEntries(Object.entries(n).filter(([e,i])=>i!==void 0))}function Bt(n){let e={...n};return(n.zero||n.one||n.negativeOne)&&(e.zero=n.zero&&!n.one&&!n.negativeOne,e.notZero=!n.zero||n.one||n.negativeOne,e.one=n.one&&!n.zero&&!n.negativeOne,e.negativeOne=n.negativeOne&&!n.zero&&!n.one,e.infinity=!1,e.NaN=!1,e.finite=!0,e.integer=!0,e.finite=!0,e.infinity=!1,e.NaN=!1,e.even=n.one,e.odd=!n.one,e.prime=!1,e.composite=!1),e.zero&&(e.positive=!1,e.negative=!1,e.nonPositive=!0,e.nonNegative=!0),e.notZero===!0&&(e.imaginary||(e.real=!0),e.zero=!1),e.one&&(e.positive=!0),e.negativeOne&&(e.nonPositive=!0),(e.positive||e.nonNegative)&&(e.negativeOne=!1),e.positive?(e.nonPositive=!1,e.negative=!1,e.nonNegative=!0):e.nonPositive?(e.positive=!1,e.negative=e.notZero,e.nonNegative=!e.zero):e.negative?(e.positive=!1,e.nonPositive=e.notZero,e.nonNegative=!1):e.nonNegative&&(e.positive=e.notZero,e.nonPositive=!e.zero,e.negative=!1),(e.positive||e.negative||e.nonPositive||e.nonNegative)&&(e.number=!0,e.finite?e.real=!0:e.finite||(e.complex=!0),e.imaginary=!1),e.finite&&(e.number=!0,e.complex=!0,e.infinity=!1,e.NaN=!1),e.infinity&&(e.finite=!1,e.NaN=!1),e.infinity===!1&&(e.extendedComplex=!1,e.extendedReal=!1),n.even&&(e.odd=!1),n.odd&&(e.even=!1),e.integer&&(e.rational=!0),e.rational&&(e.algebraic=!0),e.algebraic&&(e.real=!0),e.real&&(e.complex=!0),e.imaginary&&(e.complex=!0),e.complex&&(e.number=!0),e.real&&e.infinity!==!1&&(e.extendedReal=!0),e.complex&&e.infinity!==!1&&(e.extendedComplex=!0),(e.even||e.infinity||e.NaN||e.negative||e.imaginary||e.integer===!1)&&(e.prime=!1),e.number&&e.prime&&(e.composite=!1),e}function Fr(n){if(!n)return{};let e={};if(!n.isNumeric)return e.number=!1,e.integer=!1,e.rational=!1,e.algebraic=!1,e.real=!1,e.extendedReal=!1,e.complex=!1,e.extendedComplex=!1,e.imaginary=!1,e.positive=!1,e.nonPositive=!1,e.negative=!1,e.nonNegative=!1,e.zero=!1,e.notZero=!1,e.one=!1,e.negativeOne=!1,e.infinity=!1,e.NaN=!1,e.odd=!1,e.even=!1,e.prime=!1,e.composite=!1,e;let i=n.base;return e.number=!0,i==="Integers"&&(e.integer=!0),i==="RationalNumbers"&&(e.rational=!0),i==="AlgebraicNumbers"&&(e.algebraic=!0),i==="TranscendentalNumbers"&&(e.algebraic=!1,e.real=!0),i==="ExtendedRealNumbers"&&(e.extendedReal=!0),i==="RealNumbers"&&(e.real=!0),i==="ImaginaryNumbers"&&(e.imaginary=!0),i==="ExtendedComplexNumbers"&&(e.extendedComplex=!0),i==="ComplexNumbers"&&(e.complex=!0),i==="PositiveNumbers"&&(e.notZero=!0,e.real=!0,e.positive=!0),i==="NegativeNumbers"&&(e.notZero=!0,e.real=!0,e.negative=!0),i==="NonNegativeNumbers"&&(e.real=!0,e.positive=!0),i==="NonPositiveNumbers"&&(e.real=!0,e.negative=!0),i==="PositiveIntegers"&&(e.notZero=!0,e.integer=!0,e.positive=!0),i==="NegativeNumbers"&&(e.notZero=!0,e.integer=!0,e.negative=!0),i==="NonNegativeNumbers"&&(e.integer=!0,e.positive=!0),i==="NonPositiveNumbers"&&(e.integer=!0,e.negative=!0),Ld(Bt(e))}var We=class{constructor(e,i,t){if(!e.context)throw Error("No context available");this.engine=e,this.scope=e.context;let r=t.idempotent??!1,o=t.involution??!1;if(r&&o)throw new Error(`Function Definition "${i}": the 'idempotent' and 'involution' flags are mutually exclusive`);if(this.name=i,this.description=t.description,this.wikidata=t.wikidata,this.threadable=t.threadable??!1,this.associative=t.associative??!1,this.commutative=t.commutative??!1,this.idempotent=r,this.involution=o,this.inert=t.inert??!1,this.numeric=t.numeric??!1,this.pure=t.pure??!0,this.complexity=t.complexity??pn,this.hold=t.hold??"none",t.at&&(this.at=t.at),t.iterator&&(this.iterator=t.iterator),t.size&&(this.size=t.size),t.keys&&(this.keys=t.keys),t.indexOf&&(this.indexOf=t.indexOf),t.at&&!t.size&&(this.size=s=>{let a=t.at,u=0;for(;a(s,u)!==void 0;)u++;return u}),t.at&&!t.iterator&&(this.iterator=(s,a=1,u=-1)=>{let l=t.at,f=a;return{next(){if(u>=0&&f>=a+u)return{done:!0,value:void 0};let d=l(s,f);return d===void 0?{done:!0,value:void 0}:(f++,{done:!1,value:d})}}}),this.iterator&&!t.indexOf&&(this.indexOf=(s,a)=>{let u=1,l=this.iterator(s),f=l.next();for(;!f.done;){if(a.isEqual(f.value))return u;u++,f=l.next()}}),this.inert){if(t.hold)throw Error(`Function Definition "${i}": an inert function should not have a hold`);if(this.hold="rest",t.signature){let s=t.signature;if("simplify"in s||"evaluate"in s||"N"in s||"evalDimension"in s||"sgn"in s||"compile"in s)throw Error(`Function Definition "${i}": an inert function should only have 'canonical' or 'codomain' handlers`)}if(this.threadable)throw Error(`Function Definition "${i}": an inert function should not be threadable`);if(this.associative)throw Error(`Function Definition "${i}": an inert function should not be associative`);if(this.commutative)throw Error(`Function Definition "${i}": an inert function should not be commutative`);if(this.idempotent)throw Error(`Function Definition "${i}": an inert function should not be idempotent`);if(this.involution)throw Error(`Function Definition "${i}": an inert function should not be involution`);if(!this.pure)throw Error(`Function Definition "${i}": an inert function should be pure`)}if(t.signature){let s=t.signature,a,u,l,f,d=!1;if(s.domain){let m=e.domain(s.domain);if(!m.isValid)throw Error(`Function Definition "${i}": invalid domain ${JSON.stringify(s.domain)}`);[a,u,l,f]=at(e.domain(m))}else s.params||s.result?(a=s.params?.map(m=>e.domain(m))??[],u=s.optParams?.map(m=>e.domain(m))??[],l=s.restParam?e.domain(s.restParam):void 0,typeof s.result=="function"?f=s.result:s.result?f=e.domain(s.result):t.numeric?f=e.Numbers:f=e.Anything):t.numeric?(d=!0,a=[],u=[],l=e.Numbers,f=e.Numbers):(d=!0,a=[],u=[],l=e.Anything,f=e.Anything);let c;if(s.evaluate&&typeof s.evaluate!="function"){let m=e.box(s.evaluate,{canonical:!1});if(!m.isValid)throw Error(`Invalid function ${m.toString()}`);let g=li(m);c=(h,x)=>g(x),c.toString=()=>m.toString()}else c=s.evaluate;this.signature={inferredSignature:d,params:a,optParams:u,restParam:l||void 0,result:f,canonical:s.canonical,simplify:s.simplify,evaluate:c,N:s.N,evalDimension:s.evalDimension,sgn:s.sgn,compile:s.compile}}else t.numeric?this.signature={inferredSignature:!0,params:[],optParams:[],restParam:e.Numbers,result:e.Numbers}:this.signature={inferredSignature:!0,params:[],optParams:[],restParam:e.Anything,result:e.Anything}}reset(){}};function Rr(n,e,i){return i instanceof We?i:new We(n,e,i)}function ds(n){if(n==="all")return ds(["core","control-structures","logic","collections","relop","numeric","arithmetic","trigonometry","algebra","calculus","polynomials","combinatorics","linear-algebra","statistics","dimensions","units","physics","other"]);typeof n=="string"&&(n=[n]);let e=[];for(let i of n){let t=qd[i];if(!t)throw Error(`Unknown library category ${i}`);Array.isArray(t)?e.push(...t):e.push(t)}return Object.freeze(e)}var qd={algebra:[],arithmetic:[...Au,...Vu],calculus:Pu,collections:[Yu,Ru,Ua()],combinatorics:[],"control-structures":Lu,core:Su,dimensions:[],domains:[],"linear-algebra":$u,logic:Hu,numeric:[],other:[],relop:Wu,polynomials:Ju,physics:{Mu0:{description:"Vaccum permeability",constant:!0,wikidata:"Q1515261",domain:"RealNumbers",value:125663706212e-17}},statistics:Qu,trigonometry:Xu,units:[]};function Vd(n){if(n=n.normalize(),Ee(n))return n;throw new Error(`Invalid definition name "${n}": ${en(n)}`)}function cs(n,e){var t;if(!n.context)throw Error("No context available");(t=n.context).ids??(t.ids=new Map);let i=n.context.ids;n.strict;for(let[r,o]of Object.entries(e))if(r=Vd(r),ms(o)){let s=Rr(n,r,o);if(i.has(r))throw new Error(`Duplicate function definition ${r}:
${JSON.stringify(i.get(r))}
${JSON.stringify(o)}`);i.set(r,s)}else if(Lr(o)){let s=new de(n,r,o);if(n.strict&&o.wikidata){for(let[a,u]of i)if(u.wikidata===o.wikidata)throw new Error(`Duplicate entries with wikidata "${o.wikidata}": "${r}" and "${u.name}"`)}if(i.has(r))throw new Error(`Duplicate symbol definition "${r}"`);i.set(r,s)}else{let s=new de(n,r,{value:n.box(o)});i.set(r,s)}}function Lr(n){return n==null||typeof n!="object"||n instanceof L?!1:"domain"in n||"value"in n||"constant"in n}function ms(n){return n==null||typeof n!="object"||n instanceof L?!1:"signature"in n||"complexity"in n}var el=pe(ce(),1);function fi(n){return Number.isInteger(n)&&n!==0?Math.floor(Math.log2(Math.abs(n))/Math.log2(10))+(n>0?1:2):2}function ps(n){if(n.symbol)return 1;let e=n.numericValue;if(e!==null){if(n.isZero)return 1;if(n.isInteger)return fi(E(n));if(U(e))return J(e)?fi(e[0])+fi(e[1])+1:fi(Number(e[0]))+fi(Number(e[1]))+1;if(e instanceof el.Complex)return fi(e.re)+fi(e.im)+1;if(n.isNumber)return 2}let i=n.head,t=2;return typeof i=="string"?["Add","Divide"].includes(i)?t=3:["Subtract","Negate"].includes(i)?t=4:["Square","Sqrt","Multiply","Root"].includes(i)?t=5:["Power"].includes(i)?t=6:["Ln","Exp","Log"].includes(i)?t=7:["Arcsin","Arccos","Arctan","Arcsec"," Arccsc","Arsinh","Arcosh","Artanh","Arcsech","Arcsch","Cosh","Cos","Csc","Csch","Sec","Sin","Sinh","Tan","Tanh"].includes(i)?t=9:t=10:t=ps(i),t+(n.ops?.reduce((r,o)=>r+ps(o),0)??0)}var hs=ps;var Ui=class n{constructor(e){e?e instanceof n?this._items=new Map(e._items):this._items=new Map(e):this._items=new Map}has(e){for(let i of this._items.keys())if(i.isSame(e))return!0;return!1}get(e){for(let[i,t]of this._items)if(i.isSame(e))return t}clear(){this._items.clear()}set(e,i){for(let t of this._items.keys())if(t.isSame(e)){this._items.set(t,i);return}this._items.set(e,i)}delete(e){this._items.delete(e)}[Symbol.iterator](){return this._items.entries()}entries(){return this._items.entries()}};function nl(n){let e=[],i=(t,r=[])=>{if(t.length===0)e.push(r);else for(let o=0;o<t.length;o++){let s=t.slice(),a=s.splice(o,1);i(s.slice(),r.concat(a))}};return i(n),e}var Vr=class n extends L{constructor(e,i,t){super(e,t),this._pattern=Di(i)?e.parse(i,{canonical:!1}):e.box(i,{canonical:!1})}get hash(){return xe("Pattern")^this._pattern.hash}reset(){this._pattern.reset()}get json(){return O(this.engine,"Pattern",[this._pattern])}get head(){return"Pattern"}get domain(){return this.engine.domain("Values")}get isCanonical(){return!0}set isCanonical(e){}isSame(e){return this===e?!0:e instanceof n&&this._pattern.isSame(e._pattern)}isEqual(e){return e instanceof n&&this._pattern.isEqual(e._pattern)}match(e,i){return tl(e,this._pattern,{recursive:i?.recursive??!1,numericTolerance:i?.numericTolerance??0,substitution:i?.substitution??{},exact:i?.exact??!1})}test(e,i){return this.match(e,i)!==null}count(e,i){let t=0;for(let r of e)this.match(r,i)!==null&&(t+=1);return t}subs(e,i){return this._pattern.subs(e,i)}};function qr(n){if(typeof n=="string")return n.startsWith("_");if(n.symbol?.startsWith("_"))return!0;if(n.ops)return qr(n.head)||n.ops.some(qr);if(n.keys){for(let e of n.keys)if(qr(n.getKey(e)))return!0}return!1}function $r(n,e,i){return n.startsWith("_"),n==="_"||n==="__"||n==="___"?i:n in i?e.isSame(i[n])?i:null:qr(e)?null:{...i,[n]:e}}function Ve(n,e,i,t){let r=t.exact??!1,o=n.engine;if(e.head==="Pattern")return e.match(n,{...t,...i});if(e instanceof le)return n instanceof le?t.numericTolerance===0?e.isSame(n)?i:null:e.isEqualWithTolerance(n,t.numericTolerance)?i:null:null;let s=e.string;if(s!==null)return n.string===s?i:null;let a=e.symbol;if(a!==null)return a.startsWith("_")?$r(a,n,i):a===n.symbol?i:null;let u=e.keys;if(u!==null){let l=n.keys;if(l===null)return null;for(let f of u){let d=Ve(l[f],u[f],i,t);if(d===null)return null;i=d}return i}if(e.ops){let l=e.head;if(typeof l=="string"&&l.startsWith("_"))return $r(l,o.box(n.head),i);let f;if(typeof l=="string"&&typeof n.head=="string"){if(l!==n.head){if(r)return null;if(l==="Add"){let d=Ve(o.box(["Add",0,n],{canonical:!1}),e,i,t);if(d!==null||(n.head==="Subtract"&&(d=Ve(o.box(["Add",n.op1,["Negate",n.op2]],{canonical:!1}),e,i,t)),d!==null))return d}if(l==="Subtract"){let d=Ve(o.box(["Subtract",n,0],{canonical:!1}),e,i,t);if(d!==null||(n.head==="Negate"&&(d=Ve(o.box(["Subtract",0,n.op1],{canonical:!1}),e,i,t)),d!==null))return d}if(l==="Multiply"){let d=Ve(o.box(["Multiply",1,n],{canonical:!1}),e,i,t);if(d!==null||n.head==="Negate"&&(d=Ve(o.box(["Multiply",-1,n.op1],{canonical:!1}),e,i,t),d!==null)||n.head==="Divide"&&(d=Ve(o.box(["Multiply",n.op1,["Divide",1,n.op2]],{canonical:!1}),e,i,t),d!==null))return d}if(l==="Divide"){let d=Ve(o.box(["Divide",n,1],{canonical:!1}),e,i,t);if(d!==null)return d}return null}f=o.lookupFunction(l)}else{let d=Ve(o.box(n.head,{canonical:!1}),o.box(l,{canonical:!1}),i,t);if(d===null)return null;i=d}return f?.commutative?$d(n,e,i,t):il(n,e.ops,i,t)}return null}function $d(n,e,i,t){let r=nl(e.ops);for(let o of r){let s=il(n,o,i,t);if(s!==null)return s}return null}function il(n,e,i,t){if(e.length===0)return null;let r=e[0].engine,o={...i},s=[...n.ops],a=0;for(;a<e.length;){let u=e[a],l=u.symbol;if(l!==null){if(l.startsWith("__")){let f=0;if(e[a+1]===void 0)f=s.length+1;else{let c=!1;for(;!c&&f<s.length;)c=Ve(s[f],e[a+1],o,t)!==null,f+=1;if(!c&&l.startsWith("___"))return null}if(!l.startsWith("___")&&f<=1)return null;let d;f<=1?n.head==="Add"?d=r.Zero:n.head==="Multiply"?d=r.One:d=r.box(["Sequence"]):d=r.box([n.head,...s.splice(0,f-1)]),o=$r(l,d,o)}else if(l.startsWith("_"))o=$r(l,s.shift(),o);else if(o=Ve(s.shift(),u,o,t),o===null)return null}else{let f=s.shift();if(!f||(o=Ve(f,u,o,t),o===null))return null}if(o===null)return null;a+=1}return s.length>0?null:o}function tl(n,e,i){let t=Ve(n,e,i.substitution??{},{numericTolerance:i?.numericTolerance??tt});if(t)return t;if(!i.recursive)return null;if(n.ops){let r=n.ops,o={};for(let s=0;s<r.length;s++){let a=tl(r[s],e,i);if(a!==null)return a}return o}return null}var Wn=class n extends L{constructor(e,i,t){super(e,t?.metadata),Ee(i),`${i}${en(i)}`,this._id=i,this._def=t?.def??void 0,t?.canonical??!0?this._def?this._scope=e.context:this.bind():this._scope=null}get hash(){return this._hash===void 0&&(this._hash=xe(this._id)),this._hash}get isPure(){return!0}get json(){let e=this._scope?this.wikidata:void 0;return yr(this.engine,this._id,{latex:this._latex,wikidata:e})}get scope(){return this._scope}get isConstant(){let e=this._def??this.engine.lookupSymbol(this._id,this.wikidata);return!(e instanceof de)||e.constant}bind(){this._scope=this.engine.context;let e=this.engine.lookupSymbol(this._id)??this.engine.lookupFunction(this._id);if(e){this._def=e;return}this._def=this.engine.defineSymbol(this._id,{domain:void 0,inferred:!0}),this._id=this._def.name}reset(){this._def?.reset(),this._def=void 0}get isCanonical(){return this._scope!==null}set isCanonical(e){this._scope=e?this.engine.context:null,this._def=void 0}get canonical(){return this._scope?this:this.engine.box(this._id)}solve(e){return e.length!==1?null:e.includes(this.symbol)?[this.engine.Zero]:null}get complexity(){return 7}get head(){return"Symbol"}get symbol(){return this._id}get isNothing(){return this._id==="Nothing"}get baseDefinition(){return this._def===void 0&&this.bind(),this._def??void 0}get symbolDefinition(){return this._def===void 0&&this.bind(),this._def instanceof de?this._def:void 0}get functionDefinition(){return this._def===void 0&&this.bind(),this._def instanceof We?this._def:void 0}infer(e){let i=this.engine.lookupSymbol(this._id)??this.engine.lookupFunction(this._id);if(!i){let t=this.engine.swapScope(this._scope??this.engine.context);return this._def=this.engine.defineSymbol(this._id,{domain:e,inferred:!0}),this.engine.swapScope(t),!0}return i instanceof de&&i.inferredDomain?(i.domain=mt(i.domain,e),!0):!1}get value(){let e=this._def;if(e&&e instanceof de)return e.value?.value}set value(e){let i=this.engine;i.forget(this._id);let t;if(typeof e=="boolean"&&(e=e?i.True:i.False),typeof e=="string"&&(e=i.string(e)),typeof e=="object")if("re"in e&&"im"in e)e=i.complex(e.re,e.im);else if("num"in e&&"denom"in e)e=i.number([e.num,e.denom]);else if(Array.isArray(e))e=i._fn("List",e.map(o=>i.box(o)));else throw new Error(`Invalid value for symbol ${this._id}: ${e}`);if(e!==void 0&&(t=i.box(e).evaluate()),t?.domain?.isFunction){this.engine.lookupSymbol(this._id),this._def=i.defineFunction(this._id,{signature:{...ut(t.domain),evaluate:t}});return}let r=this.engine.lookupSymbol(this._id);if(r&&r instanceof de)r.value=t;else{let o=t?.domain;o?.isNumeric&&(o=i.Numbers),this._def=i.defineSymbol(this._id,{value:t,domain:o})}}get domain(){let e=this._def;if(e){if(e instanceof We)return tr(this.engine,e.signature);if(e instanceof de)return e.domain??void 0}}set domain(e){if(!this._def)return;if(this._id[0]==="_")throw new Error(`The domain of the wildcard "${this._id}" cannot be changed`);let i=this.engine.domain(e);i.isFunction?(this.engine.forget(this._id),this._def=this.engine.defineFunction(this._id,{signature:ut(i)})):this._def instanceof de?this._def.domain=i:(this.engine.forget(this._id),this._def=this.engine.defineSymbol(this._id,{domain:i}))}get sgn(){let e=this._def;if(!e||!(e instanceof de))return null;let i=e.value;if(i&&i!==this){let t=i.sgn;if(t!==void 0)return t}if(e.zero===!0)return 0;if(e.positive===!0)return 1;if(e.negative===!0)return-1}has(e){return typeof e=="string"?this._id===e:e.includes(this._id)}isSame(e){return this===e?!0:e instanceof n?this._id===e._id:!1}match(e,i){return e instanceof n&&this._id===e._id?{}:null}isEqual(e){if(!this.isCanonical)return this.canonical.isEqual(e);if(e=e.canonical,this===e)return!0;if(e.symbol!==null)return e.symbol===this._id;let i=this.symbolDefinition?.value?.N();if(i)return i.isEqual(e.N());if(e.isZero){if(this.isZero)return!0;if(this.isNotZero)return!1}return this.isZero&&e.isNotZero?!1:this.engine.ask(["Equal",this,e]).length>0?!0:(this.engine.ask(["NotEqual",this,e]).length>0,!1)}isLess(e){if(e.symbol!==null&&e.symbol===this._id)return!1;let i=this.symbolDefinition?.value?.N();if(i)return i.isLess(e.N());if(e.isZero){let t=this.sgn;if(t===null)return!1;if(t!==void 0)return t<0}}isLessEqual(e){if(e.symbol!==null&&e.symbol===this._id)return!0;let i=this.symbolDefinition?.value?.N();if(i)return i.isLessEqual(e.N());if(e.isZero){let t=this.sgn;if(t===null)return!1;if(t!==void 0)return t<=0}return this.isLess(e)||this.isEqual(e)}isGreater(e){if(e.symbol!==null&&e.symbol===this._id)return!1;let i=this.symbolDefinition?.value?.N();if(i)return i.isGreater(e.N());if(e.isZero){let t=this.sgn;if(t===null)return!1;if(t!==void 0)return t>0}}isGreaterEqual(e){if(e.symbol!==null&&e.symbol===this._id)return!0;let i=this.symbolDefinition?.value?.N();if(i)return i.isGreaterEqual(e.N());if(e.isZero){let t=this.sgn;if(t===null)return!1;if(t!==void 0)return t>=0}return this.isGreater(e)||this.isEqual(e)}get isFunction(){return!!this.functionDefinition}get isZero(){return this.symbolDefinition?.zero}get isNotZero(){return this.symbolDefinition?.notZero}get isOne(){return this.symbolDefinition?.one}get isNegativeOne(){return this.symbolDefinition?.negativeOne}get isOdd(){return this.symbolDefinition?.odd}get isEven(){return this.symbolDefinition?.even}get isPrime(){return this.symbolDefinition?.prime}get isComposite(){return this.symbolDefinition?.composite}get isInfinity(){return this.symbolDefinition?.infinity}get isNaN(){return this.symbolDefinition?.NaN}get isPositive(){return this.symbolDefinition?.positive}get isNonPositive(){return this.symbolDefinition?.nonPositive}get isNegative(){return this.symbolDefinition?.negative}get isNonNegative(){return this.symbolDefinition?.nonNegative}get isNumber(){return this.symbolDefinition?.number}get isInteger(){return this.symbolDefinition?.integer}get isRational(){return this.symbolDefinition?.rational}get isAlgebraic(){return this.symbolDefinition?.rational}get isReal(){return this.symbolDefinition?.real}get isExtendedReal(){return this.symbolDefinition?.extendedReal}get isComplex(){return this.symbolDefinition?.complex}get isImaginary(){return this.symbolDefinition?.imaginary}simplify(e){let i=this.symbolDefinition;return i?.holdUntil==="simplify"&&i.value?i.value.simplify(e):e?.rules?this.replace(e.rules)??this:this}evaluate(e){let i=this.symbolDefinition;if(i){if(e?.numericMode)return i.holdUntil==="never"?this:i.value?.N(e)??this;if(i.holdUntil==="simplify"||i.holdUntil==="evaluate")return i.value?.evaluate(e)??this}return this}N(e){let i=this.symbolDefinition;return i&&i.holdUntil==="never"?this:i?.value?.N(e)??this}replace(e,i){return rr(this,e,i)}subs(e,i){return e[this._id]===void 0?i?.canonical?this.canonical:this:this.engine.box(e[this._id],i)}};function gs(n,e){let i=n.lookupSymbol(e);return i?.holdUntil==="never"&&i.value?i.value:new Wn(n,e,{canonical:!0,def:i})}var Dt="\x1B[0m";var rl="\x1B[33m";var ol="\x1B[36;1m",xs="\x1B[101;97m";var ji=class n{constructor(e){this._cache={};this._commonSymbols={True:null,False:null,All:null,Nothing:null,None:null,Undefined:null,Pi:null,ImaginaryUnit:null,ExponentialE:null};this._commonNumbers={"-5":null,"-4":null,"-3":null,"-2":null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null,10:null,11:null,12:null,36:null};this._commonDomains={Anything:null,Void:null,NothingDomain:null,Booleans:null,Strings:null,Domains:null,Symbols:null,Integers:null,RationalNumbers:null,AlgebraicNumbers:null,RealNumbers:null,ExtendedRealNumbers:null,ImaginaryNumbers:null,ComplexNumbers:null,ExtendedComplexNumbers:null,Numbers:null,PositiveIntegers:null,TranscendentalNumbers:null,PositiveNumbers:null,Functions:null,NumericFunctions:null,RealFunctions:null,LogicOperators:null,Predicates:null};if(e!==void 0&&typeof e!="object")throw Error("Unexpected argument");this.strict=!0,this._jsonSerializationOptions={exclude:[],shorthands:["function","symbol","string","dictionary","number"],metadata:[],precision:"max",repeatingDecimals:!0},this._useRawJsonSerializationOptions=!1,this._rawJsonSerializationOptions={exclude:[],shorthands:["function","symbol","string","dictionary","number"],metadata:[],precision:"max",repeatingDecimals:!1},this._stats={highwaterMark:0,symbols:new Set,expressions:new Set},this._numericMode=e?.numericMode??"auto",this._precision=Math.max(e?.numericPrecision??100,Math.floor(ei)),this._bignum=v.clone({precision:this._precision}),this.tolerance=e?.tolerance??tt,this.Zero=new le(this,0),this.One=new le(this,1),this.Half=new le(this,[1,2]),this.NegativeOne=new le(this,-1),this.NaN=new le(this,Number.NaN),this.PositiveInfinity=new le(this,Number.POSITIVE_INFINITY),this.NegativeInfinity=new le(this,Number.NEGATIVE_INFINITY),this.I=new le(this,Gi.Complex.I),this.ComplexInfinity=new le(this,Gi.Complex.INFINITY),this.reset(),this.context={assumptions:new Ui,timeLimit:2,memoryLimit:1,recursionLimit:1024,iterationLimit:Number.POSITIVE_INFINITY};for(let t of n.getStandardLibrary("domains"))cs(this,t);for(let t of Object.keys(this._commonDomains))this._commonDomains[t]&&!this._commonDomains[t].symbolDefinition?this._commonDomains[t].bind():this._commonDomains[t]=new Dn(this,or[t]??t);this.Anything=this._commonDomains.Anything,this.Void=this._commonDomains.Void,this.Strings=this._commonDomains.Strings,this.Booleans=this._commonDomains.Booleans,this.Numbers=this._commonDomains.Numbers;let i=e?.ids??n.getStandardLibrary();for(let t of i)cs(this,t);for(let t of Object.keys(this._commonSymbols)){let r=new Wn(this,t,{canonical:!0});r.bind(),this._commonSymbols[t]=r}this.True=this._commonSymbols.True,this.False=this._commonSymbols.False,this.Pi=this._commonSymbols.Pi,this.E=this._commonSymbols.ExponentialE,this.Nothing=this._commonSymbols.Nothing,this.pushScope()}static getStandardLibrary(e="all"){return ds(e)}get latexDictionary(){return this.latexSyntax.dictionary}set latexDictionary(e){this.latexSyntax.dictionary=e}reset(){this._bignum,this._BIGNUM_NEGATIVE_ONE=this.bignum(-1),this._BIGNUM_NAN=this.bignum(NaN),this._BIGNUM_ZERO=this.bignum(0),this._BIGNUM_ONE=this.bignum(1),this._BIGNUM_TWO=this.bignum(2),this._BIGNUM_HALF=this._BIGNUM_ONE.div(this._BIGNUM_TWO),this._BIGNUM_PI=this._BIGNUM_NEGATIVE_ONE.acos();let e=this._stats.symbols.values(),i=this._stats.expressions.values();this._stats.symbols=new Set,this._stats.expressions=new Set;for(let r of e)r.reset();for(let r of i)r.reset();for(let r of Object.values(this._commonDomains))r?.reset();for(let r of Object.values(this._commonSymbols))r?.reset();let t=this.context;for(;t;){if(t.ids)for(let[r,o]of t.ids)o.reset();t=t.parentScope??null}for(let r of Object.keys(this._cache))this._cache[r].value&&(this._cache[r].purge?this._cache[r].value=this._cache[r].purge(this._cache[r].value):delete this._cache[r])}_register(e){this._stats.highwaterMark+=1}_unregister(e){}get stats(){let e=this._stats.expressions;return this._stats.expressions=null,this._stats.expressions=e,{...this._stats}}get precision(){return this._numericMode==="machine"||this._numericMode==="complex"?Math.floor(ei):this._precision}set precision(e){e==="machine"&&(e=Math.floor(ei));let i=this._precision;if(e!==i){if(typeof e!="number"||e<=0)throw Error('Expected "machine" or a positive number');this._latexSyntax?.updateOptions({precision:e,avoidExponentsInRange:[-6,e]}),this._precision=Math.max(e,Math.floor(ei)),this.jsonSerializationOptions.precision>this._precision&&(this.jsonSerializationOptions={precision:this._precision}),this._numericMode!=="auto"&&this._numericMode!=="bignum"&&this._precision>Math.floor(ei)&&(this._numericMode="auto"),this._bignum=this._bignum.config({precision:this._precision}),this.reset()}}get numericMode(){return this._numericMode}set numericMode(e){if(e!==this._numericMode){if(typeof e!="string")throw Error("Expected a string");this._numericMode=e,(e==="complex"||e==="machine")&&(this._precision=Math.floor(ei)),this._latexSyntax&&this.latexSyntax.options.precision>this._precision&&this.latexSyntax.updateOptions({precision:this._precision}),this.jsonSerializationOptions.precision>this._precision&&(this.jsonSerializationOptions={precision:this._precision}),this.reset()}}get timeLimit(){let e=this.context;for(;e;){if(e.timeLimit!==void 0)return e.timeLimit;e=e.parentScope??null}return 2}get iterationLimit(){let e=this.context;for(;e;){if(e.iterationLimit!==void 0)return e.iterationLimit;e=e.parentScope??null}return 1024}get recursionLimit(){let e=this.context;for(;e;){if(e.recursionLimit!==void 0)return e.recursionLimit;e=e.parentScope??null}return 1024}get tolerance(){return this._tolerance}set tolerance(e){typeof e=="number"&&Number.isFinite(e)?this._tolerance=Math.max(e,0):this._tolerance=tt,this._bignumTolerance=this.bignum(this._tolerance)}chop(e){return typeof e=="number"&&Math.abs(e)<=this._tolerance||e instanceof v&&e.abs().lte(this._bignumTolerance)||e instanceof Gi.Complex&&Math.abs(e.re)<=this._tolerance&&Math.abs(e.im)<=this._tolerance?0:e}bignum(e){if(typeof e=="bigint")return new this._bignum(e.toString());try{return new this._bignum(e)}catch(i){console.error(i)}return this._BIGNUM_NAN}complex(e,i){return e instanceof v&&(e=e.toNumber()),i instanceof v&&(i=i.toNumber()),new Gi.Complex(e,i)}isBignum(e){return e instanceof v}isComplex(e){return e instanceof Gi.Complex}get latexSyntax(){if(!this._latexSyntax){let e=this.precision;this._latexSyntax=new it({computeEngine:this,precision:e,avoidExponentsInRange:[-6,e],onError:i=>{throw new Error(JSON.stringify(i[0].message))}})}return this._latexSyntax}static getLatexDictionary(e="all"){return it.getDictionary(e)}set costFunction(e){typeof e!="function"&&(this._cost=hs),this._cost=e}get costFunction(){return this._cost??hs}lookupSymbol(e,i,t){if(!this.strict){for(t??(t=this.context??void 0);t;){let o=t.ids?.get(e);if(o&&o instanceof de)return o;t=t.parentScope}return}if(typeof e!="string")throw Error("Expected a string");if(e.length===0||!this.context)return;let r=t??this.context;if(i)for(t=r;t;){if(t.ids){for(let[o,s]of t.ids)if(s instanceof de&&s.wikidata===i)return s}t=t.parentScope}for(t=r;t;){let o=t.ids?.get(e);if(o instanceof de)return o;t=t.parentScope}}lookupFunction(e,i){if(typeof e=="string"&&this.context)for(i??(i=this.context);i;){let t=i.ids?.get(e);if(t instanceof We)return t;i=i.parentScope}}defineSymbol(e,i){if(!this.context)throw Error("Symbol cannot be defined: no scope available");if(e.length===0||!Ee(e))throw Error(`Invalid identifier "${e}": ${en(e)}}`);return this._defineSymbol(e,i)}_defineSymbol(e,i){var r;(r=this.context).ids??(r.ids=new Map);let t=new de(this,e,i);return t.name&&this.context.ids.set(t.name,t),t}defineFunction(e,i){if(!this.context)throw Error("Function cannot be defined: no scope available");if(e.length===0||!Ee(e))throw Error(`Invalid identifier "${e}": ${en(e)}}`);return this._defineFunction(e,i)}_defineFunction(e,i){var r;(r=this.context).ids??(r.ids=new Map);let t=Rr(this,e,i);return t.name&&this.context.ids.set(t.name,t),t}pushScope(e){if(this.context===null)throw Error("No parent scope available");return this.context={timeLimit:this.context.timeLimit,memoryLimit:this.context.memoryLimit,recursionLimit:this.context.recursionLimit,iterationLimit:this.context.iterationLimit,...e??{},parentScope:this.context,assumptions:new Ui(this.context.assumptions)},this}popScope(){if(!this.context)throw Error("No scope available");return this.context=this.context.parentScope??null,this.context,this}swapScope(e){let i=this.context;return this.context=e,this.context,i}resetContext(){if(this.context){for(let[e,i]of this.context.ids??[])if(i instanceof de)i.constant||(i.value=void 0);else if(i instanceof We){let t=i.signature;i.signature={...t,evaluate:void 0,N:void 0,simplify:void 0,canonical:void 0}}}}_printScope(e,i,t=0){if(e??(e={details:!1,maxDepth:1}),i??(i=this.context),!i||e.maxDepth&&t>e.maxDepth)return null;let r=`${rl}[undefined]${Dt}`;if(t===0?console.group("current scope - level 0"):console.groupCollapsed(i.parentScope?`scope - level ${t}`:`root scope - level ${t}`),i.ids){let o=0;for(let[s,a]of i.ids){let u=`${ol}${s}${Dt}`;try{if(a instanceof de){let l=a.value?.isValid?a.value.toString():a.value?`${xs}${a.value.toString()}${Dt}`:r;console.info(`${u}: ${a.domain?.toString()??r} = ${l}`)}else a instanceof We&&(typeof a.signature.evaluate=="function"?console.info(`${u}(): ${e.details?a.signature.evaluate.toString():"[native-code]"}`):a.signature.evaluate===void 0?console.info(`${u}(): ${r}`):console.info(`${u}(): ${a.toString()}`));o===11&&console.groupCollapsed(`... and ${i.ids.size-o} more`),o+=1}catch(l){console.info(`${u}: ${xs}${l.message}${Dt}`)}}o>=11&&console.groupEnd()}if(i.assumptions){let o=[...i.assumptions.entries()].map(([s,a])=>`${s}: ${a}`);if(o.length>0){console.groupCollapsed(`${o.length} assumptions)`);for(let s of o)console.info(s);console.groupEnd()}}return i.parentScope&&this._printScope(e,i.parentScope,t+1),console.groupEnd(),this.context}declare(e,i){if(typeof e!="string"||i===void 0){for(let[s,a]of Object.entries(e))this.declare(s,a);return this}let[t,r]=Jo(e);if(r!==void 0)throw Error(`Unexpected arguments with ${e}. Use 'ce.assign()' instead to assign a value, or a use a function definition with 'ce.declare()'.`);if(t==="Nothing")return this;if(this.context?.ids?.get(t)){let s=this.context.ids.get(t);if(s instanceof de&&s.inferredDomain)return Lr(i)?s.update(i):(s.domain=this.domain(i),s.inferredDomain=!1),this;throw Error(`Symbol "${t}" has already been declared in the current scope`)}let o=i;if(!o)throw Error(`Expected a definition for ${t}`);if(Lr(o))return this.defineSymbol(t,o),this;if(ms(o))return this.defineFunction(t,o),this;{let s=this.domain(o);if(s.isValid)if(s.isFunction)this.defineFunction(t,{signature:ut(s)});else{if(r)throw Error(`Unexpected arguments with domain for "${t}"`);this.defineSymbol(t,{domain:s})}else throw Error(`Invalid argument for "${t}": use a domain, a FunctionDefinition or a SymbolDefinition`)}return this}assign(e,i){if(typeof e=="object"){for(let[u,l]of Object.entries(e))this.assign(u,l);return this}let[t,r]=Jo(e);if(t==="Nothing")return this;let o=i;if(typeof o=="boolean"&&(o=o?this.True:this.False),typeof o=="string"){let u=o.trim();u.startsWith("$")&&u.endsWith("$")?o=this.parse(u.slice(1,-1),{canonical:!1}):u.startsWith("$$")&&u.endsWith("$$")?o=this.parse(u.slice(2,-2),{canonical:!1}):o=this.string(o)}let s=this.lookupSymbol(t);if(s){if(s.constant)throw Error(`Cannot assign a value to the constant "${t}"`);if(!s.inferredDomain&&bs(o))throw Error(`Cannot assign a function to symbol "${t}"`);let u=s.scope;if(u?.ids?.delete(s.name),!r&&!bs(o))return o==null?s.value=void 0:s.value=this.box(o),u?.ids?.set(s.name,s),this}let a=this.lookupFunction(t);if(a){let u=a.scope;if(u?.ids?.delete(a.name),o==null)return this;if(typeof o=="function"){let d=this.swapScope(u);return this.defineFunction(t,{signature:{evaluate:o}}),this.swapScope(d),this}if(r&&bs(o))throw Error(`Unexpected arguments for "${t}"`);let l=r?this.box(["Function",o,...r]):this.box(o),f=this.swapScope(u);return this.defineFunction(t,{signature:{evaluate:l}}),this.swapScope(f),this}if(o==null)return this.declare(t,{inferred:!0,domain:this.Anything}),this;if(typeof o=="function")return this.defineFunction(t,{signature:{evaluate:o}}),this;if(o instanceof L&&o.domain?.base==="Functions")return this.defineFunction(t,{signature:{evaluate:o}}),this;if(Array.isArray(o)||o instanceof L||r){let u=this.box(o,{canonical:!1});if(u.head==="Function")return u=this.box(["Function",...u.ops,...(r??[]).map(f=>this.symbol(f))]),this.defineFunction(t,{signature:{evaluate:u}}),this;let l=[...u.unknowns].sort();if(l.length===0){let f=u.evaluate();return this.defineSymbol(t,{value:f}),this}if(l.some(f=>/\_[\d]+/.test(f)))return u=this.box(["Function",u]),this.defineFunction(t,{signature:{evaluate:u}}),this;if(r&&r.length>0)return this.pushScope(),u=this.box(["Function",u,...r]),this.popScope(),this.defineFunction(t,{signature:{evaluate:u}}),this;this.pushScope(),o=u.evaluate(),this.popScope()}return this.defineSymbol(t,{value:o}),this}_assign(e,i){let t=this.lookupSymbol(e);if(t)return t.value=this.box(i).evaluate(),this;let r=this.lookupFunction(e);if(r){let o=r.signature;return r.signature={...o,N:void 0,simplify:void 0,canonical:void 0,evaluate:i},this}return`${e}`,this}get assumptions(){if(!this.context)throw Error("No scope available");return this.context.assumptions?this.context.assumptions:(this.context.assumptions=new Ui,this.context.assumptions)}shouldContinueExecution(){return this.deadline===void 0||this.deadline>=Date.now()}checkContinueExecution(){if(!this.shouldContinueExecution())throw new Error("timeout")}cache(e,i,t){if(this._cache[e]===void 0)try{this._cache[e]={build:i,purge:t,value:i()}}catch(r){console.error(`Fatal error building cache "${e}":
	 ${r.toString()}`)}return this._cache[e]?.value}canonical(e){if(!e.every(t=>t instanceof L))return e.map(t=>this.box(t));let i=e;return i.every(t=>t.isCanonical)?i:i.map(t=>t.canonical)}box(e,i){return we(this,e,i)}function(e,i,t){return t??(t={}),"canonical"in t||(t.canonical=!0),Tt(this,e,i,t)}error(e,i){i instanceof L?i=this.rawJson(i):i&&Array.isArray(i)&&i[0]==="LatexString"&&((i[1]===void 0||!i[1])&&(i=""),typeof i[1]=="object"&&"str"in i[1]&&!i[1].str&&(i=""));let t;return typeof e=="string"&&(t=this.string(e)),!t&&typeof e!="string"&&(t=new be(this,"ErrorCode",[this.string(e[0]),...e.slice(1).map(r=>this.box(r,{canonical:!1}))])),i?new be(this,"Error",[t,this.box(i,{canonical:!1})],{canonical:!1}):new be(this,"Error",[t],{canonical:!1})}domainError(e,i,t){let r=mn(e)?this.domain(e):this.symbol(e),o=i||this.symbol("Undefined");return this.error(["incompatible-domain",r,o],t)}hold(e){return this._fn("Hold",[this.box(e,{canonical:!1})])}add(...e){return xt(this,te(se(e),"Add"))}neg(e){return bt(e.canonical)}mul(...e){let i=te(se(e),"Multiply");return vt(this,i)}div(e,i){return vr(this,e.canonical,i.canonical)}sqrt(e){return Ri(this,e,"evaluate")??this._fn("Power",[e,this.Half])}pow(e,i){return(typeof i=="number"||U(i))&&(i=this.number(i)),kn(this,e,i)}inv(e){if(e.isOne)return this.One;if(e.isNegativeOne)return this.NegativeOne;if(e.isInfinity)return this.Zero;let i=e.numericValue;if(i!==null)return U(i)?this.number(Tn(i)):typeof i=="number"&&Number.isInteger(i)?this.number([1,i]):i instanceof v&&i.isInteger()?this.number([BigInt(1),P(i)]):this._fn("Divide",[this.One,e]);if(e.head==="Sqrt")return this._fn("Sqrt",[this.inv(e.op1)]);if(e.head==="Divide")return this._fn("Divide",[e.op1,e.op2]);let t=this.NegativeOne;if(e.head==="Power"){if(e.op2.isNegativeOne)return e.op1;t=ge(e.op2),e=e.op1}return t.isNegativeOne?this._fn("Divide",[this.One,e]):this._fn("Power",[e,t])}pair(e,i,t){return new be(this,"Tuple",[e.canonical,i.canonical],{metadata:t,canonical:!0})}tuple(e,i){return new be(this,"Tuple",me(e.map(t=>typeof t=="number"?this.number(t):t.canonical)),{metadata:i,canonical:!0})}array(e,i){return this.Nothing}string(e,i){return new gn(this,e,i)}symbol(e,i){if(i=i?{...i}:{},"canonical"in i||(i.canonical=!0),e=e.normalize(),e==="NaN")return this.NaN;if(e==="Infinity")return this.PositiveInfinity;if(e==="+Infinity")return this.PositiveInfinity;if(e==="-Infinity")return this.NegativeInfinity;if(e==="Half")return this.Half;if(this.strict&&!Ee(e)){let r=i?.metadata?.latex,o=`'${e}'`;return this.error(["invalid-identifier",{str:en(e)}],r?["LatexString",`'${r}'`]:o)}if(i?.metadata?.latex!==void 0&&!i.canonical)return new Wn(this,e,i);let t=this._commonSymbols[e];return t?!i?.metadata?.wikidata||!t.wikidata||t.wikidata===i.metadata.wikidata?t:i.canonical?gs(this,e):new Wn(this,e,i):i.canonical?gs(this,e):new Wn(this,e,i)}domain(e,i){if(e instanceof Dn)return e;if(typeof e=="string"){let r=this._commonDomains[e];if(r)return r}if(!this.strict){if(typeof e=="string"){let r=or[e];if(r)return this.domain(r)}return new Dn(this,e,i)}if(Array.isArray(e)&&e[0]==="Domain"&&(e=e[1]),typeof e=="string"){let r=or[e];if(r)return this.domain(r);if(!ri(e))throw Error("Expected a domain literal, got "+e);return new Dn(this,e,i)}if(!Array.isArray(e)||e.length===0)throw Error("Expected a valid domain");let t=e[0];if(!ki.includes(t))throw Error("Expected a domain constructor, got "+t);return new Dn(this,e,i)}number(e,i){if(i=i?{...i}:{},"canonical"in i||(i.canonical=!0),i.metadata===void 0){if(typeof e=="bigint"){if(e===BigInt(1))return this.One;if(e===BigInt(0))return this.Zero;if(e===BigInt(-1))return this.NegativeOne}if(typeof e=="number"){let t=e;if(t===1)return this.One;if(t===0)return this.Zero;if(t===-1)return this.NegativeOne;if(Number.isInteger(t)&&this._commonNumbers[t]!==void 0)return this._commonNumbers[t]===null&&(this._commonNumbers[t]=Ir(this,e)??this.NaN),this._commonNumbers[t];if(Number.isNaN(t))return this.NaN;if(!Number.isFinite(t))return t<0?this.NegativeInfinity:this.PositiveInfinity}}return typeof e=="bigint"&&(e=this.bignum(e)),Ir(this,e,i)??this.NaN}rules(e){return ti(this,e)}pattern(e){return new Vr(this,e)}_fn(e,i,t){return new be(this,e,i,{metadata:t,canonical:!0})}parse(e,i){if(typeof e!="string")return null;let t=this.latexSyntax.parse(Ii(e)??e);return this.box(t,i)}serialize(e,i){if(typeof e=="object"&&"json"in e){let t="engine"in e?e.engine:this;return this.latexSyntax.serialize(this.rawJson(t.box(e,{canonical:!1})),i)}return this.latexSyntax.serialize(e,i)}get latexOptions(){let e=this.latexSyntax;return new Proxy({...this.latexSyntax.options,...this.latexSyntax.serializer.options},{set(i,t,r){return t in i?(e.updateOptions({[t]:r}),!0):!1}})}set latexOptions(e){this.latexSyntax.updateOptions(e)}get jsonSerializationOptions(){if(this._useRawJsonSerializationOptions)return new Proxy(this._rawJsonSerializationOptions,{get(i,t){if(t in i)return i[t]}});let e=this;return new Proxy(this._jsonSerializationOptions,{get(i,t){if(t in i)return i[t]},set(i,t,r){return t in i?(e.jsonSerializationOptions={[t]:r},!0):!1}})}set jsonSerializationOptions(e){e.exclude&&(this._jsonSerializationOptions.exclude=[...e.exclude]),e.shorthands&&(e.shorthands==="all"||e.shorthands.includes("all")?this._jsonSerializationOptions.shorthands=["function","symbol","string","dictionary","number"]:this._jsonSerializationOptions.shorthands=[...e.shorthands]),e.metadata&&(e.metadata==="all"||e.metadata.includes("all")?this._jsonSerializationOptions.metadata=["latex","wikidata"]:this._jsonSerializationOptions.metadata=[...e.metadata]),typeof e.precision=="number"&&e.precision>0&&(this._jsonSerializationOptions.precision=e.precision),typeof e.repeatingDecimals=="boolean"&&(this._jsonSerializationOptions.repeatingDecimals=e.repeatingDecimals)}rawJson(e){let i=this._useRawJsonSerializationOptions;this._useRawJsonSerializationOptions=!0;let t=e.json;return this._useRawJsonSerializationOptions=i,t}ask(e){let i=this.pattern(e),t=[];for(let[r,o]of this.assumptions){let s=i.match(r,{numericTolerance:this._tolerance});s!==null&&o===!0&&t.push(s)}return t}verify(e){return!1}assume(e){try{return uu(this.box(e,{canonical:!1}))}catch(i){return console.error(i.toString()),"internal-error"}}forget(e){if(!this.context)throw Error("No scope available");if(e===void 0){if(this.context.ids)for(let i of this.context.ids.keys())this.forget(i);this.assumptions.clear();return}if(Array.isArray(e)){for(let i of e)this.forget(i);return}if(typeof e=="string"){if(this.context.ids){let i=this.context.ids.get(e);if(i instanceof de)i.value=void 0;else if(i instanceof We){let t=i.signature;i.signature={...t,evaluate:void 0,N:void 0,simplify:void 0,canonical:void 0}}}for(let[i,t]of this.assumptions)i.symbols.includes(e)&&this.assumptions.delete(i)}}};function bs(n){return typeof n=="function"||n instanceof L&&n.domain?.base==="Functions"}var zd="0.23.1";globalThis[Symbol.for("io.cortexjs.compute-engine")]={ComputeEngine:ji.prototype.constructor,version:"0.23.1"};return ml(Ud);})();
/*! Bundled license information:

complex.js/complex.js:
  (**
   * @license Complex.js v2.1.1 12/05/2020
   *
   * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
   * Dual licensed under the MIT or GPL Version 2 licenses.
   **)

decimal.js/decimal.mjs:
  (*!
   *  decimal.js v10.4.3
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/
Object.assign(exports, ComputeEngine); Object.defineProperty(exports, '__esModule', { value: true });}));